--- src/support/shobj-conf	2014-02-24 03:06:29.000000000 +0100
+++ new/support/shobj-conf	2014-06-15 14:04:15.561786158 +0200
@@ -39,10 +39,10 @@
 SHOBJ_LD=
 SHOBJ_LDFLAGS=
 SHOBJ_XLDFLAGS=
-SHOBJ_LIBS=
+SHOBJ_LIBS='-ltinfo'
 
 SHLIB_XLDFLAGS=
-SHLIB_LIBS=
+SHLIB_LIBS='-ltinfo'
 
 SHLIB_DOT='.'
 SHLIB_LIBPREF='lib'
@@ -122,8 +122,8 @@
 	SHLIB_LIBVERSION='$(SHLIB_LIBSUFF).$(SHLIB_MAJOR)'
 	;;
 
-# All versions of Linux (including Gentoo/FreeBSD) or the semi-mythical GNU Hurd.
-linux*-*|gnu*-*|k*bsd*-gnu-*|freebsd*-gentoo)
+# All versions of Linux or the semi-mythical GNU Hurd.
+linux*-*|gnu*-*|k*bsd*-gnu-*)
 	SHOBJ_CFLAGS=-fPIC
 	SHOBJ_LD='${CC}'
 	SHOBJ_LDFLAGS='-shared -Wl,-soname,$@'
@@ -146,7 +146,7 @@
 	SHOBJ_CFLAGS=-fPIC
 	SHOBJ_LD='${CC}'
 
-	if [ -x /usr/bin/objformat ] && [ "`/usr/bin/objformat`" = "elf" ]; then
+	if [ ! -x /usr/bin/objformat ] || [ "`/usr/bin/objformat`" = "elf" ]; then
 		SHOBJ_LDFLAGS='-shared -Wl,-soname,$@'
 
 		SHLIB_XLDFLAGS='-Wl,-rpath,$(libdir)'
@@ -160,7 +160,7 @@
 	;;
 
 # FreeBSD-4.x and later have only ELF
-freebsd[4-9]*|freebsd1[0-9]*|freebsdelf*|dragonfly*)
+freebsdelf*|dragonfly*)
 	SHOBJ_CFLAGS=-fPIC
 	SHOBJ_LD='${CC}'
 
@@ -209,7 +209,7 @@
 		;;
 	esac
 
-	SHLIB_LIBS='-lncurses'	# see if -lcurses works on MacOS X 10.1 
+	SHLIB_LIBS='-ltinfo -lncurses'	# see if -lcurses works on MacOS X 10.1 
 	;;
 
 openbsd*|netbsd*|mirbsd*)
