#!/usr/bin/env bash

# PC files that we do not ship but are likely available (mostly GUI stuff)
pc_files="fontconfig gtk+-3.0 harfbuzz x11"

# System directories that might contain the pc files
search_dirs="/usr/lib/pkgconfig /usr/lib64/pkgconfig /usr/share/pkgconfig"


for dir in $search_dirs; do
    if [ -d "$dir" ]; then
        echo "+-- $dir found, using it for the pkg-config test."
        for pc in $pc_files; do
            filename="$dir/$pc.pc"
            if [ -f "$filename" ]; then
                echo "    +-- $pc found, using it for the pkg-config test."
                pkg-config --exists "$pc"
                if [ $? -ne 0 ]; then
                    echo >&2 "Our pkg-config script failed to pick up $pc"
                    exit 1
                fi
            else
                echo "    +-- $pc not found, ignoring."
            fi
        done
    else
        echo "+-- $dir not found, ignoring."
    fi
done
