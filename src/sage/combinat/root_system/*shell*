bash-3.2$ ~/sagemath/sage/src/sage/combinat/root_system:$ pushd ~/branch/
~/branch ~/sagemath/sage/src/sage/combinat/root_system
~/branch:$ ls -l
total 144
-rw-r--r--  1 bump  staff    160 Dec  7 19:48 E7.tm
-rw-r--r--  1 bump  staff    254 Dec  7 19:48 E7.tm~
-rw-r--r--  1 bump  staff  29798 Nov 10 10:38 branch.sage
-rw-r--r--  1 bump  staff   1635 Nov 10 13:51 exper.sage
-rw-r--r--  1 bump  staff   4386 Nov 11 09:26 f4.tm
-rw-r--r--  1 bump  staff   4242 Nov 12 05:23 f4.tm~
-rw-r--r--  1 bump  staff    462 Nov 10 10:38 nonimplemented
-rw-r--r--  1 bump  staff   1028 Nov 10 12:06 notes
-rw-r--r--  1 bump  staff    251 Nov 10 10:38 wiki-comments
~/branch:$ scp sporadic:branch/e6.sage .
e6.sage                                       100% 4477     4.4KB/s   00:00    
~/branch:$ popd
~/sagemath/sage/src/sage/combinat/root_system
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
  File "/Users/bump/.sage/temp/meep2/9187/e6.sageXJPbf6.py", line 108
    b2 = branching_rule("E6","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2)*branching_rule("C3","C2","levi")*branching_rule("C2","C1","levi")
                                                                                                           ^
SyntaxError: invalid syntax

sage: ### reloading attached file e6.sage modified at 21:55:17 ###

---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-f1b9a4d1e3e2> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2U2LnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9187/e6.sageLhz6nh.py in <module>()
    106 
    107 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
--> 108 b2 = branching_rule("E6","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","C2","levi")*branching_rule("C2","C1","levi")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2889                     return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3],x[1]-x[2],-x[1]-x[3],-2*x[5],x[5]+x[4],x[5]-x[4]], "miscellaneous")
   2890                 else:
-> 2891                     raise ValueError("Rule not found")
   2892         elif Rtype == CartanType("E7"):
   2893             if Stype.is_compound():

ValueError: Rule not found
sage: ### reloading attached file e6.sage modified at 21:55:47 ###

sage: b2
composite branching rule E7 => (miscellaneous) G2xC3 => (proj2) C3 => (levi) C2 => (levi) C1
sage: chi=E7(0,0,0,0,0,0,1)
sage: chi.branch(C1,rule=b2)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-4-b4e5862822e1> in <module>()
----> 1 chi.branch(C1,rule=b2)

NameError: name 'C1' is not defined
sage: chi
E7(0,0,0,0,0,0,1)
sage: ### reloading attached file e6.sage modified at 21:57:31 ###

sage: chi.branch(A1,rule=b2)
32*A1(0) + 12*A1(1)
sage: chi.branch(F4,rule=b1)
4*F4(0,0,0,0) + 2*F4(0,0,0,1)
sage: ### reloading attached file e6.sage modified at 22:00:11 ###
### reloading attached file e6.sage modified at 22:00:36 ###

sage: chi.branch(C3,rule=b2)
7*C3(1,0,0) + C3(0,0,1)
sage: b1.describe()

            O 2
            |
            |
O---O---O---O---O---O---O
0   1   3   4   5   6   7
E7~
root restrictions E7 => F4:

O---O=>=O---O
1   2   3   4
F4

1 => 4
2 => 1
3 => 3
4 => 2
5 => 3
6 => 4

For more detailed information use verbose=True
sage: for r in E7.simple_roots(): print r
(1/2, -1/2, -1/2, -1/2, -1/2, -1/2, -1/2, 1/2)
(1, 1, 0, 0, 0, 0, 0, 0)
(-1, 1, 0, 0, 0, 0, 0, 0)
(0, -1, 1, 0, 0, 0, 0, 0)
(0, 0, -1, 1, 0, 0, 0, 0)
(0, 0, 0, -1, 1, 0, 0, 0)
(0, 0, 0, 0, -1, 1, 0, 0)
sage: E7(1,0).degree()
133
sage: E7(1,0).branch(F4,rule=b1)
3*F4(0,0,0,0) + 3*F4(0,0,0,1) + F4(1,0,0,0)
sage: E7(1,0).branch(C3,rule=b2)
14*C3(0,0,0) + 7*C3(0,1,0) + C3(2,0,0)
sage: [F4(f).degree() for f in F4.fundamental_weights()]
[52, 1274, 273, 26]
sage: ### reloading attached file e6.sage modified at 22:32:10 ###

sage: chi.branch(A1,rule=b2)
18*A1(0) + 16*A1(1) + 2*A1(2)
sage: sym5=A1(5)
sage: sym5.degree()
5
sage: sym5
5*A1(0)
sage: sym5=A1(5,)
sage: sym5.degree()
5
sage: sym5
5*A1(0)
sage: sym5=A1((5,))
sage: sym5.degree()
6
sage: sym5.frobenius_schur_indicator()
-1
sage: branching_rule_from_plethysm?
Type:       function
String Form:<function branching_rule_from_plethysm at 0x118d349b0>
File:       /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py
Definition: branching_rule_from_plethysm(chi, cartan_type, return_matrix=False)
Docstring:
   Create the branching rule of a plethysm.

   INPUT:

   * "chi" -- the character of an irreducible representation pi of a
     group G

   * "cartan_type" -- a classical Cartan type (A,`B`,`C` or D).

   It is assumed that the image of the irreducible representation pi
   naturally has its image in the group G.

   Returns a branching rule for this plethysm.

   EXAMPLES:

   The adjoint representation SL(3) --> GL(8) factors through SO(8).
   The branching rule in question will describe how representations of
   SO(8) composed with this homomorphism decompose into irreducible
   characters of SL(3):

      sage: A2 = WeylCharacterRing("A2")
      sage: A2 = WeylCharacterRing("A2", style="coroots")
      sage: ad = A2(1,1)
      sage: ad.degree()
      8
      sage: ad.frobenius_schur_indicator()
      1

   This confirms that ad has degree 8 and is orthogonal, hence factors
   through SO(8) which is type D_4:

      sage: br = branching_rule_from_plethysm(ad,"D4")
      sage: D4 = WeylCharacterRing("D4")
      sage: [D4(f).branch(A2,rule = br) for f in D4.fundamental_weights()]
      [A2(1,1), A2(0,3) + A2(1,1) + A2(3,0), A2(1,1), A2(1,1)]

sage: b3=branching_rule_from_plethysm(sym5,"C3"); b3
plethysm (along A1(5)) branching rule C3 => A1
sage: b2
composite branching rule E7 => (miscellaneous) G2xC3 => (proj2) C3 => (levi) A2 => (levi) A1
sage: ### reloading attached file e6.sage modified at 00:22:23 ###
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-28-f1b9a4d1e3e2> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2U2LnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9187/e6.sage1iM9TL.py in <module>()
    107 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
    108 sym5 = A1((_sage_const_5 ,_sage_const_1 ))
--> 109 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule_from_plethysm("C3",sym5)
    110 
    111 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branching_rule_from_plethysm(chi, cartan_type, return_matrix)
   2963     if ct[0] is "A":
   2964         ret = []
-> 2965         ml = chi.weight_multiplicities()
   2966         for v in ml:
   2967             n = ml[v]

AttributeError: 'str' object has no attribute 'weight_multiplicities'

sage: sym5 = A1((5,1))
sage: sym5.degree()
6
sage: b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule_from_plethysm("C3",sym5)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-30-2cf9f9a7a988> in <module>()
----> 1 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule_from_plethysm("C3",sym5)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branching_rule_from_plethysm(chi, cartan_type, return_matrix)
   2963     if ct[0] is "A":
   2964         ret = []
-> 2965         ml = chi.weight_multiplicities()
   2966         for v in ml:
   2967             n = ml[v]

AttributeError: 'str' object has no attribute 'weight_multiplicities'
sage: ### reloading attached file e6.sage modified at 00:23:16 ###
b2
composite branching rule E7 => (miscellaneous) G2xC3 => (proj2) C3 => (plethysm (along A1(5))) A1
sage: chi
E7(0,0,0,0,0,0,1)
sage: chi.branch(A1,b2)
A1(3) + 7*A1(5) + A1(9)
sage: sym5
A1(5)
sage: sy5.degree(
....: )
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-35-b3f58c03d092> in <module>()
----> 1 sy5.degree(
      2 )

NameError: name 'sy5' is not defined
sage: sym5.degree()
6
sage: ### reloading attached file e6.sage modified at 00:24:43 ###
sym5.degree()
6
sage: chi.branch(A1,b2)
A1(3) + 7*A1(5) + A1(9)
sage: ### reloading attached file e6.sage modified at 00:25:08 ###
sym3.frobenius_schur_indicator()
-1
sage: ### reloading attached file e6.sage modified at 00:25:44 ###
b2
composite branching rule E7 => (miscellaneous) G2xC3 => (proj2) C3 => (levi) C2 => (plethysm (along A1(3))) A1
sage: chi.branch(A1,b2)
14*A1(0) + 8*A1(3) + 2*A1(4)
sage: E7.extended_dynkin_diagram()
            O 2
            |
            |
O---O---O---O---O---O---O
0   1   3   4   5   6   7
E7~
sage: branching_rule("E7","D6xA1","extended").describe()

            O 2
            |
            |
O---O---O---O---O---O---O
0   1   3   4   5   6   7
E7~

projection 1 on D6  root restrictions E7 => D6:

            O 6
            |
            |
O---O---O---O---O
1   2   3   4   5
D6

2 => 6
3 => 5
4 => 4
5 => 3
6 => 2
7 => 1

projection 2 on A1  root restrictions E7 => A1:

O
1
A1

0 => 1

for more detailed information use verbose=True
sage: b1.describe()

            O 2
            |
            |
O---O---O---O---O---O---O
0   1   3   4   5   6   7
E7~
root restrictions E7 => F4:

O---O=>=O---O
1   2   3   4
F4

1 => 4
2 => 1
3 => 3
4 => 2
5 => 3
6 => 4

For more detailed information use verbose=True
sage: chi
E7(0,0,0,0,0,0,1)
sage: chi.branch("G2xC3","miscellaneous")
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-46-c9a5e1acfb5e> in <module>()
----> 1 chi.branch("G2xC3","miscellaneous")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2208     """
   2209     if type(rule) is str or type(rule) is list:
-> 2210         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2211     if hasattr(rule,"_S"):
   2212         if rule._S != S.cartan_type():

AttributeError: 'str' object has no attribute '_cartan_type'
sage: chi.branch(G2xC3,"miscellaneous")
G2xC3(1,0,1,0,0) + G2xC3(0,0,0,0,1)
sage: chi.branch(F4,b1)
4*F4(0,0,0,0) + 2*F4(0,0,0,1)
sage: chi.branch(F4,b1).branch("G2xA1","miscellaneous")
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-49-cae803853936> in <module>()
----> 1 chi.branch(F4,b1).branch("G2xA1","miscellaneous")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2208     """
   2209     if type(rule) is str or type(rule) is list:
-> 2210         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2211     if hasattr(rule,"_S"):
   2212         if rule._S != S.cartan_type():

AttributeError: 'str' object has no attribute '_cartan_type'
sage: chi.branch(F4,b1).branch(G2xA1,"miscellaneous")
4*G2xA1(0,0,0) + 2*G2xA1(1,0,2) + 2*G2xA1(0,0,4)
sage: chi.branch(F4,b1).branch(G2xA1,"miscellaneous").branch(G2,"proj1")
14*G2(0,0) + 6*G2(1,0)
sage: chi.branch(G2xC3,"miscellaneous")
G2xC3(1,0,1,0,0) + G2xC3(0,0,0,0,1)
sage: chi.branch(G2xC3,"miscellaneous").branch(G2,"proj1")
14*G2(0,0) + 6*G2(1,0)
sage: E7(1,1).degree()
86184
sage: E7(0,1).degree()
912
sage: branch(F4,b1).branch(G2xA1,"miscellaneous")
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-56-8b1a8c2af89c> in <module>()
----> 1 branch(F4,b1).branch(G2xA1,"miscellaneous")

NameError: name 'branch' is not defined
sage: ### reloading attached file e6.sage modified at 02:38:44 ###
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-57-f1b9a4d1e3e2> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2U2LnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9187/e6.sageW1HPVI.py in <module>()
    110 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","C2","levi")*branching_rule_from_plethysm(sym3,"C2")
    111 
--> 112 b11 = b1*branching_rule("G2xA1","miscellaneous")*branching_rule(G2,"proj1")
    113 
    114 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2415     """
   2416     Rtype=CartanType(Rtype)
-> 2417     Stype=CartanType(Stype)
   2418     r = Rtype.rank()
   2419     s = Stype.rank()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in __call__(self, *args)
    554                 return CartanType(t[:-1]).affine()
    555             else:
--> 556                 return CartanType([t[0], eval(t[1:])])
    557 
    558         t = list(t)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in <module>()

NameError: name 'iscellaneous' is not defined
### reloading attached file e6.sage modified at 02:40:16 ###
E7(1,0).branch(G2,b11)
21*G2(0,0) + 14*G2(1,0) + G2(0,1)
sage: E7(1,0).branch(G2,b21)
21*G2(0,0) + 14*G2(1,0) + G2(0,1)
sage: E7(1,1).branch(G2,b21)
1344*G2(0,0) + 2310*G2(1,0) + 980*G2(0,1) + 1050*G2(2,0) + 280*G2(1,1) + 84*G2(3,0) + 14*G2(0,2) + 6*G2(2,1)
sage: E7(1,1).branch(G2,b11)
1344*G2(0,0) + 2310*G2(1,0) + 980*G2(0,1) + 1050*G2(2,0) + 280*G2(1,1) + 84*G2(3,0) + 14*G2(0,2) + 6*G2(2,1)
sage: chi.branch(G2xC3,"miscellaneous")
G2xC3(1,0,1,0,0) + G2xC3(0,0,0,0,1)
sage: chi.branch(G2xC3,"miscellaneous").branch(C3,"proj2")
7*C3(1,0,0) + C3(0,0,1)
sage: chi.branch(F4)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-63-b6254d198a82> in <module>()
----> 1 chi.branch(F4)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2208     """
   2209     if type(rule) is str or type(rule) is list:
-> 2210         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2211     if hasattr(rule,"_S"):
   2212         if rule._S != S.cartan_type():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2488                     pass
   2489 
-> 2490         raise ValueError("No default rule found (you must specify the rule)")
   2491     elif rule == "identity":
   2492         if Rtype is not Stype:

ValueError: No default rule found (you must specify the rule)
sage: chi.branch(F4,b1
....: )
4*F4(0,0,0,0) + 2*F4(0,0,0,1)
sage: ### reloading attached file e6.sage modified at 03:23:01 ###
fg
composite branching rule F4 => (miscellaneous) G2xA1 => (proj1) G2
sage: F4(0,0,0,1).branch(G2,fg)
5*G2(0,0) + 3*G2(1,0)
sage: C3(0,0,1).degree()
14
sage: chi.branch(F4,b)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-68-1225d6025420> in <module>()
----> 1 chi.branch(F4,b)

NameError: name 'b' is not defined
sage: chi.branch(F4,b1)
4*F4(0,0,0,0) + 2*F4(0,0,0,1)
sage: F4(0,0,0,1).branch(G2,fg)
5*G2(0,0) + 3*G2(1,0)
sage: chi.branch(G2xC3,"miscellaneous")
G2xC3(1,0,1,0,0) + G2xC3(0,0,0,0,1)
sage: C3(0,0,1).degree()
14
sage: C3(0,0,1).branch(C2,"levi")
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-73-4cb912a2981d> in <module>()
----> 1 C3(Integer(0),Integer(0),Integer(1)).branch(C2,"levi")

NameError: name 'C2' is not defined
sage: ### reloading attached file e6.sage modified at 03:44:18 ###
C3(0,0,1).branch(C2,"levi")
C2(1,0) + 2*C2(0,1)
sage: C2(1,0).degree()
4
sage: C2(0,1).degree()
5
sage: ### reloading attached file e6.sage modified at 05:24:03 ###
### reloading attached file e6.sage modified at 05:24:18 ###

sage: C3(0,0,1).branch(A1,u)
A1(3) + A1(9)
sage: branching_rule("C1","A1","isomorphic")
isomorphic branching rule C1 => A1
sage: branching_rule("C1","A1","isomorphic")([X1,X2])
[1/2*X1, -1/2*X1]
sage: branching_rule("A1","C1","isomorphic")([X1,X2])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-80-2d51db693284> in <module>()
----> 1 branching_rule("A1","C1","isomorphic")([X1,X2])

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2783             return BranchingRule(Rtype, Stype, rule, "isomorphic")
   2784         else:
-> 2785             raise ValueError("Rule not found")
   2786     elif rule == "tensor" or rule == "tensor-debug":
   2787         if not Stype.is_compound():

ValueError: Rule not found
sage: 
Exiting Sage (CPU time 1m26.24s, Wall time 930m40.82s).
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..409650f 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -2761,26 +2761,30 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(1/2)*(x[0]-x[1]),0,-(1/2)*(x[0]-x[1])], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1], x[1]-x[0]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
+            def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
                  all(t[0] == 'A' for t in stypes):
             def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
-            def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 4.89836192131 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0176510810852 seconds
Total time spent compiling C/C++ extensions:  0.191381931305 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py", line 2785
    all(t[0] == 'A' for t in stypes):
                                    ^
SyntaxError: invalid syntax

running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m8.235s
user	0m2.872s
sys	0m0.850s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-24-05-28-16-ed7c523d.
Doctesting 1 file.
Traceback (most recent call last):
  File "/Users/bump/sagemath/sage/src/bin/sage-runtests", line 87, in <module>
    err = DC.run()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 898, in run
    self.run_doctests()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 668, in run_doctests
    self.dispatcher = DocTestDispatcher(self)
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1333, in __init__
    init_sage()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 95, in init_sage
    import sage.all_cmdline
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/all_cmdline.py", line 18, in <module>
    from sage.all import *
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/all.py", line 86, in <module>
    from sage.algebras.all   import *
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/algebras/all.py", line 37, in <module>
    from iwahori_hecke_algebra import IwahoriHeckeAlgebra, IwahoriHeckeAlgebraT
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/algebras/iwahori_hecke_algebra.py", line 33, in <module>
    from sage.combinat.root_system.weyl_group import WeylGroup
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/__init__.py", line 13, in <module>
    import all
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/all.py", line 11, in <module>
    from weyl_characters import WeylCharacterRing, branch_weyl_character, branching_rule_from_plethysm, get_branching_rule, branching_rule, WeightRing, BranchingRule
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py", line 2785
    all(t[0] == 'A' for t in stypes):
                                    ^
SyntaxError: invalid syntax
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-24-05-28-46-621b56df.
Doctesting 1 file.
Traceback (most recent call last):
  File "/Users/bump/sagemath/sage/src/bin/sage-runtests", line 87, in <module>
    err = DC.run()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 898, in run
    self.run_doctests()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 668, in run_doctests
    self.dispatcher = DocTestDispatcher(self)
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1333, in __init__
    init_sage()
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 95, in init_sage
    import sage.all_cmdline
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/all_cmdline.py", line 18, in <module>
    from sage.all import *
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/all.py", line 86, in <module>
    from sage.algebras.all   import *
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/algebras/all.py", line 37, in <module>
    from iwahori_hecke_algebra import IwahoriHeckeAlgebra, IwahoriHeckeAlgebraT
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/algebras/iwahori_hecke_algebra.py", line 33, in <module>
    from sage.combinat.root_system.weyl_group import WeylGroup
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/__init__.py", line 13, in <module>
    import all
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/all.py", line 11, in <module>
    from weyl_characters import WeylCharacterRing, branch_weyl_character, branching_rule_from_plethysm, get_branching_rule, branching_rule, WeightRing, BranchingRule
  File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py", line 2785
    all(t[0] == 'A' for t in stypes):
                                    ^
SyntaxError: invalid syntax
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.36168813705 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00383496284485 seconds
Total time spent compiling C/C++ extensions:  0.12334895134 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.513s
user	0m2.761s
sys	0m0.635s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-24-05-29-15-d6f6f00d.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [449 tests, 24.56 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 24.8 seconds
    cpu time: 22.6 seconds
    cumulative wall time: 24.6 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: B2=WeylCharacterRing("B2")
sage: C2=WeylCharacterRing("C2")
sage: b = branching_rule("B2","C2","isomorphic")
sage: B2(1,0).branch(C2,b)
C2(1,1)
sage: c = branching_rule("C2","B2","isomorphic")
sage: B2(1,0).branch(C2,b).branch(B2,c)
B2(1,0)
sage: B2(3,2).branch(C2,b).branch(B2,c)
B2(3,2)
sage: B2(1/2,1/2).branch(C2,b).branch(B2,c)
B2(1/2,1/2)
sage: B2(1/2,1/2).branch(C2,b)
C2(1,0)
sage: %attach /Users/bump/branch/e6.sage
sage: C3(0,0,1).branch(A1,u)
  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-11-37da9bf9c98d> in <module>()
----> 1 C3(Integer(0),Integer(0),Integer(1)).branch(A1,u)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2230         else:
   2231             mdict[h] = chi_mdict[k]
-> 2232     return S.char_from_weights(mdict)
   2233 
   2234 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    934                         del ddict[k]
    935                     else:
--> 936                         ddict[k] = ddict[k]-c*sdict[k]
    937                 else:
    938                     ddict[k] = -c*sdict[k]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __hash__(self)
    346             549810038                     # 32-bit
    347         """
--> 348         return hash(tuple(sorted([(m,c) for m,c in self._monomial_coefficients.iteritems()])))
    349 
    350     # For backward compatibility

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: u
diag branching rule C3 => A1
sage: C3(1,0,0)
C3(1,0,0)
sage: C3(1,0,0).branch(A1,u)
  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-14-76aee48cd9fe> in <module>()
----> 1 C3(Integer(1),Integer(0),Integer(0)).branch(A1,u)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2230         else:
   2231             mdict[h] = chi_mdict[k]
-> 2232     return S.char_from_weights(mdict)
   2233 
   2234 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    920         ddict = mdict.copy()
    921         while len(ddict) != 0:
--> 922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
    924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.__richcmp__ (sage/structure/element.c:8876)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element._richcmp (sage/structure/element.c:8741)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.pyc in __cmp__(left, right)
    417             return 0
    418         nonzero = lambda mc: mc[1] != 0
--> 419         v = filter(nonzero, left._monomial_coefficients.items())
    420         v.sort()
    421         w = filter(nonzero, right._monomial_coefficients.items())

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.pyc in <lambda>(mc)
    416         if have_same_parent(left, right) and left._monomial_coefficients == right._monomial_coefficients:
    417             return 0
--> 418         nonzero = lambda mc: mc[1] != 0
    419         v = filter(nonzero, left._monomial_coefficients.items())
    420         v.sort()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: u._f
<function __main__.f_u>
sage: ### reloading attached file e6.sage modified at 14:34:49 ###

sage: C3(1,0,0).branch(A1,u)
3*A1(1)
sage: C3(0,0,1).branch(A1,u)
5*A1(1) + A1(3)
sage: ### reloading attached file e6.sage modified at 14:36:33 ###
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-18-f1b9a4d1e3e2> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2U2LnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9915/e6.sagecUhURf.py in <module>()
    112 
    113 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
--> 114 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","A1",u)
    115 
    116 fg = branching_rule("F4","G2xA1","miscellaneous")*branching_rule("G2xA1","G2","proj1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2297             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2298         """
-> 2299         if self._S == other._R:
   2300             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2301             internames = flatten([self._intermediate_names, other._intermediate_names])

AttributeError: 'NoneType' object has no attribute '_R'
### reloading attached file e6.sage modified at 14:36:51 ###
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-18-f1b9a4d1e3e2> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2U2LnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9915/e6.sagegK3GMR.py in <module>()
    112 
    113 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
--> 114 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","A1",u)
    115 
    116 fg = branching_rule("F4","G2xA1","miscellaneous")*branching_rule("G2xA1","G2","proj1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2297             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2298         """
-> 2299         if self._S == other._R:
   2300             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2301             internames = flatten([self._intermediate_names, other._intermediate_names])

AttributeError: 'NoneType' object has no attribute '_R'

sage: C3(0,0,1).branch(A1,u)
5*A1(1) + A1(3)
sage: 
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-19-b1b47497b0b9> in <module>()
----> 1 get_ipython().magic(u'attach /Users/bump/branch/e6.sage')

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2134         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2135         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2136         return self.run_line_magic(magic_name, magic_arg_s)
   2137 
   2138     #-------------------------------------------------------------------------

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2060                 args.append(sys._getframe(stack_depth).f_locals)
   2061             with self.builtin_trap:
-> 2062                 result = fn(*args)
   2063             return result
   2064 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    189     # but it's overkill for just that one bit of state.
    190     def magic_deco(arg):
--> 191         call = lambda f, *a, **k: f(*a, **k)
    192 
    193         if callable(arg):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)
    118         """
    119         from sage.misc.preparser import load_wrap
--> 120         return self.shell.ex(load_wrap(s, attach=True))
    121 
    122     @line_magic

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in ex(self, cmd)
   2382         """Execute a normal python statement in user namespace."""
   2383         with self.builtin_trap:
-> 2384             exec cmd in self.user_global_ns, self.user_ns
   2385 
   2386     def ev(self, expr):

<string> in <module>()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/9915/e6.sageVLMRma.py in <module>()
    112 
    113 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
--> 114 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","A1",u)
    115 
    116 fg = branching_rule("F4","G2xA1","miscellaneous")*branching_rule("G2xA1","G2","proj1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2297             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2298         """
-> 2299         if self._S == other._R:
   2300             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2301             internames = flatten([self._intermediate_names, other._intermediate_names])

AttributeError: 'NoneType' object has no attribute '_R'
sage: 
Exiting Sage (CPU time 1m49.80s, Wall time 54m0.51s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━sage: 
┛
sage:   File "<ipython-input-1-58dea9f72cfa>", line 1
    ┛
    ^
SyntaxError: invalid syntax

sage %attach /Users/bump/branch/e6.sage
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-2-b1b47497b0b9> in <module>()
----> 1 get_ipython().magic(u'attach /Users/bump/branch/e6.sage')

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2134         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2135         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2136         return self.run_line_magic(magic_name, magic_arg_s)
   2137 
   2138     #-------------------------------------------------------------------------

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2060                 args.append(sys._getframe(stack_depth).f_locals)
   2061             with self.builtin_trap:
-> 2062                 result = fn(*args)
   2063             return result
   2064 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    189     # but it's overkill for just that one bit of state.
    190     def magic_deco(arg):
--> 191         call = lambda f, *a, **k: f(*a, **k)
    192 
    193         if callable(arg):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)
    118         """
    119         from sage.misc.preparser import load_wrap
--> 120         return self.shell.ex(load_wrap(s, attach=True))
    121 
    122     @line_magic

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in ex(self, cmd)
   2382         """Execute a normal python statement in user namespace."""
   2383         with self.builtin_trap:
-> 2384             exec cmd in self.user_global_ns, self.user_ns
   2385 
   2386     def ev(self, expr):

<string> in <module>()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/10021/e6.sageSrKCAB.py in <module>()
    112 
    113 b1 = branching_rule("E7","E6","levi")*branching_rule("E6","F4","symmetric")
--> 114 b2 = branching_rule("E7","G2xC3","miscellaneous")*branching_rule("G2xC3","C3","proj2")*branching_rule("C3","A1",u)
    115 
    116 fg = branching_rule("F4","G2xA1","miscellaneous")*branching_rule("G2xA1","G2","proj1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2297             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2298         """
-> 2299         if self._S == other._R:
   2300             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2301             internames = flatten([self._intermediate_names, other._intermediate_names])

AttributeError: 'NoneType' object has no attribute '_R'
sage: ### reloading attached file e6.sage modified at 14:38:57 ###

sage: branching_rule("C3","A1",u)
sage: branching_rule("C3","A1",u)
sage: ### reloading attached file e6.sage modified at 14:39:29 ###

sage: E7(0,0,0,0,0,0,1).branch(A1,b2)
26*A1(1) + A1(3)
sage: E7(0,0,0,0,0,0,1).branch(F4,b1)
4*F4(0,0,0,0) + 2*F4(0,0,0,1)
sage: b2([X0,X1,X2,X3,X4,X5,X6,-X6])
[X5 - X6, -X5 + X6]
sage: b1([X0,X1,X2,X3,X4,X5,X6,-X6])
[1/2*X4 - 1/2*X5 - X6,
 1/2*X0 + 1/2*X1 + 1/2*X2 + 1/2*X3,
 -1/2*X0 - 1/2*X1 + 1/2*X2 + 1/2*X3,
 -1/2*X0 + 1/2*X1 - 1/2*X2 + 1/2*X3]
sage: ### reloading attached file e6.sage modified at 14:48:36 ###
### reloading attached file e6.sage modified at 14:49:15 ###
b
miscellaneous branching rule E7 => F4xA1
sage: E7(0,0,0,0,0,0,1).branch(F4xA1,b)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-10-26451222e0a4> in <module>()
----> 1 E7(Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(1)).branch(F4xA1,b)

NameError: name 'F4xA1' is not defined
sage: ### reloading attached file e6.sage modified at 15:50:29 ###
E7(0,0,0,0,0,0,1).branch(F4xA1,b)
F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
sage: E7(1,0,0,0,0,0,0).branch(F4xA1,b)
F4xA1(1,0,0,0,0) + F4xA1(0,0,0,1,2) + F4xA1(0,0,0,0,2)
sage: E7(0,1,0,0,0,0,0).branch(F4xA1,b)
F4xA1(1,0,0,0,3) + F4xA1(0,0,0,1,1) + F4xA1(0,0,0,1,3) + F4xA1(0,0,1,0,1) + F4xA1(0,0,0,0,1)
sage: E7(0,1,0,0,0,0,0).degree()
912
sage: 
Exiting Sage (CPU time 0m13.65s, Wall time 86m53.98s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 3.11741805077 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0036609172821 seconds
Total time spent compiling C/C++ extensions:  0.133616924286 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m4.437s
user	0m2.845s
sys	0m0.690s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: F4=WeylCharacterRing("F4",style="coroots")
sage: E7=WeylCharacterRing("E7",style="coroots")
sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
sage: E7(0,0,0,0,0,0,1).branch(F4xA1,rule="miscellaneous")
  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-4-48c3d8da964d> in <module>()
----> 1 E7(Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(1)).branch(F4xA1,rule="miscellaneous")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2230         else:
   2231             mdict[h] = chi_mdict[k]
-> 2232     return S.char_from_weights(mdict)
   2233 
   2234 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    926             c = ddict[highest]
    927             if highest in hdict:
--> 928                 hdict[highest] += c
    929             else:
    930                 hdict[highest] = c

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __hash__(self)
    346             549810038                     # 32-bit
    347         """
--> 348         return hash(tuple(sorted([(m,c) for m,c in self._monomial_coefficients.iteritems()])))
    349 
    350     # For backward compatibility

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: bb = branching_rule("E7","F4xA1","miscellaneous")
sage: %attach /Users/bump/branch/e6.sage
sage: b([X0,X1,X2,X3,X4,X5,X6,X7])
[1/2*X4 - 1/2*X5 - X6,
 1/2*X0 + 1/2*X1 + 1/2*X2 + 1/2*X3,
 -1/2*X0 - 1/2*X1 + 1/2*X2 + 1/2*X3,
 -1/2*X0 + 1/2*X1 - 1/2*X2 + 1/2*X3,
 X5 - X6,
 -X5 + X6]
sage: bb([X0,X1,X2,X3,X4,X5,X6,X7])
[-X6, 0, 0, 0, X5 - X6, -X5 + X6]
sage: bb
miscellaneous branching rule E7 => F4xA1
sage: bb_f
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-10-33ab45ecc6a2> in <module>()
----> 1 bb_f

NameError: name 'bb_f' is not defined
sage: bb._f
<function sage.combinat.root_system.weyl_characters.f>
sage: bb._f([1,2,3,4,5,6,7,8])
[-7, 0, 0, 0, -1, 1]
sage: 
Exiting Sage (CPU time 1m16.50s, Wall time 9m42.43s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.36193084717 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00385999679565 seconds
Total time spent compiling C/C++ extensions:  0.125334978104 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.504s
user	0m2.744s
sys	0m0.642s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: b = branching_rule("E7","F4xA1","miscellaneous")
sage: b([1,2,3,4,5,6,7,8])
[1, 2, 3, 4, 5, 6, 7, 8]
[1, 2, 3, 4, 5, 6, 7]
[-7, 0, 0, 0, -1, 1]
sage: 
Exiting Sage (CPU time 0m0.12s, Wall time 2m8.83s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.3646261692 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0034351348877 seconds
Total time spent compiling C/C++ extensions:  0.128215074539 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.505s
user	0m2.753s
sys	0m0.637s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: b = branching_rule("E7","F4xA1","miscellaneous")
sage: b([1,2,3,4,5,6,7,8])
[1, 2, 3, 4, 5, 6, 7, 8]
[1, 2, 3, 4, 5, 6, 7]
x0,x1,x2,x3,x4,x5,x6= 1 2 3 4 5 6 7
[-7, 0, 0, 0, -1, 1]
sage: 
Exiting Sage (CPU time 0m0.09s, Wall time 1m13.03s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.33582091331 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00517797470093 seconds
Total time spent compiling C/C++ extensions:  0.127608060837 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.475s
user	0m2.737s
sys	0m0.627s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: b = branching_rule("E7","F4xA1","miscellaneous")
sage: b([1,2,3,4,5,6,7,8])
[1, 2, 3, 4, 5, 6, 7, 8]
[1, 2, 3, 4, 5, 6, 7]
x0,x1,x2,x3,x4,x5,x6= 1 2 3 4 5 6 7
0
[-7, 0, 0, 0, -1, 1]
sage: 
Exiting Sage (CPU time 0m0.13s, Wall time 2m20.39s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.35858893394 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00367188453674 seconds
Total time spent compiling C/C++ extensions:  0.129228115082 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.508s
user	0m2.751s
sys	0m0.651s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: B2=WeylCharacterRing("B2",style="coroots")
sage: C2=WeylCharacterRing("C2",style="coroots")
sage: C2(1,0).branch(B2,"isomorphic")
B2(0,1)
sage: C2=WeylCharacterRing("C2")
sage: B2=WeylCharacterRing("B2")
sage: C2(1,0).branch(B2,"isomorphic")
B2(1/2,1/2)
sage: b = branching_rule("E7","F4xA1","miscellaneous")
sage: b([1,2,3,4,5,6,7,8])
[1, 2, 3, 4, 5, 6, 7, 8]
[1, 2, 3, 4, 5, 6, 7]
x0,x1,x2,x3,x4,x5,x6= 1 2 3 4 5 6 7
0 10
0 5
[-7, 0, 0, 0, -1, 1]
sage: 3/2
3/2
sage: A1=WeylCharacterRing("A1")
sage: B1=WeylCharacterRing("B1")
sage: A1(1)
A1(0,0)
sage: A1(1,)
A1(0,0)
sage: A1((1,)
....: )
A1(1,0)
sage: A1((1,))
A1(1,0)
sage: A1((1,)).branch(B1,"isomorphic")
2*B1(0)
sage: B1=WeylCharacterRing("B1",style="coroots")
sage: A1=WeylCharacterRing("A1",style="coroots")
sage: B1((1,))
B1(1)
sage: B1((1,)).degree()
2
sage: B1.branch(A1,"isomorphic")
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-21-c33b0d3039de> in <module>()
----> 1 B1.branch(A1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:6823)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1606)()

AttributeError: 'WeylCharacterRing_with_category' object has no attribute 'branch'
sage: B1((1,)).branch(A1,"isomorphic")
A1(1)
sage: B1((1,)).branch(A1,"isomorphic").branch(B1,"isomorphic")
2*B1(0)
sage: 
Exiting Sage (CPU time 0m3.55s, Wall time 5m42.17s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.3907289505 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00372099876404 seconds
Total time spent compiling C/C++ extensions:  0.132379055023 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.557s
user	0m2.793s
sys	0m0.671s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A1=WeylCharacterRing("A1","coroots")
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-e06c925db34e> in <module>()
----> 1 A1=WeylCharacterRing("A1","coroots")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:1224)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __classcall__(cls, ct, base_ring, prefix, style)
    108             else:
    109                 prefix = ct.__repr__()
--> 110         return super(WeylCharacterRing, cls).__classcall__(cls, ct, base_ring=base_ring, prefix=prefix, style=style)
    111 
    112     def __init__(self, ct, base_ring=ZZ, prefix=None, style="lattice"):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.WeakCachedFunction.__call__ (sage/misc/cachefunc.c:5673)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.pyc in __classcall__(cls, *args, **options)
    445 
    446         """
--> 447         instance = typecall(cls, *args, **options)
    448         assert isinstance( instance, cls )
    449         if instance.__class__.__reduce__ == CachedRepresentation.__reduce__:

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.typecall (sage/misc/classcall_metaclass.c:1586)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __init__(self, ct, base_ring, prefix, style)
    134         # TODO: remove the Category.join once not needed anymore (bug in CombinatorialFreeModule)
    135         # TODO: use GradedAlgebrasWithBasis
--> 136         category = Category.join([AlgebrasWithBasis(base_ring), Algebras(base_ring).Subobjects()])
    137         CombinatorialFreeModule.__init__(self, base_ring, self._space, category = category)
    138 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:1224)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/categories/category.pyc in __classcall__(cls, *args, **options)
    461         if isinstance(cls, DynamicMetaclass):
    462             cls = cls.__base__
--> 463         return super(Category, cls).__classcall__(cls, *args, **options)
    464 
    465     def __init__(self, s=None):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.WeakCachedFunction.__call__ (sage/misc/cachefunc.c:5673)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.pyc in __classcall__(cls, *args, **options)
    445 
    446         """
--> 447         instance = typecall(cls, *args, **options)
    448         assert isinstance( instance, cls )
    449         if instance.__class__.__reduce__ == CachedRepresentation.__reduce__:

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.typecall (sage/misc/classcall_metaclass.c:1586)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/categories/category_types.pyc in __init__(self, base, name)
    324     def __init__(self, base, name=None):
    325         from sage.categories.rings import Rings
--> 326         assert base in Rings(), "base must be a ring"
    327         Category_over_base.__init__(self, base, name)
    328 

AssertionError: base must be a ring
sage: A1=WeylCharacterRing("A1",style="coroots")
sage: B1=WeylCharacterRing("B1",style="coroots")
sage: A1((1,))
A1(1)
sage: A1((1,)).degree()
2
sage: A1((1,)).branch(B1,"isomorphic")
  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-6-571d4448dc26> in <module>()
----> 1 A1((Integer(1),)).branch(B1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2230         else:
   2231             mdict[h] = chi_mdict[k]
-> 2232     return S.char_from_weights(mdict)
   2233 
   2234 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    920         ddict = mdict.copy()
    921         while len(ddict) != 0:
--> 922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
    924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.pyc in __eq__(self, other)
    380             sage: TestSuite(F).run()
    381         """
--> 382         if have_same_parent(self, other):
    383             return self._monomial_coefficients == other._monomial_coefficients
    384         from sage.structure.element import get_coercion_model

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: 
Exiting Sage (CPU time 0m41.87s, Wall time 3m57.89s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.41909003258 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00363206863403 seconds
Total time spent compiling C/C++ extensions:  0.130448818207 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.579s
user	0m2.822s
sys	0m0.651s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
A1xF4=WeylCharacterRing("A1xF4",style="coroots")

sage: sage: sage: E7=WeylCharacterRing("E7",style="coroots")
sage: E7(0,0,0,0,0,0,1).degree()
56
sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-5-bd012226b349> in <module>()
----> 1 E7(Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(1)).branch(F4xA1,"miscellaneous")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2222                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2223             else:
-> 2224                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2225         else:
   2226             h = S._space(rule(list(k.to_vector())))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2284             return self._f(x)
   2285         except:
-> 2286             return self._f(x.to_vector())
   2287 
   2288     def __mul__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-6-bd012226b349> in <module>()
----> 1 E7(Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(1)).branch(F4xA1,"miscellaneous")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2222                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2223             else:
-> 2224                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2225         else:
   2226             h = S._space(rule(list(k.to_vector())))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2284             return self._f(x)
   2285         except:
-> 2286             return self._f(x.to_vector())
   2287 
   2288     def __mul__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: 
Exiting Sage (CPU time 0m6.46s, Wall time 73m57.53s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.69014310837 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00359320640564 seconds
Total time spent compiling C/C++ extensions:  0.128150939941 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.867s
user	0m2.797s
sys	0m0.665s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
sage: E7(0,0,0,0,0,0,1).branch(A1xF4,"miscellaneous")
A1xF4(1,0,0,0,1) + A1xF4(3,0,0,0,0)
sage: E7(1,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
F4xA1(1,0,0,0,1) + F4xA1(1,0,0,0,3) + 2*F4xA1(0,0,0,1,1) + 2*F4xA1(0,0,0,1,3) + F4xA1(0,0,0,1,5) + F4xA1(0,0,1,0,1) + F4xA1(0,0,1,0,3) + F4xA1(1,0,0,1,1) + F4xA1(0,0,0,2,1) + F4xA1(0,0,0,2,3) + F4xA1(0,0,0,0,1) + F4xA1(0,0,0,0,3) + F4xA1(0,0,0,0,5)
sage: E7(1,0,0,0,0,0,0).branch(F4xA1,"miscellaneous")
F4xA1(1,0,0,0,0) + F4xA1(0,0,0,1,2) + F4xA1(0,0,0,0,2)
sage: 
Exiting Sage (CPU time 0m12.87s, Wall time 3m39.80s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.38828420639 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00358200073242 seconds
Total time spent compiling C/C++ extensions:  0.132368087769 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.538s
user	0m2.783s
sys	0m0.654s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage:         sage: E7=WeylCharacterRing("E7",style="coroots")

sage: sage:         sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")

sage: time E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.py:371: DeprecationWarning: Use %time instead of time.
See http://trac.sagemath.org/12719 for details.
  line = f(line, line_number)
CPU times: user 0.22 s, sys: 0.03 s, total: 0.24 s
Wall time: 0.23 s
F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
sage: 
Exiting Sage (CPU time 0m3.53s, Wall time 0m42.32s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py
Running doctests with ID 2013-12-24-09-51-06-18599191.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [451 tests, 22.44 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 22.6 seconds
    cpu time: 22.4 seconds
    cumulative wall time: 22.4 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t weyl_characters.py
Running doctests with ID 2013-12-24-09-51-44-20fdbaa7.
Doctesting 1 file.
sage -t weyl_characters.py
    [440 tests, 10.37 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 10.5 seconds
    cpu time: 10.4 seconds
    cumulative wall time: 10.4 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
sage: fw=B1.fundamental_weights()
sage: B1(fw[1]).degree()
2
sage: B1(fw[1])
B1(1/2)
sage: B1(fw[1]).branch(A1,"isomorphic")
A1(1)
sage: B1(fw[1]).branch(A1,"isomorphic").branch(B1,"isomorphic")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-6-75ea131d7135> in <module>()
----> 1 B1(fw[Integer(1)]).branch(A1,"isomorphic").branch(B1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: A1((1,0))
A1(1)
sage: A1((1,0)).degree()
2
sage: A1((1,-1))
A1(1)
sage: A1((1,-1)).degree()
2
sage: A1((1,-1)).branch(B1,"isomorphic")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-11-eec0ba0896c1> in <module>()
----> 1 A1((Integer(1),-Integer(1))).branch(B1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: B1(1/2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-12-1fae273d07f2> in <module>()
----> 1 B1(Integer(1)/Integer(2))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, *args)
    390         if len(args) > 1:
    391             args = (args,)
--> 392         return super(WeylCharacterRing, self).__call__(*args)
    393 
    394     def _element_constructor_(self, weight):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8372)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3856)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3757)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _element_constructor_(self, weight)
    411             A2(2,1,0)
    412         """
--> 413         weight = self._space.from_vector_notation(weight, style = self._style)
    414         if not weight.is_dominant_weight():
    415             raise ValueError("{} is not a dominant element of the weight lattice".format(weight))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in from_vector_notation(self, weight, style)
    323             weight = self.linear_combination(zip(self.fundamental_weights(), weight))
    324 
--> 325         x = self(weight)
    326 
    327         if style == "coroots":

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __call__(self, v)
    179             return self._from_dict(dict((i,K(c)) for i,c in enumerate(v) if c))
    180         else:
--> 181             return CombinatorialFreeModule.__call__(self, v)
    182 
    183 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8372)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3856)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3757)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.pyc in _element_constructor_(self, x)
   1527                 return self.zero()
   1528             else:
-> 1529                 raise TypeError, "do not know how to make x (= %s) an element of %s"%(x, self)
   1530         #x is an element of the basis enumerated set;
   1531         # This is a very ugly way of testing this

TypeError: do not know how to make x (= 1/2) an element of Ambient space of the Root system of type ['B', 1]
sage: B1((1/2,))
B1(1/2)
sage: B1((1/2,)).degree()
2
sage: B1((1,)).degree()
3
sage: B1.space()
Ambient space of the Root system of type ['B', 1]
sage: B1.space().an_element()
(2)
sage: A1((1,0))
A1(1)
sage: ### reloading attached file e6.sage modified at 18:14:06 ###

sage: 
Exiting Sage (CPU time 0m7.13s, Wall time 27m16.79s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 3.91925907135 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00433421134949 seconds
Total time spent compiling C/C++ extensions:  0.13337802887 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m5.313s
user	0m2.856s
sys	0m0.696s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: B1=WeylCharacterRing("B1")
sage: A1=WeylCharacterRing("A1")
sage: A1((1,0)).branch(B1,"isomorphic")
B1(1/2)
sage: A1((1,0)).branch(B1,"isomorphic").branch(A1,"isomorphic")
A1(1/2,-1/2)
sage: A1((1,-1)).branch(B1,"isomorphic").branch(A1,"isomorphic")
A1(1,-1)
sage: A1((1/2,-1/2)).branch(B1,"isomorphic").branch(A1,"isomorphic")
A1(1/2,-1/2)
sage: A1((1/2,-1/2)).branch(B1,"isomorphic").branch(A1,"isomorphic")==A1(1/2,-1/2)
True
sage: C1=WeylCharacterRing("C1")
sage: C1(1,0).degree()
2
sage: C1(1,0).branch(A1,"isomorphic")
A1(1/2,-1/2)
sage: C1(1,0).branch(A1,"isomorphic").degree()
2
sage: C1(1,0).branch(A1,"isomorphic").branch(C1.
....: )
  File "<ipython-input-12-3a34b7861371>", line 2
    )
    ^
SyntaxError: invalid syntax

sage: C1(1,0).branch(A1,"isomorphic").branch(C1,"isomorphic")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-13-29c404fd83fd> in <module>()
----> 1 C1(Integer(1),Integer(0)).branch(A1,"isomorphic").branch(C1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: C1(1,0).branch(A1,"isomorphic")
A1(1/2,-1/2)
sage: A1(1/2,-1/2).degree()
2
sage: A1(1/2,-1/2).branch(C1,"isomorphic")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-16-619b7ebc13f5> in <module>()
----> 1 A1(Integer(1)/Integer(2),-Integer(1)/Integer(2)).branch(C1,"isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: 
Exiting Sage (CPU time 0m0.53s, Wall time 3m46.43s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.36519503593 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00377178192139 seconds
Total time spent compiling C/C++ extensions:  0.125886917114 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.513s
user	0m2.758s
sys	0m0.640s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A1=WeylCharacterRing("A1")
sage: C1=WeylCharacterRing("C1")
sage: A1(1/2,-1/2).branch(C1,"isomorphic")
C1(1)
sage: A1(1/2,-1/2).branch(C1,"isomorphic").degree()
2
sage: A1(1/2,-1/2).branch(C1,"isomorphic").branch(A1,"isomorphic")
A1(1/2,-1/2)
sage: C1(1)
C1(0)
sage: C1(1).degree()
1
sage: C1((1,0)).degree()
2
sage: C1((1)).degree()
1
sage: C1((1,)).degree()
2
sage: 
Exiting Sage (CPU time 0m0.35s, Wall time 6m18.70s).
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..a6d0b0e 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1975,6 +1975,9 @@ def branch_weyl_character(chi, R, S, rule="default"):
         sage: G2xC3=WeylCharacterRing("G2xC3",style="coroots")
         sage: E7(0,1,0,0,0,0,0).branch(G2xC3,rule="miscellaneous") # long time (1.84s)
         G2xC3(1,0,1,0,0) + G2xC3(1,0,1,1,0) + G2xC3(0,1,0,0,1) + G2xC3(2,0,1,0,0) + G2xC3(0,0,1,1,0)
+        sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
+        sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
+        F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
         sage: E8 = WeylCharacterRing("E8",style="coroots")
         sage: G2xF4 = WeylCharacterRing("G2xF4",style="coroots")
         sage: E8(0,0,0,0,0,0,0,1).branch(G2xF4,rule="miscellaneous") # long time (0.76s)
@@ -2761,26 +2764,29 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(x[0]-x[1])/2], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
-                 all(t[0] == 'A' for t in stypes):
-            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
             def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
+            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
@@ -2895,6 +2901,16 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[6],x[4]+x[5],-x[4]+x[5],x[1]+x[3],x[2]-x[3],-x[1]-x[2]],"miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("C3")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3],x[2]-x[3],-x[1]-x[2],-2*x[6],x[4]+x[5],-x[4]+x[5]],"miscellaneous")
+                elif stypes == [CartanType("F4"),CartanType("A1")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2,x5-x6,x6-x5]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
+                elif stypes == [CartanType("A1"),CartanType("F4")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [x5-x6,x6-x5,(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
                 else:
                     raise ValueError("Rule not found")
         elif Rtype == CartanType("E8"):
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A5=WeylCharacterRing("A5",style="coroots")
A4=WeylCharacterRing("A4",style="coroots")
A3=WeylCharacterRing("A3",style="coroots")
C3=WeylCharacterRing("C3",style="coroots")
D3=WeylCharacterRing("D3",style="coroots")
A3xA1=WeylCharacterRing("A3xA1",style="coroots")
A2xA2=WeylCharacterRing("A2xA2",style="coroots")
fw = A5.fundamental_weights()

sage: sage: sage: sage: sage: sage: sage: sage: sage: [A5(hwv).branch(D3,rule="symmetric") for hwv in fw]
[D3(1,0,0), D3(0,1,1), D3(0,2,0) + D3(0,0,2), D3(0,1,1), D3(1,0,0)]
sage: A7=WeylCharacterRing("A6",style="coroots")
sage: D4=WeylCharacterRing("D4",style="coroots")
sage: [A7(hwv).branch(D4, rule="symmetric") for hwv in A7.fundamental_weights()]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-12-9e9c19d06bbd> in <module>()
----> 1 [A7(hwv).branch(D4, rule="symmetric") for hwv in A7.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2211     """
   2212     if type(rule) is str or type(rule) is list:
-> 2213         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2214     if hasattr(rule,"_S"):
   2215         if rule._S != S.cartan_type():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2584                 return BranchingRule(Rtype, Stype, lambda x : [x[i]-x[r-i] for i in range(s)], "symmetric")
   2585             else:
-> 2586                 raise ValueError("Rule not found")
   2587         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
   2588             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")

ValueError: Rule not found
sage: A7
The Weyl Character Ring of Type A6 with Integer Ring coefficients
sage: A7=WeylCharacterRing("A7",style="coroots")
sage: [A7(hwv).branch(D4, rule="symmetric") for hwv in A7.fundamental_weights()]
[D4(1,0,0,0),
 D4(0,1,0,0),
 D4(0,0,1,1),
 D4(0,0,2,0) + D4(0,0,0,2),
 D4(0,0,1,1),
 D4(0,1,0,0),
 D4(1,0,0,0)]
sage: %attach /Users/bump/branch/e6.sage
sage: C4(0,1,0,0).degree()
27
sage: [E6(f).degree() for f in E6.fundamental_weights()]
[27, 78, 351, 2925, 351, 27]
sage: E6.fundamental_weights()[1]
(0, 0, 0, 0, 0, -2/3, -2/3, 2/3)
sage: chi=E6(1,0)
sage: chi.branch(A5xA1,"levi")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-21-26d158a8ddfd> in <module>()
----> 1 chi.branch(A5xA1,"levi")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2211     """
   2212     if type(rule) is str or type(rule) is list:
-> 2213         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2214     if hasattr(rule,"_S"):
   2215         if rule._S != S.cartan_type():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2498     elif rule == "levi":
   2499         if not s == r-1:
-> 2500             raise ValueError("Incompatible ranks")
   2501         if Rtype[0] == 'A':
   2502             if Stype.is_compound():

ValueError: Incompatible ranks
sage: chi
E6(1,0,0,0,0,0)
sage: chi.branch(A5xA1,"extended").branch(A5,"proj1")
A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
sage: A5(0,0,0,1,0).degree()
15
sage: C4.fundamental_weights()[2]
(1, 1, 0, 0)
sage: C4.highest_root()
(2, 0, 0, 0)
sage: C4(C4.highest_root())
C4(2,0,0,0)
sage: ad = _
sage: ad
C4(2,0,0,0)
sage: ad.degree()
36
sage: C4(0,0,0,1).degree()
42
sage: [E6(f) for f in E6.fundamental_weights()]
[E6(1,0,0,0,0,0),
 E6(0,1,0,0,0,0),
 E6(0,0,1,0,0,0),
 E6(0,0,0,1,0,0),
 E6(0,0,0,0,1,0),
 E6(0,0,0,0,0,1)]
sage: [E6(f).degree() for f in E6.fundamental_weights()]
[27, 78, 351, 2925, 351, 27]
sage: E6(0,1).degree()
78
sage: branching_rule("A9","D5","symmetric").describe()

0
O-------------------------------+
|                               |
|                               |
O---O---O---O---O---O---O---O---O
1   2   3   4   5   6   7   8   9
A9~
root restrictions A9 => D5:

        O 5
        |
        |
O---O---O---O
1   2   3   4
D5

1 => 1
2 => 2
3 => 3
4 => 4
6 => 4
7 => 3
8 => 2
9 => 1

For more detailed information use verbose=True
sage: branching_rule("A9","D5","symmetric").describe(verbose=True)

0
O-------------------------------+
|                               |
|                               |
O---O---O---O---O---O---O---O---O
1   2   3   4   5   6   7   8   9
A9~
root restrictions A9 => D5:

        O 5
        |
        |
O---O---O---O
1   2   3   4
D5

0 => weight (-2, 0, 0, 0, 0)
1 => 1
2 => 2
3 => 3
4 => 4
5 => weight (0, 0, 0, 0, 2)
6 => 4
7 => 3
8 => 2
9 => 1

fundamental weight restrictions A9 => D5:
1 => (1, 0, 0, 0, 0)
2 => (0, 1, 0, 0, 0)
3 => (0, 0, 1, 0, 0)
4 => (0, 0, 0, 1, 1)
5 => (0, 0, 0, 0, 2)
6 => (0, 0, 0, 1, 1)
7 => (0, 0, 1, 0, 0)
8 => (0, 1, 0, 0, 0)
9 => (1, 0, 0, 0, 0)
sage: D5.simple_roots()
Finite family {1: (1, -1, 0, 0, 0), 2: (0, 1, -1, 0, 0), 3: (0, 0, 1, -1, 0), 4: (0, 0, 0, 1, -1), 5: (0, 0, 0, 1, 1)}
sage: chi
E6(1,0,0,0,0,0)
sage: chi?
Type:       WeylCharacterRing_with_category.element_class
String Form:E6(1,0,0,0,0,0)
Length:     1
File:       /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py
Docstring:     A class for Weyl characters.

Constructor Docstring:
   Create a combinatorial module element. This should never be called
   directly, but only through the parent combinatorial free module's
   "__call__()" method.

   TESTS:

      sage: F = CombinatorialFreeModule(QQ, ['a','b','c'])
      sage: B = F.basis()
      sage: f = B['a'] + 3*B['c']; f
      B['a'] + 3*B['c']
      sage: f == loads(dumps(f))
      True
sage: ### reloading attached file e6.sage modified at 23:24:06 ###
### reloading attached file e6.sage modified at 23:24:07 ###

sage: ### reloading attached file e6.sage modified at 01:33:15 ###

sage: f
<function sage.combinat.root_system.weyl_characters.<lambda>>
sage: [f(v) for v in E6(1,0).weight_multiplicities()]
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [0, 0, 0, 0],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [0, 0, 0, 0],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [0, 0, 0, 0],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: [f(v) for v in E6(1,0).weight_multiplicities() if f(v) != [0,0,0,0]]
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: len([f(v) for v in E6(1,0).weight_multiplicities() if f(v) != [0,0,0,0]])
24
sage: tf = [f(v) for v in E6(1,0).weight_multiplicities() if f(v) != [0,0,0,0]]; tf
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: len(tf)
24
sage: uf = [u for u in C4(0,1,0,0).weight_multiplicities() if u != C4.space().zero()]
sage: len(uf)
24
sage: uf
[(0, 0, 1, 1),
 (-1, 0, 0, 1),
 (0, -1, 0, 1),
 (-1, 0, 0, -1),
 (0, 1, 1, 0),
 (0, 0, -1, 1),
 (0, -1, -1, 0),
 (0, 1, -1, 0),
 (-1, 0, 1, 0),
 (0, 0, -1, -1),
 (1, 1, 0, 0),
 (-1, -1, 0, 0),
 (-1, 1, 0, 0),
 (1, 0, 0, -1),
 (0, 1, 0, 1),
 (1, 0, -1, 0),
 (0, -1, 1, 0),
 (0, 0, 1, -1),
 (-1, 0, -1, 0),
 (1, 0, 1, 0),
 (1, 0, 0, 1),
 (0, -1, 0, -1),
 (0, 1, 0, -1),
 (1, -1, 0, 0)]
sage: phi = lambda x: [x[0]+x[1]+x[2]+x[3],x[0]+x[1]-x[2]-x[3],x[0]-x[1]+x[2]-x[3],x[0]-x[1]-x[2]+x[3]]
sage: [phi(v) for v in tf]
[[1, 1, 1, -1],
 [0, 0, 0, -2],
 [-1, -1, 1, -1],
 [1, -1, 1, -1],
 [1, 1, -1, -1],
 [-2, 0, 0, 0],
 [-1, 1, 1, -1],
 [2, 0, 0, 0],
 [0, 0, -2, 0],
 [-1, 1, -1, -1],
 [-1, -1, 1, 1],
 [0, 0, 0, 2],
 [-1, 1, -1, 1],
 [1, -1, -1, -1],
 [-1, 1, 1, 1],
 [1, -1, 1, 1],
 [0, 2, 0, 0],
 [-1, -1, -1, -1],
 [0, 0, 2, 0],
 [1, 1, 1, 1],
 [-1, -1, -1, 1],
 [1, 1, -1, 1],
 [0, -2, 0, 0],
 [1, -1, -1, 1]]
sage: [phi(v) for v in uf]
[[2, -2, 0, 0],
 [0, -2, -2, 0],
 [0, -2, 0, 2],
 [-2, 0, 0, -2],
 [2, 0, 0, -2],
 [0, 0, -2, 2],
 [-2, 0, 0, 2],
 [0, 2, -2, 0],
 [0, -2, 0, -2],
 [-2, 2, 0, 0],
 [2, 2, 0, 0],
 [-2, -2, 0, 0],
 [0, 0, -2, -2],
 [0, 2, 2, 0],
 [2, 0, -2, 0],
 [0, 2, 0, 2],
 [0, -2, 2, 0],
 [0, 0, 2, -2],
 [-2, 0, -2, 0],
 [2, 0, 2, 0],
 [2, 0, 0, 2],
 [-2, 0, 2, 0],
 [0, 2, 0, -2],
 [0, 0, 2, 2]]
sage: uf
[(0, 0, 1, 1),
 (-1, 0, 0, 1),
 (0, -1, 0, 1),
 (-1, 0, 0, -1),
 (0, 1, 1, 0),
 (0, 0, -1, 1),
 (0, -1, -1, 0),
 (0, 1, -1, 0),
 (-1, 0, 1, 0),
 (0, 0, -1, -1),
 (1, 1, 0, 0),
 (-1, -1, 0, 0),
 (-1, 1, 0, 0),
 (1, 0, 0, -1),
 (0, 1, 0, 1),
 (1, 0, -1, 0),
 (0, -1, 1, 0),
 (0, 0, 1, -1),
 (-1, 0, -1, 0),
 (1, 0, 1, 0),
 (1, 0, 0, 1),
 (0, -1, 0, -1),
 (0, 1, 0, -1),
 (1, -1, 0, 0)]
sage: dirs
[]
sage: [phi(v) for v in tf]
[[1, 1, 1, -1],
 [0, 0, 0, -2],
 [-1, -1, 1, -1],
 [1, -1, 1, -1],
 [1, 1, -1, -1],
 [-2, 0, 0, 0],
 [-1, 1, 1, -1],
 [2, 0, 0, 0],
 [0, 0, -2, 0],
 [-1, 1, -1, -1],
 [-1, -1, 1, 1],
 [0, 0, 0, 2],
 [-1, 1, -1, 1],
 [1, -1, -1, -1],
 [-1, 1, 1, 1],
 [1, -1, 1, 1],
 [0, 2, 0, 0],
 [-1, -1, -1, -1],
 [0, 0, 2, 0],
 [1, 1, 1, 1],
 [-1, -1, -1, 1],
 [1, 1, -1, 1],
 [0, -2, 0, 0],
 [1, -1, -1, 1]]
sage: tf
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: uf
[(0, 0, 1, 1),
 (-1, 0, 0, 1),
 (0, -1, 0, 1),
 (-1, 0, 0, -1),
 (0, 1, 1, 0),
 (0, 0, -1, 1),
 (0, -1, -1, 0),
 (0, 1, -1, 0),
 (-1, 0, 1, 0),
 (0, 0, -1, -1),
 (1, 1, 0, 0),
 (-1, -1, 0, 0),
 (-1, 1, 0, 0),
 (1, 0, 0, -1),
 (0, 1, 0, 1),
 (1, 0, -1, 0),
 (0, -1, 1, 0),
 (0, 0, 1, -1),
 (-1, 0, -1, 0),
 (1, 0, 1, 0),
 (1, 0, 0, 1),
 (0, -1, 0, -1),
 (0, 1, 0, -1),
 (1, -1, 0, 0)]
sage: d = {}
sage: for n in range(24):
....:    d[n] = tf[n]
....: 
sage: d[5]
[-1/2, -1/2, -1/2, -1/2]
sage: e={}
sage: e[0]=uf[0]
sage: 
Exiting Sage (CPU time 0m24.11s, Wall time 324m44.30s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-1-8b88f79f3474> in <module>()
----> 1 get_ipython().magic(u'attach /Users/bump/branch/graph.sage')

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2134         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2135         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2136         return self.run_line_magic(magic_name, magic_arg_s)
   2137 
   2138     #-------------------------------------------------------------------------

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2060                 args.append(sys._getframe(stack_depth).f_locals)
   2061             with self.builtin_trap:
-> 2062                 result = fn(*args)
   2063             return result
   2064 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    189     # but it's overkill for just that one bit of state.
    190     def magic_deco(arg):
--> 191         call = lambda f, *a, **k: f(*a, **k)
    192 
    193         if callable(arg):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)
    118         """
    119         from sage.misc.preparser import load_wrap
--> 120         return self.shell.ex(load_wrap(s, attach=True))
    121 
    122     @line_magic

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in ex(self, cmd)
   2382         """Execute a normal python statement in user namespace."""
   2383         with self.builtin_trap:
-> 2384             exec cmd in self.user_global_ns, self.user_ns
   2385 
   2386     def ev(self, expr):

<string> in <module>()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sageTEncBf.py in <module>()
     11 
     12 f = branching_rule("E6","F4","symmetric")._f
---> 13 tf = [f(v) for v in E6(_sage_const_1 ,_sage_const_0 ) if f(v) != [_sage_const_0 ,_sage_const_0 ,_sage_const_0 ,_sage_const_0 ]]
     14 uf = [u for u in C4(_sage_const_0 ,_sage_const_1 ,_sage_const_0 ,_sage_const_0 ) if u != C4.space().zero()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <lambda>(x)
   2590             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
   2591         elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
-> 2592             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
   2593         else:
   2594             raise ValueError("Rule not found")

IndexError: tuple index out of range
sage: tf
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-2-2192011bdc48> in <module>()
----> 1 tf

NameError: name 'tf' is not defined
sage: f = branching_rule("E6","F4","symmetric")._f
sage: tf = [f(v) for v in E6(1,0) if f(v) != [0,0,0,0]]
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-4-1b91fb64c0a1> in <module>()
----> 1 tf = [f(v) for v in E6(Integer(1),Integer(0)) if f(v) != [Integer(0),Integer(0),Integer(0),Integer(0)]]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <lambda>(x)
   2590             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
   2591         elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
-> 2592             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
   2593         else:
   2594             raise ValueError("Rule not found")

IndexError: tuple index out of range
sage: [v for v in E6(1,0)]
[((0, 0, 0, 0, 0, -2/3, -2/3, 2/3), 1)]
sage: [v for v in E6(1,0).weight_multiplicities()
....: .keys()]
[(1/2, -1/2, 1/2, 1/2, 1/2, -1/6, -1/6, 1/6),
 (0, 0, 1, 0, 0, 1/3, 1/3, -1/3),
 (0, -1, 0, 0, 0, 1/3, 1/3, -1/3),
 (-1/2, -1/2, 1/2, 1/2, -1/2, -1/6, -1/6, 1/6),
 (1/2, 1/2, 1/2, 1/2, -1/2, -1/6, -1/6, 1/6),
 (0, 0, 0, -1, 0, 1/3, 1/3, -1/3),
 (1/2, -1/2, 1/2, -1/2, -1/2, -1/6, -1/6, 1/6),
 (1/2, -1/2, -1/2, 1/2, -1/2, -1/6, -1/6, 1/6),
 (-1/2, 1/2, 1/2, 1/2, 1/2, -1/6, -1/6, 1/6),
 (0, 1, 0, 0, 0, 1/3, 1/3, -1/3),
 (1, 0, 0, 0, 0, 1/3, 1/3, -1/3),
 (-1/2, -1/2, -1/2, -1/2, -1/2, -1/6, -1/6, 1/6),
 (-1/2, 1/2, -1/2, -1/2, 1/2, -1/6, -1/6, 1/6),
 (1/2, 1/2, -1/2, -1/2, -1/2, -1/6, -1/6, 1/6),
 (0, 0, 0, 1, 0, 1/3, 1/3, -1/3),
 (-1/2, 1/2, 1/2, -1/2, -1/2, -1/6, -1/6, 1/6),
 (1/2, -1/2, -1/2, -1/2, 1/2, -1/6, -1/6, 1/6),
 (-1/2, -1/2, -1/2, 1/2, 1/2, -1/6, -1/6, 1/6),
 (1/2, 1/2, 1/2, -1/2, 1/2, -1/6, -1/6, 1/6),
 (0, 0, 0, 0, -1, 1/3, 1/3, -1/3),
 (-1/2, -1/2, 1/2, -1/2, 1/2, -1/6, -1/6, 1/6),
 (0, 0, 0, 0, 0, -2/3, -2/3, 2/3),
 (0, 0, -1, 0, 0, 1/3, 1/3, -1/3),
 (0, 0, 0, 0, 1, 1/3, 1/3, -1/3),
 (1/2, 1/2, -1/2, 1/2, 1/2, -1/6, -1/6, 1/6),
 (-1, 0, 0, 0, 0, 1/3, 1/3, -1/3),
 (-1/2, 1/2, -1/2, 1/2, -1/2, -1/6, -1/6, 1/6)]
sage: ### reloading attached file graph.sage modified at 03:09:45 ###
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-7-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sagex2dBwc.py in <module>()
     12 f = branching_rule("E6","F4","symmetric")._f
     13 tf = [f(v) for v in E6(_sage_const_1 ,_sage_const_0 ).weight_multiplicities().keys() if f(v) != [_sage_const_0 ,_sage_const_0 ,_sage_const_0 ,_sage_const_0 ]]
---> 14 uf = [u for u in C4(_sage_const_0 ,_sage_const_1 ,_sage_const_0 ,_sage_const_0 ).weight_multiplicities().keys() if u != C4.space().zero()]

NameError: name 'C4' is not defined
### reloading attached file graph.sage modified at 03:09:54 ###

sage: tf
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: len(tf)
24
sage: len(uf)
24
sage: ### reloading attached file graph.sage modified at 03:11:40 ###

sage: tneigh(tf[0])
[[-1/2, 1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0]]
sage: ### reloading attached file graph.sage modified at 03:12:18 ###
len(tneigh(tf
....: )
....: )
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-11-ff489370f86f> in <module>()
----> 1 len(tneigh(tf
      2 )
      3 )

/Users/bump/.sage/temp/meep2/12046/graph.sage5oWEDJ.py in tneigh(v)
     15 
     16 def tneigh(v):
---> 17     return set([vv for vv in tf if sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2 ])
     18 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sage5oWEDJ.py in <genexpr>((i,))
     15 
     16 def tneigh(v):
---> 17     return set([vv for vv in tf if sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2 ])
     18 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__mul__ (sage/structure/element.c:14533)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8169)()

TypeError: unsupported operand parent(s) for '*': '<type 'list'>' and 'Rational Field'
sage: tneigh(tf[0])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-12-30cba61ef1e5> in <module>()
----> 1 tneigh(tf[Integer(0)])

/Users/bump/.sage/temp/meep2/12046/graph.sage5oWEDJ.py in tneigh(v)
     15 
     16 def tneigh(v):
---> 17     return set([vv for vv in tf if sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2 ])
     18 

TypeError: unhashable type: 'list'
sage: ### reloading attached file graph.sage modified at 03:12:50 ###

sage: tneigh(tf[0])
[[-1/2, 1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [0, 0, 0, -1],
 [1/2, 1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0]]
sage: ### reloading attached file graph.sage modified at 03:14:36 ###
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-14-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sage8NH27u.py in <module>()
     24 
     25 ud = {}
---> 26 ud[_sage_const_0 ]
     27 

KeyError: 0

sage: une(ud[0])
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-14-6122f338742e> in <module>()
----> 1 une(ud[Integer(0)])

KeyError: 0
sage: ### reloading attached file graph.sage modified at 03:15:10 ###
une(ud[0])
[(-1, 0, 0, 1),
 (0, -1, 0, 1),
 (0, 1, 1, 0),
 (-1, 0, 1, 0),
 (0, 1, 0, 1),
 (0, -1, 1, 0),
 (1, 0, 1, 0),
 (1, 0, 0, 1)]
sage: ### reloading attached file graph.sage modified at 03:15:59 ###

sage: [v for v in tne(td[0]) if v in tne(td[1])]
[[0, 0, 1, 0], [0, 1, 0, 0], [0, 0, 0, -1]]
sage: [v for v in une(ud[0]) if v in une(ud[1])]
[(0, -1, 0, 1), (-1, 0, 1, 0), (0, 1, 0, 1)]
sage: ### reloading attached file graph.sage modified at 03:18:04 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-18-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sage_ACxS2.py in <module>()
     28 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     29 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 30 ud[_sage_const_2 ] = [u for u in tne(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_0 ]
     31 
     32 

IndexError: list index out of range
### reloading attached file graph.sage modified at 03:18:13 ###
ud[2]
(0, -1, 0, 1)
sage: ### reloading attached file graph.sage modified at 03:20:44 ###
  File "/Users/bump/.sage/temp/meep2/12046/graph.sageb8kyWs.py", line 34
    td = {}
       ^
SyntaxError: invalid syntax

### reloading attached file graph.sage modified at 03:21:21 ###

sage: tcom([td[0],td[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-19-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sagePenkKa.py in tcom(T)
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(v,vv) for vv in T)]
     33 
     34 

/Users/bump/.sage/temp/meep2/12046/graph.sagePenkKa.py in <genexpr>((vv,))
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(v,vv) for vv in T)]
     33 
     34 

/Users/bump/.sage/temp/meep2/12046/graph.sagePenkKa.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sagePenkKa.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: tad(td[0],td[1])
True
sage: all(tad(td[2],v) for v in [td[0],td[1]])
True
sage: ### reloading attached file graph.sage modified at 03:25:05 ###
tcom([td[0],td[1]])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-22-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sagedJ5D7u.py in tcom(T)
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(vv,v) for vvv in T)]
     33 
     34 td = {}

/Users/bump/.sage/temp/meep2/12046/graph.sagedJ5D7u.py in <genexpr>((vvv,))
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(vv,v) for vvv in T)]
     33 
     34 td = {}

NameError: global name 'vv' is not defined
sage: ### reloading attached file graph.sage modified at 03:30:08 ###
tcom([td[0],td[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-23-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sagegNtjgb.py in tcom(T)
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(vv,v) for vv in T)]
     33 
     34 td = {}

/Users/bump/.sage/temp/meep2/12046/graph.sagegNtjgb.py in <genexpr>((vv,))
     30     Common neighbors
     31     """
---> 32     [v for v in td if all(tad(vv,v) for vv in T)]
     33 
     34 td = {}

/Users/bump/.sage/temp/meep2/12046/graph.sagegNtjgb.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sagegNtjgb.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ### reloading attached file graph.sage modified at 03:31:10 ###
  File "/Users/bump/.sage/temp/meep2/12046/graph.sagey_bRVa.py", line 33
    for all v in td:
            ^
SyntaxError: invalid syntax

### reloading attached file graph.sage modified at 03:31:26 ###

sage: tcom([td[0],td[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-24-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sage2hk3QA.py in tcom(T)
     32     ret = []
     33     for v in td:
---> 34         if all(tad(v,vv) for vv in T):
     35             ret.appned(v)
     36     return ret

/Users/bump/.sage/temp/meep2/12046/graph.sage2hk3QA.py in <genexpr>((vv,))
     32     ret = []
     33     for v in td:
---> 34         if all(tad(v,vv) for vv in T):
     35             ret.appned(v)
     36     return ret

/Users/bump/.sage/temp/meep2/12046/graph.sage2hk3QA.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sage2hk3QA.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ### reloading attached file graph.sage modified at 03:32:02 ###

sage: T
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-25-8f898b22d33b> in <module>()
----> 1 T

NameError: name 'T' is not defined
sage: ### reloading attached file graph.sage modified at 03:32:50 ###
tcom([td[0],td[1]])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-26-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sageGRt4DI.py in tcom(T)
     32     ret = []
     33     for v in td:
---> 34         print [vv for v in T]
     35         print [tad(v,vv) for v in T]
     36         if all(tad(v,vv) for vv in T):

NameError: global name 'vv' is not defined
sage: ### reloading attached file graph.sage modified at 03:33:03 ###
tcom([td[0],td[1]])
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2]]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-27-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tcom(T)
     33     for v in td:
     34         print [vv for vv in T]
---> 35         for all vv in T:
     36         if all(tad(v,vv) for vv in T):
     37             ret.append(v)

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ---> 35         for all vv in T:
....: ### reloading attached file graph.sage modified at 03:40:51 ###
  File "<ipython-input-28-00cbc8a6684a>", line 1
    ---> Integer(35)         for all vv in T:
       ^
SyntaxError: invalid syntax

p
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-28-9d7bf0753729> in <module>()
----> 1 p

NameError: name 'p' is not defined
sage: tcom([td[0],td[1]])
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2]]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-29-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tcom(T)
     33     for v in td:
     34         print [vv for vv in T]
---> 35         print [tad(v,vv) for vv in T]
     36         if all(tad(v,vv) for vv in T):
     37             ret.append(v)

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ### reloading attached file graph.sage modified at 03:41:01 ###
  File "/Users/bump/.sage/temp/meep2/12046/graph.sage8XaKe7.py", line 34
    for all vv in T:
             ^
SyntaxError: invalid syntax

dirs
[]
sage: tcom([td[0],td[1]])
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2]]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-31-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tcom(T)
     33     for v in td:
     34         print [vv for vv in T]
---> 35         print [tad(v,vv) for vv in T]
     36         if all(tad(v,vv) for vv in T):
     37             ret.append(v)

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sageT1WcZX.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: %attach /Users/bump/branch/graph.sage
  File "/Users/bump/.sage/temp/meep2/12046/graph.sagemei3Ni.py", line 34
    for all vv in T:
             ^
SyntaxError: invalid syntax

sage: ### reloading attached file graph.sage modified at 03:41:53 ###
%attach /Users/bump/branch/graph.sage
sage: tcom([td[0],td[1]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-34-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sageUgWuRt.py in tcom(T)
     33     for v in td:
     34         for vv in T:
---> 35             print tad(v,vv)
     36     return ret
     37 

/Users/bump/.sage/temp/meep2/12046/graph.sageUgWuRt.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sageUgWuRt.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ### reloading attached file graph.sage modified at 03:42:39 ###
tcom([td[0],td[1]])
0 [1/2, 1/2, 1/2, -1/2]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-35-7ab58a5c73fd> in <module>()
----> 1 tcom([td[Integer(0)],td[Integer(1)]])

/Users/bump/.sage/temp/meep2/12046/graph.sage15dTOZ.py in tcom(T)
     34         for vv in T:
     35             print v, vv
---> 36             print tad(v,vv)
     37     return ret
     38 

/Users/bump/.sage/temp/meep2/12046/graph.sage15dTOZ.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sage15dTOZ.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: for v in td:
....:    for vv in td:
....:       print tad(v,vv)
....: 
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-36-91b910c5c94c> in <module>()
      1 for v in td:
      2        for vv in td:
----> 3               print tad(v,vv)
      4 

/Users/bump/.sage/temp/meep2/12046/graph.sage15dTOZ.py in tad(v, vv)
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sage15dTOZ.py in <genexpr>((i,))
     15 
     16 def tad(v,vv):
---> 17     return sum(v[i]*vv[i] for i in range(_sage_const_4 ))==_sage_const_1 /_sage_const_2
     18 
     19 def uad(u,uu):

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: ### reloading attached file graph.sage modified at 03:44:14 ###
tcom([td[0],td[1]])
[1/2, 1/2, 1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
False
[1/2, 1/2, 1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
True
[-1/2, 1/2, 1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
True
[-1/2, 1/2, 1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, 1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, 1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
True
[0, 0, 1, 0] [1/2, 1/2, 1/2, -1/2]
True
[0, 0, 1, 0] [-1/2, 1/2, 1/2, -1/2]
True
[0, 1, 0, 0] [1/2, 1/2, 1/2, -1/2]
True
[0, 1, 0, 0] [-1/2, 1/2, 1/2, -1/2]
True
[-1/2, -1/2, -1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, -1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
False
[0, 0, 0, -1] [1/2, 1/2, 1/2, -1/2]
True
[0, 0, 0, -1] [-1/2, 1/2, 1/2, -1/2]
True
[1/2, 1/2, 1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
True
[1/2, 1/2, 1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, -1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, -1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, -1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, -1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
True
[0, -1, 0, 0] [1/2, 1/2, 1/2, -1/2]
False
[0, -1, 0, 0] [-1/2, 1/2, 1/2, -1/2]
False
[1/2, -1/2, -1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[1/2, -1/2, -1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[0, 0, -1, 0] [1/2, 1/2, 1/2, -1/2]
False
[0, 0, -1, 0] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, 1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, 1/2, 1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
True
[1/2, -1/2, -1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
False
[1/2, -1/2, -1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
False
[1/2, -1/2, 1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[1/2, -1/2, 1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[1/2, 1/2, -1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
True
[1/2, 1/2, -1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
False
[-1, 0, 0, 0] [1/2, 1/2, 1/2, -1/2]
False
[-1, 0, 0, 0] [-1/2, 1/2, 1/2, -1/2]
True
[1/2, -1/2, 1/2, -1/2] [1/2, 1/2, 1/2, -1/2]
True
[1/2, -1/2, 1/2, -1/2] [-1/2, 1/2, 1/2, -1/2]
False
[1, 0, 0, 0] [1/2, 1/2, 1/2, -1/2]
True
[1, 0, 0, 0] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, -1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, -1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[1/2, 1/2, -1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[1/2, 1/2, -1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, 1/2, 1/2] [1/2, 1/2, 1/2, -1/2]
False
[-1/2, -1/2, 1/2, 1/2] [-1/2, 1/2, 1/2, -1/2]
False
[0, 0, 0, 1] [1/2, 1/2, 1/2, -1/2]
False
[0, 0, 0, 1] [-1/2, 1/2, 1/2, -1/2]
False
[]
sage: ### reloading attached file graph.sage modified at 03:44:47 ###
tcom([td[0],td[1]])
[[0, 0, 1, 0], [0, 1, 0, 0], [0, 0, 0, -1]]
sage: tcom([td[0],td[1],td[2]])
[]
sage: ### reloading attached file graph.sage modified at 03:50:05 ###
  File "/Users/bump/.sage/temp/meep2/12046/graph.sage4fZ9kc.py", line 49
    td = {}
           ^
IndentationError: expected an indented block

### reloading attached file graph.sage modified at 03:53:29 ###

sage: 
sage: td
{0: [1/2, 1/2, 1/2, -1/2], 1: [-1/2, 1/2, 1/2, -1/2], 2: [0, 0, 1, 0]}
sage: td.keys()
[0, 1, 2]
sage: tne(td[2])
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, 1/2, 1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, -1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, 1/2]]
sage: tne(td[2])[3]
[1/2, 1/2, 1/2, 1/2]
sage: t=tne(td[2])[3]
sage: td.keys()
[0, 1, 2]
sage: td.values()
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: T = td[i] for i in [0,1,2]; T
  File "<ipython-input-48-b63935b24ead>", line 1
    T = td[i] for i in [Integer(0),Integer(1),Integer(2)]; T
                ^
SyntaxError: invalid syntax

sage: T = [td[i] for i in [0,1,2]]; T
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: U = [ud[i] for i in [0,1,2]]; U
[(0, 0, 1, 1), (-1, 0, 0, 1), (0, -1, 0, 1)]
sage: cong(t,T,U)
[]
sage: ### reloading attached file graph.sage modified at 03:57:38 ###

sage: U = [ud[i] for i in [0,1,2]]; U
[(0, 0, 1, 1), (-1, 0, 0, 1), (-1, 0, 1, 0)]
sage: cong(t,T,U)
[]
sage: ### reloading attached file graph.sage modified at 03:58:07 ###

sage: T
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: U
[(0, 0, 1, 1), (-1, 0, 0, 1), (-1, 0, 1, 0)]
sage: t
[1/2, 1/2, 1/2, 1/2]
sage: cong(t,T,U)
[]
sage: ### reloading attached file graph.sage modified at 03:58:32 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-58-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sagehM9qX5.py in <module>()
     62 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     63 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 64 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     65 
     66 

IndexError: list index out of range

sage :
....: T
....: 
  File "<ipython-input-58-7573c88ee670>", line 1
    :
    ^
SyntaxError: invalid syntax

sage: T
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: U
[(0, 0, 1, 1), (-1, 0, 0, 1), (-1, 0, 1, 0)]
sage: ### reloading attached file graph.sage modified at 04:03:50 ###
  File "/Users/bump/.sage/temp/meep2/12046/graph.sagezJ2fUt.py", line 52
    for i in range(N)):
                     ^
SyntaxError: invalid syntax

### reloading attached file graph.sage modified at 04:03:59 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-61-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sageQ6oLDX.py in <module>()
     62 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     63 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 64 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     65 
     66 

IndexError: list index out of range

sage: cong(t,T,U)
(0, 0, 1, 1) (4, 10*sqrt(1/2))
(0, 0, 1, 1)---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-61-f2f22bb998b2> in <module>()
----> 1 cong(t,T,U)

/Users/bump/.sage/temp/meep2/12046/graph.sageQ6oLDX.py in cong(v, T, U)
     51     for u in U:
     52         for i in range(N):
---> 53             print u, (uip(u,U[i]), tip(v,T[i]))
     54         print
     55 

/Users/bump/.sage/temp/meep2/12046/graph.sageQ6oLDX.py in uip(v, vv)
     18 
     19 def uip(v,vv):
---> 20     return sum(v[i]**vv[i] for i in range(_sage_const_4 ))
     21 
     22 def tad(v,vv):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sageQ6oLDX.py in <genexpr>((i,))
     18 
     19 def uip(v,vv):
---> 20     return sum(v[i]**vv[i] for i in range(_sage_const_4 ))
     21 
     22 def tad(v,vv):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/rational.so in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:19225)()

RuntimeError: Floating point exception
sage: ### reloading attached file graph.sage modified at 04:05:25 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-62-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sagenSoiwa.py in <module>()
     63 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     64 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 65 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     66 
     67 

IndexError: list index out of range

sage: cong(t,T,U)
(0, 0, 1, 1)
4 10*sqrt(1/2)
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-62-f2f22bb998b2> in <module>()
----> 1 cong(t,T,U)

/Users/bump/.sage/temp/meep2/12046/graph.sagenSoiwa.py in cong(v, T, U)
     52         print u
     53         for i in range(N):
---> 54             print uip(u,U[i]), tip(v,T[i])
     55         print
     56 

/Users/bump/.sage/temp/meep2/12046/graph.sagenSoiwa.py in uip(v, vv)
     18 
     19 def uip(v,vv):
---> 20     return sum(v[i]**vv[i] for i in range(_sage_const_4 ))
     21 
     22 def tad(v,vv):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/functional.pyc in symbolic_sum(expression, *args, **kwds)
    654         return expression.sum(*args, **kwds)
    655     elif len(args) <= 1:
--> 656         return sum(expression, *args)
    657     else:
    658         from sage.symbolic.ring import SR

/Users/bump/.sage/temp/meep2/12046/graph.sagenSoiwa.py in <genexpr>((i,))
     18 
     19 def uip(v,vv):
---> 20     return sum(v[i]**vv[i] for i in range(_sage_const_4 ))
     21 
     22 def tad(v,vv):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/rational.so in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:19225)()

RuntimeError: Floating point exception
sage: ### reloading attached file graph.sage modified at 04:06:08 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-63-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sagefjXJYC.py in <module>()
     63 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     64 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 65 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     66 
     67 

IndexError: list index out of range

sage: cong(t,T,U)
(0, 0, 1, 1)
2 1
1 0
1 1

(-1, 0, 0, 1)
1 1
2 0
1 1

(-1, 0, 1, 0)
1 1
1 0
2 1

sage: ### reloading attached file graph.sage modified at 04:07:01 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-64-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sageyWje96.py in <module>()
     62 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     63 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 64 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     65 
     66 

IndexError: list index out of range

sage: cong(t,T,U)
[]
sage: 
sage: t
[1/2, 1/2, 1/2, 1/2]
sage: T
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: U
[(0, 0, 1, 1), (-1, 0, 0, 1), (-1, 0, 1, 0)]
sage: ### reloading attached file graph.sage modified at 04:07:45 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-68-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sage6FTW4P.py in <module>()
     63 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     64 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 65 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     66 
     67 

IndexError: list index out of range

sage: T
[[1/2, 1/2, 1/2, -1/2], [-1/2, 1/2, 1/2, -1/2], [0, 0, 1, 0]]
sage: U
[(0, 0, 1, 1), (-1, 0, 0, 1), (-1, 0, 1, 0)]
sage: v
[1, 0, 0, 0]
sage: cong(v,T,U)
(0, 0, 1, 1)
2 1
1 -1
1 0
(-1, 0, 0, 1)
1 1
2 -1
1 0
(-1, 0, 1, 0)
1 1
1 -1
2 0
[]
sage: ### reloading attached file graph.sage modified at 04:08:28 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-72-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12046/graph.sagedSAM9r.py in <module>()
     63 ud[_sage_const_0 ] = uf[_sage_const_0 ]
     64 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
---> 65 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_3 ]
     66 
     67 

IndexError: list index out of range

sage: cong(v,T,U)
(0, 0, 1, 1)
2 1
1 -1
1 0
(-1, 0, 0, 1)
1 1
2 -1
1 0
(0, -1, 0, 1)
1 1
1 -1
0 0
(-1, 0, 0, -1)
-1 1
0 -1
1 0
(0, 1, 1, 0)
1 1
0 -1
1 0
(0, 0, -1, 1)
0 1
1 -1
-1 0
(0, -1, -1, 0)
-1 1
0 -1
-1 0
(0, 1, -1, 0)
-1 1
0 -1
-1 0
(-1, 0, 1, 0)
1 1
1 -1
2 0
(0, 0, -1, -1)
-2 1
-1 -1
-1 0
(1, 1, 0, 0)
0 1
-1 -1
-1 0
(-1, -1, 0, 0)
0 1
1 -1
1 0
(-1, 1, 0, 0)
0 1
1 -1
1 0
(1, 0, 0, -1)
-1 1
-2 -1
-1 0
(0, 1, 0, 1)
1 1
1 -1
0 0
(1, 0, -1, 0)
-1 1
-1 -1
-2 0
(0, -1, 1, 0)
1 1
0 -1
1 0
(0, 0, 1, -1)
0 1
-1 -1
1 0
(-1, 0, -1, 0)
-1 1
1 -1
0 0
(1, 0, 1, 0)
1 1
-1 -1
0 0
(1, 0, 0, 1)
1 1
0 -1
-1 0
(0, -1, 0, -1)
-1 1
-1 -1
0 0
(0, 1, 0, -1)
-1 1
-1 -1
0 0
(1, -1, 0, 0)
0 1
-1 -1
-1 0
[]
sage: ### reloading attached file graph.sage modified at 04:09:21 ###

sage: dirs
[]
sage: cong(v,T,U)
(0, 0, 1, 1)
2 1
1 -1
1 0
(-1, 0, 0, 1)
1 1
2 -1
1 0
(0, -1, 0, 1)
1 1
1 -1
0 0
(-1, 0, 0, -1)
-1 1
0 -1
1 0
(0, 1, 1, 0)
1 1
0 -1
1 0
(0, 0, -1, 1)
0 1
1 -1
-1 0
(0, -1, -1, 0)
-1 1
0 -1
-1 0
(0, 1, -1, 0)
-1 1
0 -1
-1 0
(-1, 0, 1, 0)
1 1
1 -1
2 0
(0, 0, -1, -1)
-2 1
-1 -1
-1 0
(1, 1, 0, 0)
0 1
-1 -1
-1 0
(-1, -1, 0, 0)
0 1
1 -1
1 0
(-1, 1, 0, 0)
0 1
1 -1
1 0
(1, 0, 0, -1)
-1 1
-2 -1
-1 0
(0, 1, 0, 1)
1 1
1 -1
0 0
(1, 0, -1, 0)
-1 1
-1 -1
-2 0
(0, -1, 1, 0)
1 1
0 -1
1 0
(0, 0, 1, -1)
0 1
-1 -1
1 0
(-1, 0, -1, 0)
-1 1
1 -1
0 0
(1, 0, 1, 0)
1 1
-1 -1
0 0
(1, 0, 0, 1)
1 1
0 -1
-1 0
(0, -1, 0, -1)
-1 1
-1 -1
0 0
(0, 1, 0, -1)
-1 1
-1 -1
0 0
(1, -1, 0, 0)
0 1
-1 -1
-1 0
[]
sage: ### reloading attached file graph.sage modified at 04:10:27 ###

sage: cong(v,T,U)
[(1, 0, 1, 0)]
sage: ### reloading attached file graph.sage modified at 04:12:53 ###

sage: 
Exiting Sage (CPU time 0m8.83s, Wall time 65m48.59s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/graph.sage
sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [[-1/2, -1/2, 1/2, -1/2],
  [0, 1, 0, 0],
  [-1/2, -1/2, -1/2, -1/2],
  [0, 0, 0, -1],
  [1/2, 1/2, 1/2, 1/2],
  [-1/2, 1/2, -1/2, 1/2],
  [-1/2, 1/2, -1/2, -1/2],
  [0, -1, 0, 0],
  [1/2, -1/2, -1/2, 1/2],
  [0, 0, -1, 0],
  [-1/2, 1/2, 1/2, 1/2],
  [1/2, -1/2, -1/2, -1/2],
  [1/2, -1/2, 1/2, 1/2],
  [1/2, 1/2, -1/2, -1/2],
  [-1, 0, 0, 0],
  [1/2, -1/2, 1/2, -1/2],
  [1, 0, 0, 0],
  [-1/2, -1/2, -1/2, 1/2],
  [1/2, 1/2, -1/2, 1/2],
  [-1/2, -1/2, 1/2, 1/2],
  [0, 0, 0, 1]]}
sage: ### reloading attached file graph.sage modified at 04:13:23 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2]}
sage: cong(td[3],[td[i] for i in range(3)], [ud[i] for i in range(3)])
[(0, 0, -1, 1), (-1, -1, 0, 0)]
sage: ### reloading attached file graph.sage modified at 04:14:52 ###
cong(td[3],[td[i] for i in range(3)], [ud[i] for i in range(3)])
[(-1, 0, 1, 0), (0, 1, 0, 1)]
sage: ### reloading attached file graph.sage modified at 04:23:23 ###
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-6-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sageucxP9d.py in <module>()
     75 ud[_sage_const_1 ] = une(ud[_sage_const_0 ])[_sage_const_0 ]
     76 ud[_sage_const_2 ] = [u for u in une(ud[_sage_const_0 ]) if u in une(ud[_sage_const_1 ])][_sage_const_2 ]
---> 77 ud[_sage_const_3 ] = unew(td[_sage_const_3 ])
     78 
     79 

/Users/bump/.sage/temp/meep2/12112/graph.sageucxP9d.py in unew(v)
     63 def unew(v):
     64     K = ud.keys()
---> 65     return cong(v,[T[i] for i in K],[U[i] for i in K])[_sage_const_0 ]
     66 
     67 td = {}

NameError: global name 'T' is not defined

sage: ### reloading attached file graph.sage modified at 04:23:39 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2]}
sage: ud
{0: (0, 0, 1, 1), 1: (-1, 0, 0, 1), 2: (0, 1, 0, 1), 3: (0, 0, -1, 1)}
sage: ### reloading attached file graph.sage modified at 04:25:22 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0)}
sage: ### reloading attached file graph.sage modified at 04:26:28 ###
td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0)}
sage: ### reloading attached file graph.sage modified at 04:27:25 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0)}
sage: ### reloading attached file graph.sage modified at 04:28:38 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0),
 8: (-1, 0, 0, -1),
 9: (-1, -1, 0, 0),
 10: (1, 0, -1, 0),
 11: (1, 0, 0, -1)}
sage: ### reloading attached file graph.sage modified at 04:29:23 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2],
 12: [0, 0, -1, 0],
 13: [-1/2, 1/2, 1/2, 1/2],
 14: [1/2, -1/2, -1/2, -1/2]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0),
 8: (-1, 0, 0, -1),
 9: (-1, -1, 0, 0),
 10: (1, 0, -1, 0),
 11: (1, 0, 0, -1),
 12: (0, -1, 0, -1),
 13: (-1, 1, 0, 0),
 14: (1, -1, 0, 0)}
sage: ### reloading attached file graph.sage modified at 04:30:24 ###

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2],
 12: [0, 0, -1, 0],
 13: [-1/2, 1/2, 1/2, 1/2],
 14: [1/2, -1/2, -1/2, -1/2],
 15: [1/2, -1/2, 1/2, 1/2],
 16: [1/2, 1/2, -1/2, -1/2],
 17: [-1, 0, 0, 0],
 18: [1/2, -1/2, 1/2, -1/2],
 19: [1, 0, 0, 0]}
sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2],
 12: [0, 0, -1, 0],
 13: [-1/2, 1/2, 1/2, 1/2],
 14: [1/2, -1/2, -1/2, -1/2],
 15: [1/2, -1/2, 1/2, 1/2],
 16: [1/2, 1/2, -1/2, -1/2],
 17: [-1, 0, 0, 0],
 18: [1/2, -1/2, 1/2, -1/2],
 19: [1, 0, 0, 0]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0),
 8: (-1, 0, 0, -1),
 9: (-1, -1, 0, 0),
 10: (1, 0, -1, 0),
 11: (1, 0, 0, -1),
 12: (0, -1, 0, -1),
 13: (-1, 1, 0, 0),
 14: (1, -1, 0, 0),
 15: (1, 1, 0, 0),
 16: (0, -1, 1, 0),
 17: (-1, 0, -1, 0),
 18: (1, 0, 0, 1),
 19: (1, 0, 1, 0)}
sage: ### reloading attached file graph.sage modified at 04:32:18 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-21-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sage1aIHPK.py in <module>()
    137 ud[_sage_const_23 ] = unew(td[_sage_const_23 ])
    138 
--> 139 td[_sage_const_24 ] = tnew()
    140 ud[_sage_const_24 ] = unew(td[_sage_const_24 ])

/Users/bump/.sage/temp/meep2/12112/graph.sage1aIHPK.py in tnew()
     59 
     60 def tnew():
---> 61     return [v for v in tf if v not in td.values()][_sage_const_0 ]
     62 
     63 def unew(v):

IndexError: list index out of range

sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2],
 12: [0, 0, -1, 0],
 13: [-1/2, 1/2, 1/2, 1/2],
 14: [1/2, -1/2, -1/2, -1/2],
 15: [1/2, -1/2, 1/2, 1/2],
 16: [1/2, 1/2, -1/2, -1/2],
 17: [-1, 0, 0, 0],
 18: [1/2, -1/2, 1/2, -1/2],
 19: [1, 0, 0, 0],
 20: [-1/2, -1/2, -1/2, 1/2],
 21: [1/2, 1/2, -1/2, 1/2],
 22: [-1/2, -1/2, 1/2, 1/2],
 23: [0, 0, 0, 1]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0),
 8: (-1, 0, 0, -1),
 9: (-1, -1, 0, 0),
 10: (1, 0, -1, 0),
 11: (1, 0, 0, -1),
 12: (0, -1, 0, -1),
 13: (-1, 1, 0, 0),
 14: (1, -1, 0, 0),
 15: (1, 1, 0, 0),
 16: (0, -1, 1, 0),
 17: (-1, 0, -1, 0),
 18: (1, 0, 0, 1),
 19: (1, 0, 1, 0),
 20: (0, 0, -1, -1),
 21: (0, 0, 1, -1),
 22: (0, 1, -1, 0),
 23: (0, 1, 0, -1)}
sage: [td[10], td[4], td[2], td[23]]
[[0, -1, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]
sage: [td[19], td[4], td[2], td[23]]
[[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]
sage: [ud[19], ud[4], ud[2], ud[23]]
[(1, 0, 1, 0), (-1, 0, 1, 0), (0, 1, 0, 1), (0, 1, 0, -1)]
sage: ### reloading attached file graph.sage modified at 04:36:00 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-26-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sagezluXVF.py in <module>()
    143 ud[_sage_const_23 ] = unew(td[_sage_const_23 ])
    144 
--> 145 td[_sage_const_24 ] = tnew()
    146 ud[_sage_const_24 ] = unew(td[_sage_const_24 ])

/Users/bump/.sage/temp/meep2/12112/graph.sagezluXVF.py in tnew()
     65 
     66 def tnew():
---> 67     return [v for v in tf if v not in td.values()][_sage_const_0 ]
     68 
     69 def unew(v):

IndexError: list index out of range
### reloading attached file graph.sage modified at 04:36:27 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-26-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sageoSfxeJ.py in <module>()
    143 ud[_sage_const_23 ] = unew(td[_sage_const_23 ])
    144 
--> 145 td[_sage_const_24 ] = tnew()
    146 ud[_sage_const_24 ] = unew(td[_sage_const_24 ])

/Users/bump/.sage/temp/meep2/12112/graph.sageoSfxeJ.py in tnew()
     65 
     66 def tnew():
---> 67     return [v for v in tf if v not in td.values()][_sage_const_0 ]
     68 
     69 def unew(v):

IndexError: list index out of range
### reloading attached file graph.sage modified at 04:38:51 ###
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-26-2939926013e0> in <module>()
----> 1 sage.misc.preparser.load(sage.misc.preparser.base64.b64decode("L1VzZXJzL2J1bXAvYnJhbmNoL2dyYXBoLnNhZ2U="),globals(),True)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sageLEkrzS.py in <module>()
    144 ud[_sage_const_23 ] = unew(td[_sage_const_23 ])
    145 
--> 146 td[_sage_const_24 ] = tnew()
    147 ud[_sage_const_24 ] = unew(td[_sage_const_24 ])

/Users/bump/.sage/temp/meep2/12112/graph.sageLEkrzS.py in tnew()
     66 
     67 def tnew():
---> 68     return [v for v in tf if v not in td.values()][_sage_const_0 ]
     69 
     70 def unew(v):

IndexError: list index out of range

sage: %attach /Users/bump/branch/graph.sage
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-26-8b88f79f3474> in <module>()
----> 1 get_ipython().magic(u'attach /Users/bump/branch/graph.sage')

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2134         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2135         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2136         return self.run_line_magic(magic_name, magic_arg_s)
   2137 
   2138     #-------------------------------------------------------------------------

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2060                 args.append(sys._getframe(stack_depth).f_locals)
   2061             with self.builtin_trap:
-> 2062                 result = fn(*args)
   2063             return result
   2064 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    189     # but it's overkill for just that one bit of state.
    190     def magic_deco(arg):
--> 191         call = lambda f, *a, **k: f(*a, **k)
    192 
    193         if callable(arg):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)
    118         """
    119         from sage.misc.preparser import load_wrap
--> 120         return self.shell.ex(load_wrap(s, attach=True))
    121 
    122     @line_magic

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in ex(self, cmd)
   2382         """Execute a normal python statement in user namespace."""
   2383         with self.builtin_trap:
-> 2384             exec cmd in self.user_global_ns, self.user_ns
   2385 
   2386     def ev(self, expr):

<string> in <module>()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/12112/graph.sage9mIMpm.py in <module>()
    144 ud[_sage_const_23 ] = unew(td[_sage_const_23 ])
    145 
--> 146 td[_sage_const_24 ] = tnew()
    147 ud[_sage_const_24 ] = unew(td[_sage_const_24 ])

/Users/bump/.sage/temp/meep2/12112/graph.sage9mIMpm.py in tnew()
     66 
     67 def tnew():
---> 68     return [v for v in tf if v not in td.values()][_sage_const_0 ]
     69 
     70 def unew(v):

IndexError: list index out of range
sage: td
{0: [1/2, 1/2, 1/2, -1/2],
 1: [-1/2, 1/2, 1/2, -1/2],
 2: [0, 0, 1, 0],
 3: [-1/2, -1/2, 1/2, -1/2],
 4: [0, 1, 0, 0],
 5: [-1/2, -1/2, -1/2, -1/2],
 6: [0, 0, 0, -1],
 7: [1/2, 1/2, 1/2, 1/2],
 8: [-1/2, 1/2, -1/2, 1/2],
 9: [-1/2, 1/2, -1/2, -1/2],
 10: [0, -1, 0, 0],
 11: [1/2, -1/2, -1/2, 1/2],
 12: [0, 0, -1, 0],
 13: [-1/2, 1/2, 1/2, 1/2],
 14: [1/2, -1/2, -1/2, -1/2],
 15: [1/2, -1/2, 1/2, 1/2],
 16: [1/2, 1/2, -1/2, -1/2],
 17: [-1, 0, 0, 0],
 18: [1/2, -1/2, 1/2, -1/2],
 19: [1, 0, 0, 0],
 20: [-1/2, -1/2, -1/2, 1/2],
 21: [1/2, 1/2, -1/2, 1/2],
 22: [-1/2, -1/2, 1/2, 1/2],
 23: [0, 0, 0, 1]}
sage: ud
{0: (0, 0, 1, 1),
 1: (-1, 0, 0, 1),
 2: (0, 1, 0, 1),
 3: (0, 0, -1, 1),
 4: (-1, 0, 1, 0),
 5: (0, -1, -1, 0),
 6: (0, -1, 0, 1),
 7: (0, 1, 1, 0),
 8: (-1, 0, 0, -1),
 9: (-1, -1, 0, 0),
 10: (1, 0, -1, 0),
 11: (1, 0, 0, -1),
 12: (0, -1, 0, -1),
 13: (-1, 1, 0, 0),
 14: (1, -1, 0, 0),
 15: (1, 1, 0, 0),
 16: (0, -1, 1, 0),
 17: (-1, 0, -1, 0),
 18: (1, 0, 0, 1),
 19: (1, 0, 1, 0),
 20: (0, 0, -1, -1),
 21: (0, 0, 1, -1),
 22: (0, 1, -1, 0),
 23: (0, 1, 0, -1)}
sage: ### reloading attached file graph.sage modified at 05:28:40 ###

sage: f1
<function __main__.f1>
sage: [f1(f(v)) for v in E6(1,0).weight_multiplicities().values()]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-30-360fe8ef0fa7> in <module>()
----> 1 [f1(f(v)) for v in E6(Integer(1),Integer(0)).weight_multiplicities().values()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <lambda>(x)
   2590             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
   2591         elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
-> 2592             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
   2593         else:
   2594             raise ValueError("Rule not found")

TypeError: 'sage.rings.integer.Integer' object has no attribute '__getitem__'
sage: [f1(f(v)) for v in E6(1,0).weight_multiplicities().keys()]
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-31-75f6a7127fb2> in <module>()
----> 1 [f1(f(v)) for v in E6(Integer(1),Integer(0)).weight_multiplicities().keys()]

/Users/bump/.sage/temp/meep2/12112/graph.sageUQtkvI.py in f1(v)
     13 
     14 def f1(v):
---> 15     x = f(v)
     16     return [x[_sage_const_0 ]-x[_sage_const_1 ],x[_sage_const_2 ]+x[_sage_const_3 ],x[_sage_const_0 ]+x[_sage_const_1 ],x[_sage_const_2 ]-x[_sage_const_3 ]]
     17 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <lambda>(x)
   2590             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
   2591         elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
-> 2592             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
   2593         else:
   2594             raise ValueError("Rule not found")

IndexError: list index out of range
sage: [f(v) for v in E6(1,0).weight_multiplicities().keys()]
[[1/2, 1/2, 1/2, -1/2],
 [-1/2, 1/2, 1/2, -1/2],
 [-1/2, -1/2, 1/2, -1/2],
 [0, 0, 1, 0],
 [0, 1, 0, 0],
 [-1/2, -1/2, -1/2, -1/2],
 [0, 0, 0, -1],
 [0, 0, 0, 0],
 [1/2, 1/2, 1/2, 1/2],
 [-1/2, 1/2, -1/2, 1/2],
 [-1/2, 1/2, -1/2, -1/2],
 [0, -1, 0, 0],
 [1/2, -1/2, -1/2, 1/2],
 [0, 0, -1, 0],
 [-1/2, 1/2, 1/2, 1/2],
 [0, 0, 0, 0],
 [1/2, -1/2, -1/2, -1/2],
 [1/2, -1/2, 1/2, 1/2],
 [1/2, 1/2, -1/2, -1/2],
 [-1, 0, 0, 0],
 [1/2, -1/2, 1/2, -1/2],
 [1, 0, 0, 0],
 [-1/2, -1/2, -1/2, 1/2],
 [0, 0, 0, 0],
 [1/2, 1/2, -1/2, 1/2],
 [-1/2, -1/2, 1/2, 1/2],
 [0, 0, 0, 1]]
sage: [f1(f(v)) for v in E6(1,0).weight_multiplicities().keys()]
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-33-75f6a7127fb2> in <module>()
----> 1 [f1(f(v)) for v in E6(Integer(1),Integer(0)).weight_multiplicities().keys()]

/Users/bump/.sage/temp/meep2/12112/graph.sageUQtkvI.py in f1(v)
     13 
     14 def f1(v):
---> 15     x = f(v)
     16     return [x[_sage_const_0 ]-x[_sage_const_1 ],x[_sage_const_2 ]+x[_sage_const_3 ],x[_sage_const_0 ]+x[_sage_const_1 ],x[_sage_const_2 ]-x[_sage_const_3 ]]
     17 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <lambda>(x)
   2590             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
   2591         elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
-> 2592             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
   2593         else:
   2594             raise ValueError("Rule not found")

IndexError: list index out of range
sage: ### reloading attached file graph.sage modified at 05:32:15 ###
[f1(f(v)) for v in E6(1,0).weight_multiplicities().keys()]
[[0, 0, 1, 1],
 [-1, 0, 0, 1],
 [0, 0, -1, 1],
 [0, 1, 0, 1],
 [-1, 0, 1, 0],
 [0, -1, -1, 0],
 [0, -1, 0, 1],
 [0, 0, 0, 0],
 [0, 1, 1, 0],
 [-1, 0, 0, -1],
 [-1, -1, 0, 0],
 [1, 0, -1, 0],
 [1, 0, 0, -1],
 [0, -1, 0, -1],
 [-1, 1, 0, 0],
 [0, 0, 0, 0],
 [1, -1, 0, 0],
 [1, 1, 0, 0],
 [0, -1, 1, 0],
 [-1, 0, -1, 0],
 [1, 0, 0, 1],
 [1, 0, 1, 0],
 [0, 0, -1, -1],
 [0, 0, 0, 0],
 [0, 0, 1, -1],
 [0, 1, -1, 0],
 [0, 1, 0, -1]]
sage: for r in E6.simple_roots(): print r
(1/2, -1/2, -1/2, -1/2, -1/2, -1/2, -1/2, 1/2)
(1, 1, 0, 0, 0, 0, 0, 0)
(-1, 1, 0, 0, 0, 0, 0, 0)
(0, -1, 1, 0, 0, 0, 0, 0)
(0, 0, -1, 1, 0, 0, 0, 0)
(0, 0, 0, -1, 1, 0, 0, 0)
sage: f1(f([X0,X1,X2,X3,X4,X5,X5,-X5]))
sage: 
Exiting Sage (CPU time 0m9.54s, Wall time 81m33.14s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: ### reloading attached file e6.sage modified at 05:35:25 ###

sage: b
exper branching rule E6 => C4
sage: b.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

1 => 1
4 => 4
6 => 1

For more detailed information use verbose=True
sage: b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

0 => root (0, 0, -2, 0)
1 => 1
2 => weight (-1, -1, 1, -1)
3 => root (0, 1, 0, -1)
4 => 4
5 => root (0, 1, 0, -1)
6 => 1

fundamental weight restrictions E6 => C4:
1 => (1, -1, 1, 0)
2 => (0, -2, 2, 0)
3 => (0, -1, 2, 0)
4 => (0, -2, 2, 1)
5 => (0, -1, 2, 0)
6 => (1, -1, 1, 0)
sage: ### reloading attached file e6.sage modified at 05:37:01 ###

sage: b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

0 => root (0, -2, 0, 0)
1 => root (1, 0, -1, 0)
2 => weight (-1, 1, -1, -1)
3 => 3
4 => 4
5 => 3
6 => root (1, 0, -1, 0)

fundamental weight restrictions E6 => C4:
1 => (0, 1, 0, 0)
2 => (-2, 2, 0, 0)
3 => (-1, 1, 1, 0)
4 => (-2, 2, 0, 1)
5 => (-1, 1, 1, 0)
6 => (0, 1, 0, 0)
sage: ### reloading attached file e6.sage modified at 05:37:31 ###
b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

0 => root (-2, 0, 0, 0)
1 => 2
2 => weight (1, -1, -1, -1)
3 => 3
4 => 4
5 => 3
6 => 2

fundamental weight restrictions E6 => C4:
1 => (0, 1, 0, 0)
2 => (2, 0, 0, 0)
3 => (1, 0, 1, 0)
4 => (2, 0, 0, 1)
5 => (1, 0, 1, 0)
6 => (0, 1, 0, 0)
sage: E6(1,0).branch(C4,b)
C4(0,1,0,0)
sage :
C4(0,1,0,0)
sage: [E6(f).degree() for f in E6.fundamental_weights()]
[27, 78, 351, 2925, 351, 27]
sage: E6(0,1,0,0,0,0).branch(C4,b)
C4(0,0,0,1) + C4(2,0,0,0)
sage: E6(0,0,1,0,0,0).branch(C4,b)
C4(2,0,0,0) + C4(1,0,1,0)
sage: ### reloading attached file e6.sage modified at 05:45:40 ###
### reloading attached file e6.sage modified at 05:45:54 ###

sage: E6(0,0,1,0,0,0).branch(C4,b)
  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-12-677a3ac61eb2> in <module>()
----> 1 E6(Integer(0),Integer(0),Integer(1),Integer(0),Integer(0),Integer(0)).branch(C4,b)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    920         ddict = mdict.copy()
    921         while len(ddict) != 0:
--> 922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
    924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in <genexpr>((x,))
    920         ddict = mdict.copy()
    921         while len(ddict) != 0:
--> 922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
    924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in inner_product(self, lambdacheck)
    379             if t not in self_mc:
    380                 continue
--> 381             result += c*self_mc[t]
    382         return result
    383 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: ### reloading attached file e6.sage modified at 05:47:23 ###

sage: f([1,2,3,4,5,6,6,-6])
[-3/2, -23/2, 3, 1]
sage: f1([1,2,3,4,5,6,6,-6])
[-2, -23/2, 3, 1]
sage: E6(0,0,1,0,0,0).branch(C4,b)

  C-c C-c---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-15-677a3ac61eb2> in <module>()
----> 1 E6(Integer(0),Integer(0),Integer(1),Integer(0),Integer(0),Integer(0)).branch(C4,b)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2233         else:
   2234             mdict[h] = chi_mdict[k]
-> 2235     return S.char_from_weights(mdict)
   2236 
   2237 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    934                         del ddict[k]
    935                     else:
--> 936                         ddict[k] = ddict[k]-c*sdict[k]
    937                 else:
    938                     ddict[k] = -c*sdict[k]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __hash__(self)
    346             549810038                     # 32-bit
    347         """
--> 348         return hash(tuple(sorted([(m,c) for m,c in self._monomial_coefficients.iteritems()])))
    349 
    350     # For backward compatibility

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:925)()

KeyboardInterrupt: 
sage: b
experimental branching rule E6 => C4
sage: b.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4


For more detailed information use verbose=True
sage: b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

0 => weight (-3/4, 0, 0, 0)
1 => weight (5/4, 1, -1, 0)
2 => weight (2, -1, -1, -1)
3 => weight (1, 0, 1, -1)
4 => weight (1/2, 0, 0, 2)
5 => weight (3/2, 0, 1, -1)
6 => weight (1, 1, -1, 0)

fundamental weight restrictions E6 => C4:
1 => (1, 1, 0, 0)
2 => (11/4, 0, 0, 0)
3 => (7/4, 0, 1, 0)
4 => (5/2, 0, 0, 1)
5 => (2, 0, 1, 0)
6 => (1, 1, 0, 0)
sage: ### reloading attached file e6.sage modified at 05:48:16 ###

sage: b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => C4:

O---O---O=<=O
1   2   3   4
C4

0 => root (-2, 0, 0, 0)
1 => 2
2 => weight (1, -1, -1, -1)
3 => 3
4 => 4
5 => 3
6 => 2

fundamental weight restrictions E6 => C4:
1 => (0, 1, 0, 0)
2 => (2, 0, 0, 0)
3 => (1, 0, 1, 0)
4 => (2, 0, 0, 1)
5 => (1, 0, 1, 0)
6 => (0, 1, 0, 0)
sage: E6(0,0,1,0,0,0).branch(C4,b)
C4(2,0,0,0) + C4(1,0,1,0)
sage: ### reloading attached file e6.sage modified at 05:49:02 ###
  File "/Users/bump/.sage/temp/meep2/12216/e6.sageKGB3hF.py", line 154
    return [(x0+x1+2x+x3+x4-_sage_const_3 *x5)/_sage_const_2 , (-x0-x1-x2-x3+x4-_sage_const_3 *x5)/_sage_const_2 ,  -x0+x3,  -x1+x2]
                    ^
SyntaxError: invalid syntax

### reloading attached file e6.sage modified at 05:49:16 ###

sage: E6(0,0,1,0,0,0).branch(C4,b1)
C4(2,0,0,0) + C4(1,0,1,0)
sage: 
Exiting Sage (CPU time 0m19.16s, Wall time 18m27.84s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 3.7352950573 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0171320438385 seconds
Total time spent compiling C/C++ extensions:  0.301152944565 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m5.708s
user	0m2.705s
sys	0m0.699s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-24-21-53-39-8c085ca6.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [451 tests, 22.86 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 23.0 seconds
    cpu time: 22.4 seconds
    cumulative wall time: 22.9 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ grep _cmp_ *
ambient_space.py:    def __cmp__(self, other):
cartan_type.py:    def __cmp__(self, other):
coxeter_group.py:        def __cmp__(self, other):
coxeter_group.py:            return super(CoxeterGroupAsPermutationGroup.Element, self).__cmp__(other)
fundamental_group.py:    def __cmp__(self, x):
root_system.py:    def __cmp__(self, other):
type_dual.py:    def __cmp__(self, other):
type_reducible.py:    def __cmp__(self, other):
weyl_group.py:    def __cmp__(self, other):
weyl_group.py:        than :meth:`__cmp__`. But it turned out to be useful for
weyl_group.py:        subclasses overriding __cmp__ with something slow for specific
weyl_group.py:    def __cmp__(self, other):
~/sagemath/sage/src/sage/combinat/root_system:$ grep hash *
ambient_space.py:    def __hash__(self):
ambient_space.py:            sage: hash(e.simple_root(0))
ambient_space.py:        return hash(tuple(sorted([(m,c) for m,c in self._monomial_coefficients.iteritems()])))
cartan_type.py:    def __hash__(self):
cartan_type.py:            sage: hash(ct) #random
cartan_type.py:        return hash((self.n, self.letter))
dynkin_diagram.py:    def __hash__(self):
dynkin_diagram.py:            sage: hash(d) == hash((d.cartan_type(), tuple(d.vertices()), tuple(d.edge_iterator(d.vertices()))))
dynkin_diagram.py:        #return hash(self.cartan_type(), self.vertices(), tuple(self.edges()))
dynkin_diagram.py:        return hash((self.cartan_type(), tuple(self.vertices()), tuple(self.edge_iterator(self.vertices()))))
type_relabel.py:        relabelling = FiniteFamily(relabelling) # Hack to emulate a frozendict which would be hashable!!!!
weyl_group.py:    def __hash__(self):
weyl_group.py:        return hash(self.__matrix)
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A7=WeylCharacterRing("A7",style="coroots")
sage: B4=WeylCharacterRing("B4",style="coroots")
sage: D4=WeylCharacterRing("D4",style="coroots")
sage: D4=WeylCharacterRing("D4",style="coroots")
sage: [A7(f).branch(B4,"symmetric") for f in A7.fundamental_weights()]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-5-017e25f618d2> in <module>()
----> 1 [A7(f).branch(B4,"symmetric") for f in A7.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2212     """
   2213     if type(rule) is str or type(rule) is list:
-> 2214         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2215     if hasattr(rule,"_S"):
   2216         if rule._S != S.cartan_type():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2585                 return BranchingRule(Rtype, Stype, lambda x : [x[i]-x[r-i] for i in range(s)], "symmetric")
   2586             else:
-> 2587                 raise ValueError("Rule not found")
   2588         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
   2589             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")

ValueError: Rule not found
sage: 
Exiting Sage (CPU time 0m6.13s, Wall time 86m21.92s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: b = branching_rule("E6","F4","symmetric")*branching_rule("F4","B3","levi")*branching_rule("B3","G2","miscellaneous"); b
composite branching rule E6 => (symmetric) F4 => (levi) B3 => (miscellaneous) G2
sage: c = branching_rule("E6", "G2xA2", "miscellaneous")*branching_rule("G2xA2", "G2", "proj1"); c
composite branching rule E6 => (miscellaneous) G2xA2 => (proj1) G2
sage: b == c
False
sage: RootSystem("E6").space().fundamental_weights()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-4-5350692b393f> in <module>()
----> 1 RootSystem("E6").space().fundamental_weights()

AttributeError: 'RootSystem' object has no attribute 'space'
sage: RootSystem("E6").ambient_space().fundamental_weights()
Finite family {1: (0, 0, 0, 0, 0, -2/3, -2/3, 2/3), 2: (1/2, 1/2, 1/2, 1/2, 1/2, -1/2, -1/2, 1/2), 3: (-1/2, 1/2, 1/2, 1/2, 1/2, -5/6, -5/6, 5/6), 4: (0, 0, 1, 1, 1, -1, -1, 1), 5: (0, 0, 0, 1, 1, -2/3, -2/3, 2/3), 6: (0, 0, 0, 0, 1, -1/3, -1/3, 1/3)}
sage: [b(v) == c(v) for v  in RootSystem("E6").ambient_space().fundamental_weights()]
[True, True, True, True, True, True]
sage: 
Exiting Sage (CPU time 0m0.46s, Wall time 3m47.20s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.93485999107 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00371694564819 seconds
Total time spent compiling C/C++ extensions:  0.151077032089 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m4.462s
user	0m2.743s
sys	0m0.664s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi")
sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi"); d
composite branching rule A3 => (levi) A2 => (levi) A1
sage: e = branching_rule("A3","A1","symmetric_square")
sage: e = branching_rule("A3","A1","symmetric_square"); e
sage: e
sage: e = branching_rule("A3","D2","isomorphic")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-9-1b5b89b315e2> in <module>()
----> 1 e = branching_rule("A3","D2","isomorphic")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2785     elif rule == "isomorphic":
   2786         if r != s:
-> 2787             raise ValueError("Incompatible ranks")
   2788         if Rtype == Stype:
   2789             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")

ValueError: Incompatible ranks
sage: e
sage: e = branching_rule("A3","D3","isomorphic")
sage: e
isomorphic branching rule A3 => D3
sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")
sage: e
composite branching rule A3 => (isomorphic) D3 => (symmetric) B2
sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")*branching_rule("B2","A1","levi"); e
composite branching rule A3 => (isomorphic) D3 => (symmetric) B2 => (levi) A1
sage: 
Exiting Sage (CPU time 0m1.88s, Wall time 48m6.74s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.6688580513 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00347304344177 seconds
Total time spent compiling C/C++ extensions:  0.135993003845 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.968s
user	0m3.051s
sys	0m0.707s
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/bibliography.rst b/src/doc/en/thematic_tutorials/lie/bibliography.rst
index b7b576b..a25cd15 100644
--- a/src/doc/en/thematic_tutorials/lie/bibliography.rst
+++ b/src/doc/en/thematic_tutorials/lie/bibliography.rst
@@ -18,6 +18,10 @@ Bibliography
 .. [Dyer1993] M. J. Dyer. The nil Hecke ring and Deodhar's conjecture
    on Bruhat intervals. Inventiones Mathematicae, 111(1):571--574, 1993.
 
+.. [Dynkin1952] E. B. Dynkin,
+   Semisimple subalgebras of semisimple Lie algebras. (Russian) 
+   Mat. Sbornik N.S. 30(72):349–462, 1952.
+
 .. [FauserEtAl2006] B. Fauser, P. D. Jarvis, R. C. King, and
    B. G. Wybourne. New branching rules induced by plethysm. *Journal of
    Physics A*. 39(11):2611--2655, 2006.
@@ -94,6 +98,10 @@ Bibliography
    Kirillov--Reshetikhin crystals for nonexceptional types.
    *Representation Theory* 12:186--207, 2008.
 
+.. [Seitz1991] G. Seitz,
+   Maximal subgroups of exceptional algebraic groups. 
+   Mem. Amer. Math. Soc. 90 (1991), no. 441.
+
 .. [Rubenthaler2008] H. Rubenthaler, 
    The (A2,G2) duality in E6, octonions and the triality principle.
    Trans. Amer. Math. Soc. 360 (2008), no. 1, 347–367 
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index fd10f2b..fceb109 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -30,6 +30,7 @@ so not by memorizing a combinatorial rule, but by computing the
 character and restricting the character to a maximal torus of `H`.
 What Sage has memorized (in a series of built-in encoded rules)
 are the various embeddings of maximal tori of maximal subgroups of `G`.
+The maximal subgroups of Lie groups were determined in [Dynkin1952]_.
 This approach to computing branching rules has a limitation: the
 character must fit into memory and be computable by Sage's
 internal code in real time.
@@ -640,11 +641,24 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
 The first rule corresponds to the embedding of ``G_2`` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The remaining rules come about as follows. Let `G` be
+`F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
+or else (if `G=E_7`) `F_4`. We embed `H` into `G`
+in the most obvious way; that is, in the chain
+of subgroups
+
+    .. MATH::
+
+       G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
+
+
+
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
@@ -659,16 +673,17 @@ cannot be created by using the tools you already have, all
 of which are related to the exceptional groups. Of all the
 branching rules listed in [McKayPatera1981]_ the only ones
 that are not implemented or constructible by plethysms
-are given by the following table. (The information given
-in this table is of course not sufficent to describe the embedding.)
-Some of these may eventually be implemented.
+are given by the following table. The information given
+in this table is not intended to suffice to describe the embedding.
+See [Dynkin1952]_ or [Seitz1991]_ for descriptions of these
+subgroups. We hope that all of these may eventually be implemented.
 
     .. MATH::
 
       \begin{aligned}
       E_6 & \to C_4, A_2, G_2
-      \\ E_7 &\to A_2,  A_1, A_1, A_1\times F_4, A_1\times G_2, A_1\times A_1
-      \\ E_8 & \to C_7 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
+      \\ E_7 &\to A_2,  A_1, A_1, A_1\times A_1
+      \\ E_8 & \to C_2 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
       \\ F_4 & \to A_1
       \end{aligned}
 
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..1e7437c 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1954,6 +1954,7 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
@@ -1975,6 +1976,9 @@ def branch_weyl_character(chi, R, S, rule="default"):
         sage: G2xC3=WeylCharacterRing("G2xC3",style="coroots")
         sage: E7(0,1,0,0,0,0,0).branch(G2xC3,rule="miscellaneous") # long time (1.84s)
         G2xC3(1,0,1,0,0) + G2xC3(1,0,1,1,0) + G2xC3(0,1,0,0,1) + G2xC3(2,0,1,0,0) + G2xC3(0,0,1,1,0)
+        sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
+        sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
+        F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
         sage: E8 = WeylCharacterRing("E8",style="coroots")
         sage: G2xF4 = WeylCharacterRing("G2xF4",style="coroots")
         sage: E8(0,0,0,0,0,0,0,1).branch(G2xF4,rule="miscellaneous") # long time (0.76s)
@@ -2285,6 +2289,41 @@ class BranchingRule(SageObject):
         except:
             return self._f(x.to_vector())
 
+    def __cmp__(self, other):
+        """
+        Two branching rules with the same source and target Cartan types are
+        considered equal if they have the same effect on the fundamental
+        representations.
+
+        EXAMPLES::
+
+            sage: b = branching_rule("E6","F4","symmetric")*branching_rule("F4","B3","levi")*branching_rule("B3","G2","miscellaneous"); b
+            composite branching rule E6 => (symmetric) F4 => (levi) B3 => (miscellaneous) G2
+            sage: c = branching_rule("E6", "G2xA2", "miscellaneous")*branching_rule("G2xA2", "G2", "proj1"); c
+            composite branching rule E6 => (miscellaneous) G2xA2 => (proj1) G2
+            sage: b == c
+            True
+            sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi"); d
+            composite branching rule A3 => (levi) A2 => (levi) A1
+            sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")*branching_rule("B2","A1","levi"); e
+            composite branching rule A3 => (isomorphic) D3 => (symmetric) B2 => (levi) A1
+            sage: d == e
+            False
+        """
+        Rspace = RootSystem(self._R).ambient_space()
+        Rspace_other = RootSystem(other._R).ambient_space()
+        if Rspace != Rspace_other:
+            return cmp(Rspace, Rspace_other)
+        Sspace = RootSystem(self._S).ambient_space()
+        Sspace_other = RootSystem(other._S).ambient_space()
+        if Sspace != Sspace_other:
+            return cmp(Sspace, Sspace_other)
+        for v in Rspace.fundamental_weights():
+            [a, b] = [Sspace(self(list(v.to_vector()))), Sspace(other(list(v.to_vector())))]
+            if a != b:
+                return cmp(a, b)
+        return 0
+
     def __mul__(self, other):
         """
         EXAMPLES::
@@ -2583,10 +2622,15 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                 raise ValueError("Rule not found")
         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")
-        elif Rtype[0] == 'D' and r == 4 and Stype[0] == 'G':
+        elif Rtype == CartanType("D4") and Stype == CartanType("G2"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
-        elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
+        elif Rtype == CartanType("E6") and Stype == CartanType("F4"):
             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
+        elif Rtype == CartanType("E6") and Stype == CartanType("C4"):
+            def f(x):
+                [x0,x1,x2,x3,x4,x5]=x[:6]
+                return [(x0+x1+x2+x3+x4-3*x5)/2, (-x0-x1-x2-x3+x4-3*x5)/2,  -x0+x3,  -x1+x2]
+            return BranchingRule(Rtype, Stype, f, "symmetric")
         else:
             raise ValueError("Rule not found")
     elif rule == "extended" or rule == "orthogonal_sum":
@@ -2761,26 +2805,29 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(x[0]-x[1])/2], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
-                 all(t[0] == 'A' for t in stypes):
-            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
             def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
+            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
@@ -2895,6 +2942,16 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[6],x[4]+x[5],-x[4]+x[5],x[1]+x[3],x[2]-x[3],-x[1]-x[2]],"miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("C3")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3],x[2]-x[3],-x[1]-x[2],-2*x[6],x[4]+x[5],-x[4]+x[5]],"miscellaneous")
+                elif stypes == [CartanType("F4"),CartanType("A1")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2,x5-x6,x6-x5]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
+                elif stypes == [CartanType("A1"),CartanType("F4")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [x5-x6,x6-x5,(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
                 else:
                     raise ValueError("Rule not found")
         elif Rtype == CartanType("E8"):
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
Exiting Sage (CPU time 0m3.65s, Wall time 5m40.12s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage:         sage: E6=WeylCharacterRing("E6",style="coroots")
        sage: C4=WeylCharacterRing("C4",style="coroots")

sage: sage: sage: time E6(1,0,0,0,0,0).branch(C4,rule="symmetric")
/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.py:371: DeprecationWarning: Use %time instead of time.
See http://trac.sagemath.org/12719 for details.
  line = f(line, line_number)
CPU times: user 0.06 s, sys: 0.01 s, total: 0.07 s
Wall time: 0.07 s
C4(0,1,0,0)
sage: G2=WeylCharacterRing("G2",style="coroots")
sage: A1=WeylCharacterRing("A1",style="coroots")
sage: [G2(f).branch(A1,rule="levi") for f in G2.fundamental_weights()]
[2*A1(1) + A1(2), 3*A1(0) + A1(2) + 2*A1(3)]
sage: b1 = branching_rule("G2","A1xA1",rule="extended")*branching_rule("A1xA1",rule="proj1")
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-7-5977d6f3cb89> in <module>()
----> 1 b1 = branching_rule("G2","A1xA1",rule="extended")*branching_rule("A1xA1",rule="proj1")

TypeError: get_branching_rule() takes at least 2 arguments (2 given)
sage: b1 = branching_rule("G2","A1xA1",rule="extended")*branching_rule("A1xA1","A1",rule="proj1")
sage: [G2(f).branch(A1,rule=b1) for f in G2.fundamental_weights()]
[2*A1(1) + A1(2), 3*A1(0) + A1(2) + 2*A1(3)]
sage: b1 == branching_rule("G2","A1","levi")
False
sage: b1.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

1 => 1

For more detailed information use verbose=True
sage: b1.describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

0 => (zero)
1 => 1
2 => weight (-3/2, 3/2)

fundamental weight restrictions G2 => A1:
1 => (1,)
2 => (0,)
sage: branching_rule("G2","A1","levi").describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

0 => weight (1, 1)
1 => 1
2 => weight (-2, 1)

fundamental weight restrictions G2 => A1:
1 => (1,)
2 => (0,)
sage: b2 = branching_rule("G2","A1xA1",rule="extended")*branching_rule("A1xA1","A1",rule="proj2")
sage: b2.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1


For more detailed information use verbose=True
sage: bi.describe()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-16-35200e4c96c7> in <module>()
----> 1 bi.describe()

NameError: name 'bi' is not defined
sage: b1.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

1 => 1

For more detailed information use verbose=True
sage: [G2(f).branch(A1,rule="b1") for f in G2.fundamental_weights()]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-18-6d6692a2402a> in <module>()
----> 1 [G2(f).branch(A1,rule="b1") for f in G2.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2226                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2227             else:
-> 2228                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2229         else:
   2230             h = S._space(rule(list(k.to_vector())))

TypeError: 'NoneType' object is not callable
sage: b1
composite branching rule G2 => (extended) A1xA1 => (proj1) A1
sage: [G2(f).branch(A1,rule="b2") for f in G2.fundamental_weights()]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-20-ebeb917b4e9b> in <module>()
----> 1 [G2(f).branch(A1,rule="b2") for f in G2.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2226                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2227             else:
-> 2228                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2229         else:
   2230             h = S._space(rule(list(k.to_vector())))

TypeError: 'NoneType' object is not callable
sage: [G2(f) for f in G2.fundamental_weights()]
[G2(1,0), G2(0,1)]
sage: [G2(f).branch(A1,rule=b1) for f in G2.fundamental_weights()]
[2*A1(1) + A1(2), 3*A1(0) + A1(2) + 2*A1(3)]
sage: [G2(f).branch(A1,rule=b2) for f in G2.fundamental_weights()]
[3*A1(0) + 2*A1(1), 3*A1(0) + 4*A1(1) + A1(2)]
sage: [G2(f).branch(A1,rule="levi") for f in G2.fundamental_weights()]
[2*A1(1) + A1(2), 3*A1(0) + A1(2) + 2*A1(3)]
sage: c = branching_rule("G2","A2",rule="extended")*branching_rule("A2","A1",rule="levi")
sage: d = branching_rule("G2","A2",rule="extended")*branching_rule("A2","A2","automorphic")*branching_rule("A2","A1",rule="levi")
sage: c
composite branching rule G2 => (extended) A2 => (levi) A1
sage: d
composite branching rule G2 => (extended) A2 => (automorphic) A2 => (levi) A1
sage: [G2(f).branch(A1,rule=c) for f in G2.fundamental_weights()]
[3*A1(0) + 2*A1(1), 3*A1(0) + 4*A1(1) + A1(2)]
sage: [G2(f).branch(A1,rule=d) for f in G2.fundamental_weights()]
[3*A1(0) + 2*A1(1), 3*A1(0) + 4*A1(1) + A1(2)]
sage: c == d
False
sage: c.describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

0 => weight (0, 1)
1 => weight (-2/3, 1/3)
2 => 1

fundamental weight restrictions G2 => A1:
1 => (0,)
2 => (1,)
sage: d.describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

0 => 1
1 => weight (-1/3, -1/3)
2 => weight (0, 1)

fundamental weight restrictions G2 => A1:
1 => (-1,)
2 => (-2,)
sage: branching_rule(
....: "G2","A2","extended").describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (-2/3, 1/3, 1/3)
2 => 1

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (1, -2)
sage: 
Exiting Sage (CPU time 0m8.21s, Wall time 140m7.60s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 3.42365002632 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00410985946655 seconds
Total time spent compiling C/C++ extensions:  0.335528850555 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m5.734s
user	0m3.025s
sys	0m0.748s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.53446912766 seconds)
running install
running build
running build_py
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00384187698364 seconds
Total time spent compiling C/C++ extensions:  0.133775949478 seconds.
running install_lib
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.714s
user	0m2.927s
sys	0m0.670s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py
Running doctests with ID 2013-12-25-11-42-15-9f35850d.
Doctesting 1 file.
sage -t --long weyl_characters.py
**********************************************************************
File "weyl_characters.py", line 2375, in sage.combinat.root_system.weyl_characters.BranchingRule.describe
Failed example:
    branching_rule("G2","A2","extended").describe()
Expected:
    <BLANKLINE>            
    3
    O=<=O---O
    1   2   0
    G2~
    <BLANKLINE>
    root restrictions G2 => A2:
    <BLANKLINE>
    O---O
    1   2
    A2
    <BLANKLINE>
    0 => 2
    2 => 1
    <BLANKLINE>
    For more detailed information use verbose=True
Got:
    <BLANKLINE>
      3
    O=<=O---O
    1   2   0
    G2~
    root restrictions G2 => A2:
    <BLANKLINE>
    O---O
    1   2
    A2
    <BLANKLINE>
    <BLANKLINE>
    For more detailed information use verbose=True
**********************************************************************
1 item had failures:
   1 of   2 in sage.combinat.root_system.weyl_characters.BranchingRule.describe
    [461 tests, 1 failure, 24.89 s]
----------------------------------------------------------------------
sage -t --long weyl_characters.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 25.1 seconds
    cpu time: 24.2 seconds
    cumulative wall time: 24.9 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.54281711578 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00383305549622 seconds
Total time spent compiling C/C++ extensions:  0.135859966278 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.725s
user	0m2.959s
sys	0m0.678s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py
Running doctests with ID 2013-12-25-11-45-14-a21f8797.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [461 tests, 24.58 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 24.8 seconds
    cpu time: 24.5 seconds
    cumulative wall time: 24.6 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: branching_rule("G2","A2","extended").describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
2 => 1

For more detailed information use verbose=True
sage: branching_rule("G2","A2","extended").describe(verbose=True)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (-2/3, 1/3, 1/3)
2 => 1

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (1, -2)
sage: branching_rule("B4","D4","extended").describe(verbose=True)

    O 0
    |
    |
O---O---O=>=O
1   2   3   4
B4~
root restrictions B4 => D4:

    O 4
    |
    |
O---O---O
1   2   3
D4

0 => root (-1, -1, 0, 0)
1 => 1
2 => 2
3 => 3
4 => weight (0, 0, 0, 1)

fundamental weight restrictions B4 => D4:
1 => (1, 0, 0, 0)
2 => (0, 1, 0, 0)
3 => (0, 0, 1, 1)
4 => (0, 0, 0, 1)
sage: branching_rule("B5","D5","extended").describe(verbose=True)

    O 0
    |
    |
O---O---O---O=>=O
1   2   3   4   5
B5~
root restrictions B5 => D5:

        O 5
        |
        |
O---O---O---O
1   2   3   4
D5

0 => root (-1, -1, 0, 0, 0)
1 => 1
2 => 2
3 => 3
4 => 4
5 => weight (0, 0, 0, 0, 1)

fundamental weight restrictions B5 => D5:
1 => (1, 0, 0, 0, 0)
2 => (0, 1, 0, 0, 0)
3 => (0, 0, 1, 0, 0)
4 => (0, 0, 0, 1, 1)
5 => (0, 0, 0, 0, 1)
sage: %attach /Users/bump/branch/e6.sage
sage: branching_rule("B5","D5","extended")([X0,X1,X2,X3,X4])
[X0, X1, X2, X3, X4]
sage: B5.highest_root()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-7-9ec1c6971659> in <module>()
----> 1 B5.highest_root()

NameError: name 'B5' is not defined
sage: ### reloading attached file e6.sage modified at 19:55:23 ###

sage: B5.highest_root()
(1, 1, 0, 0, 0)
sage: [for r in B5.simple_roots(): print r]
  File "<ipython-input-9-37e638d6ce1a>", line 1
    [for r in B5.simple_roots(): print r]
       ^
SyntaxError: invalid syntax

sage: for r in B5.simple_roots(): print r
(1, -1, 0, 0, 0)
(0, 1, -1, 0, 0)
(0, 0, 1, -1, 0)
(0, 0, 0, 1, -1)
(0, 0, 0, 0, 1)
sage: for r in D5.simple_roots(): print r
(1, -1, 0, 0, 0)
(0, 1, -1, 0, 0)
(0, 0, 1, -1, 0)
(0, 0, 0, 1, -1)
(0, 0, 0, 1, 1)
sage: 
sage: A3
The Weyl Character Ring of Type A3 with Integer Ring coefficients
sage: W=A3.space().weyl_group(prefix="s")
sage: [s1,s2,s3]=W.simple_reflections()
sage: (s1*s2).parent()
Weyl Group of type ['A', 3] (as a matrix group acting on the ambient space)
sage: (s1*s2).parent().cartan_type()
['A', 3]
sage: ### reloading attached file e6.sage modified at 21:53:33 ###
(s1*s2).parent().cartan_type()
['E', 6]
sage: weyl_branching_rule(s1*s2)
conjugation by s2*s1 branching rule E6 => E6
sage: w
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-19-b938b801a0bf> in <module>()
----> 1 w

NameError: name 'w' is not defined
sage: s1
s1
sage: s1.parent()
Weyl Group of type ['E', 6] (as a matrix group acting on the ambient space)
sage: ### reloading attached file e6.sage modified at 21:54:48 ###

sage: W=A3.space().weyl_group(prefix="s")
sage: [s1,s2,s3]=W.simple_reflections()
sage:
sage: weyl_branching_rule(s1*s2)
conjugation by s1*s2 branching rule A3 => A3
sage: W = G2.space().weyl_group(prefix="s")
sage: [s1,s2] = W.simple_reflections()
sage: weyl_branching_rule(s1)
conjugation by s1 branching rule G2 => G2
sage: weyl_branching_rule(s1)*branching_rule("G2","A2","extended")
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-29-7b323a17a339> in <module>()
----> 1 (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2422                 else:
   2423                     r = Rspace.simple_roots()[j]
-> 2424                 resr = Sspace(self(list(r.to_vector())))
   2425                 if debug:
   2426                     print "root %d: r = %s, b(r)=%s"%(j, r, resr)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: [weyl_branching_rule(s1)(v) for v in G2.fundamental_weights()]
[(1, -1, 0), (2, -1, -1)]
sage: [branching_rule("G2","A2","extended")(weyl_branching_rule(s1)(v)) for v in G2.fundamental_weights()]
[[1/3, -2/3, 1/3], [0, -1, 1]]
sage: (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-32-7b323a17a339> in <module>()
----> 1 (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2422                 else:
   2423                     r = Rspace.simple_roots()[j]
-> 2424                 resr = Sspace(self(list(r.to_vector())))
   2425                 if debug:
   2426                     print "root %d: r = %s, b(r)=%s"%(j, r, resr)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-34-91803a159814> in <module>()
----> 1 b.describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2422                 else:
   2423                     r = Rspace.simple_roots()[j]
-> 2424                 resr = Sspace(self(list(r.to_vector())))
   2425                 if debug:
   2426                     print "root %d: r = %s, b(r)=%s"%(j, r, resr)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: [b(v) for v in G2.simple_roots()]
[[2/3, -1/3, -1/3], [-1, 0, 1]]
sage: [b(v) for v in G2.fundamental_weights()]
[[1/3, -2/3, 1/3], [0, -1, 1]]
sage: branching_rule("G2","A2","extended").describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
2 => 1

For more detailed information use verbose=True
sage: 
Exiting Sage (CPU time 0m13.27s, Wall time 133m10.00s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 5.78246188164 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0177159309387 seconds
Total time spent compiling C/C++ extensions:  0.144152164459 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m8.673s
user	0m3.083s
sys	0m0.813s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: W = G2.space().weyl_group(prefix="s")
sage: [s1,s2] = W.simple_reflections()
sage: y
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-4-009520053b00> in <module>()
----> 1 y

NameError: name 'y' is not defined
sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

(-2, 1, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'>
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-6-91803a159814> in <module>()
----> 1 b.describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2423                     r = Rspace.simple_roots()[j]
   2424                 print r, type(r)
-> 2425                 resr = Sspace(self(list(r.to_vector())))
   2426                 if debug:
   2427                     print "root %d: r = %s, b(r)=%s"%(j, r, resr)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: 
Exiting Sage (CPU time 0m8.74s, Wall time 49m7.52s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.62084293365 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00388193130493 seconds
Total time spent compiling C/C++ extensions:  0.138216018677 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.806s
user	0m3.047s
sys	0m0.703s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
sage: W = G2.space().weyl_group(prefix="s")
sage: [s1,s2] = W.simple_reflections()
sage: sage: s1
s1
sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

(-2, 1, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-6-91803a159814> in <module>()
----> 1 b.describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2423                     r = Rspace.simple_roots()[j]
   2424                 print r, type(r), r.parent()
-> 2425                 resr = Sspace(self(list(r.to_vector())))
   2426                 if debug:
   2427                     print "root %d: r = %s, b(r)=%s"%(j, r, resr)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: 
Exiting Sage (CPU time 0m6.22s, Wall time 2m48.04s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.5489089489 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00365996360779 seconds
Total time spent compiling C/C++ extensions:  0.1314702034 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.751s
user	0m2.955s
sys	0m0.694s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-2-8cca634d1d79> in <module>()
----> 1 b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b

NameError: name 's1' is not defined

sage: W = G2.space().weyl_group(prefix="s"); [s1,s2] = W.simple_reflections()
sage: sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

1: (-2, 1, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (-2, 1, 1)
3: [-2, 1, 1]
4:---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-5-91803a159814> in <module>()
----> 1 b.describe()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in describe(self, verbose, debug, no_r)
   2425                 print "2:", r.to_vector()
   2426                 print "3:", list(r.to_vector())
-> 2427                 print "4:",self(list(r.to_vector()))
   2428                 resr = Sspace(self(list(r.to_vector())))
   2429                 if debug:

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2311             return self._f(x)
   2312         except:
-> 2313             return self._f(x.to_vector())
   2314 
   2315     def __cmp__(self, other):

AttributeError: 'list' object has no attribute 'to_vector'
sage: branching_rule9("G2","A2","extended").describe()
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-6-7c1d5d64f46d> in <module>()
----> 1 branching_rule9("G2","A2","extended").describe()

NameError: name 'branching_rule9' is not defined
sage: branching_rule("G2","A2","extended").describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

1: (-2, 1, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (-2, 1, 1)
3: [-2, 1, 1]
4: [0, 1, -1]
0 => 2
1: (0, 1, -1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (0, 1, -1)
3: [0, 1, -1]
4: [-2/3, 1/3, 1/3]
1: (1, -2, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (1, -2, 1)
3: [1, -2, 1]
4: [1, -1, 0]
2 => 1

For more detailed information use verbose=True
sage: RootSystem(CartanType("G2"))
Root system of type ['G', 2]
sage: RootSystem(CartanType("G2")).ambient_space()
Ambient space of the Root system of type ['G', 2]
sage: ### reloading attached file e6.sage modified at 23:02:01 ###
b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

1: (-2, 1, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (-2, 1, 1)
3: [-2, 1, 1]
4: [0, 1, -1]
0 => 2
1: (0, 1, -1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (0, 1, -1)
3: [0, 1, -1]
4: [2/3, -1/3, -1/3]
1: (1, -2, 1) <class 'sage.combinat.root_system.ambient_space.AmbientSpace_with_category.element_class'> Ambient space of the Root system of type ['G', 2]
2: (1, -2, 1)
3: [1, -2, 1]
4: [-1, 0, 1]

For more detailed information use verbose=True
sage: 
Exiting Sage (CPU time 0m6.40s, Wall time 7m8.47s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.5683529377 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00499796867371 seconds
Total time spent compiling C/C++ extensions:  0.139760971069 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.770s
user	0m2.984s
sys	0m0.697s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
sage: W=G2.space().weyl_group(prefix="s"); [s1,s2] = W.simple_reflections()
sage: b=(weyl_branching_rule(s1)*branching_rule("G2","A2","extended")); b
composite branching rule G2 => (conjugation by s1) G2 => (extended) A2
sage: b.describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2

For more detailed information use verbose=True
sage: (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (2/3, -1/3, -1/3)
2 => root (-1, 0, 1)

fundamental weight restrictions G2 => A2:
1 => (1, -1)
2 => (1, -2)
sage: (weyl_branching_rule(W.one())*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (-2/3, 1/3, 1/3)
2 => 1

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (1, -2)
sage: (weyl_branching_rule(s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (1, 0, -1)
1 => weight (1/3, -2/3, 1/3)
2 => root (-1, 1, 0)

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (-1, -1)
sage: (weyl_branching_rule(s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 1, 0)
1 => weight (-1/3, -1/3, 2/3)
2 => root (1, 0, -1)

fundamental weight restrictions G2 => A2:
1 => (1, -1)
2 => (2, -1)
sage: (weyl_branching_rule(s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (1, 0, -1)
1 => weight (-1/3, 2/3, -1/3)
2 => root (0, -1, 1)

fundamental weight restrictions G2 => A2:
1 => (-1, 0)
2 => (-1, -1)
sage: (weyl_branching_rule(s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 1, 0)
1 => weight (1/3, 1/3, -2/3)
2 => root (0, -1, 1)

fundamental weight restrictions G2 => A2:
1 => (1, 0)
2 => (2, -1)
sage: (weyl_branching_rule(s2*s1*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (1, 0, -1)
1 => weight (1/3, -2/3, 1/3)
2 => root (-1, 1, 0)

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (-1, -1)
sage: (weyl_branching_rule(s2*s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 1
1 => weight (-1/3, -1/3, 2/3)
2 => 2

fundamental weight restrictions G2 => A2:
1 => (-1, 0)
2 => (-2, 1)
sage: (weyl_branching_rule(s1*s2*s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 0, 1)
1 => weight (1/3, -2/3, 1/3)
2 => 2

fundamental weight restrictions G2 => A2:
1 => (1, 0)
2 => (1, 1)
sage: (weyl_branching_rule(s2*s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 1
1 => weight (1/3, 1/3, -2/3)
2 => root (-1, 0, 1)

fundamental weight restrictions G2 => A2:
1 => (-1, 1)
2 => (-2, 1)
sage: (weyl_branching_rule(s1*s2*s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 0, 1)
1 => weight (-1/3, 2/3, -1/3)
2 => 1

fundamental weight restrictions G2 => A2:
1 => (0, 1)
2 => (1, 1)
sage: (weyl_branching_rule(s2*s1*s2*s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (0, -1, 1)
1 => weight (-2/3, 1/3, 1/3)
2 => root (1, 0, -1)

fundamental weight restrictions G2 => A2:
1 => (-1, 1)
2 => (-1, 2)
sage: (weyl_branching_rule(s1*s2*s1*s2*s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (0, -1, 1)
1 => weight (2/3, -1/3, -1/3)
2 => root (-1, 1, 0)

fundamental weight restrictions G2 => A2:
1 => (0, 1)
2 => (-1, 2)
sage: (weyl_branching_rule(s2*s1*s2*s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (0, -1, 1)
1 => weight (2/3, -1/3, -1/3)
2 => root (-1, 1, 0)

fundamental weight restrictions G2 => A2:
1 => (0, 1)
2 => (-1, 2)
sage: (weyl_branching_rule(s1*s2*s1*s2*s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (0, -1, 1)
1 => weight (-2/3, 1/3, 1/3)
2 => root (1, 0, -1)

fundamental weight restrictions G2 => A2:
1 => (-1, 1)
2 => (-1, 2)
sage: (weyl_branching_rule(W.one())*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (-2/3, 1/3, 1/3)
2 => 1

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (1, -2)
sage: (weyl_branching_rule(W.one(s1))*branching_rule("G2","A2","extended")).describe(verbose=true)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-21-f4171a29ad55> in <module>()
----> 1 (weyl_branching_rule(W.one(s1))*branching_rule("G2","A2","extended")).describe(verbose=true)

TypeError: __call__() takes exactly 0 positional arguments (1 given)
sage: (weyl_branching_rule(s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 2
1 => weight (2/3, -1/3, -1/3)
2 => root (-1, 0, 1)

fundamental weight restrictions G2 => A2:
1 => (1, -1)
2 => (1, -2)
sage: (weyl_branching_rule(s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (1, 0, -1)
1 => weight (1/3, -2/3, 1/3)
2 => root (-1, 1, 0)

fundamental weight restrictions G2 => A2:
1 => (0, -1)
2 => (-1, -1)
sage: (weyl_branching_rule(s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 1, 0)
1 => weight (-1/3, -1/3, 2/3)
2 => root (1, 0, -1)

fundamental weight restrictions G2 => A2:
1 => (1, -1)
2 => (2, -1)
sage: (weyl_branching_rule(s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (1, 0, -1)
1 => weight (-1/3, 2/3, -1/3)
2 => root (0, -1, 1)

fundamental weight restrictions G2 => A2:
1 => (-1, 0)
2 => (-1, -1)
sage: (weyl_branching_rule(s1*s2*s1)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => root (-1, 1, 0)
1 => weight (1/3, 1/3, -2/3)
2 => root (0, -1, 1)

fundamental weight restrictions G2 => A2:
1 => (1, 0)
2 => (2, -1)
sage: (weyl_branching_rule(s2*s1*s2)*branching_rule("G2","A2","extended")).describe(verbose=true)

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A2:

O---O
1   2
A2

0 => 1
1 => weight (-1/3, -1/3, 2/3)
2 => 2

fundamental weight restrictions G2 => A2:
1 => (-1, 0)
2 => (-2, 1)
sage: 
Exiting Sage (CPU time 0m27.65s, Wall time 394m10.15s).
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/bibliography.rst b/src/doc/en/thematic_tutorials/lie/bibliography.rst
index b7b576b..a25cd15 100644
--- a/src/doc/en/thematic_tutorials/lie/bibliography.rst
+++ b/src/doc/en/thematic_tutorials/lie/bibliography.rst
@@ -18,6 +18,10 @@ Bibliography
 .. [Dyer1993] M. J. Dyer. The nil Hecke ring and Deodhar's conjecture
    on Bruhat intervals. Inventiones Mathematicae, 111(1):571--574, 1993.
 
+.. [Dynkin1952] E. B. Dynkin,
+   Semisimple subalgebras of semisimple Lie algebras. (Russian) 
+   Mat. Sbornik N.S. 30(72):349–462, 1952.
+
 .. [FauserEtAl2006] B. Fauser, P. D. Jarvis, R. C. King, and
    B. G. Wybourne. New branching rules induced by plethysm. *Journal of
    Physics A*. 39(11):2611--2655, 2006.
@@ -94,6 +98,10 @@ Bibliography
    Kirillov--Reshetikhin crystals for nonexceptional types.
    *Representation Theory* 12:186--207, 2008.
 
+.. [Seitz1991] G. Seitz,
+   Maximal subgroups of exceptional algebraic groups. 
+   Mem. Amer. Math. Soc. 90 (1991), no. 441.
+
 .. [Rubenthaler2008] H. Rubenthaler, 
    The (A2,G2) duality in E6, octonions and the triality principle.
    Trans. Amer. Math. Soc. 360 (2008), no. 1, 347–367 
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index fd10f2b..fceb109 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -30,6 +30,7 @@ so not by memorizing a combinatorial rule, but by computing the
 character and restricting the character to a maximal torus of `H`.
 What Sage has memorized (in a series of built-in encoded rules)
 are the various embeddings of maximal tori of maximal subgroups of `G`.
+The maximal subgroups of Lie groups were determined in [Dynkin1952]_.
 This approach to computing branching rules has a limitation: the
 character must fit into memory and be computable by Sage's
 internal code in real time.
@@ -640,11 +641,24 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
 The first rule corresponds to the embedding of ``G_2`` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The remaining rules come about as follows. Let `G` be
+`F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
+or else (if `G=E_7`) `F_4`. We embed `H` into `G`
+in the most obvious way; that is, in the chain
+of subgroups
+
+    .. MATH::
+
+       G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
+
+
+
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
@@ -659,16 +673,17 @@ cannot be created by using the tools you already have, all
 of which are related to the exceptional groups. Of all the
 branching rules listed in [McKayPatera1981]_ the only ones
 that are not implemented or constructible by plethysms
-are given by the following table. (The information given
-in this table is of course not sufficent to describe the embedding.)
-Some of these may eventually be implemented.
+are given by the following table. The information given
+in this table is not intended to suffice to describe the embedding.
+See [Dynkin1952]_ or [Seitz1991]_ for descriptions of these
+subgroups. We hope that all of these may eventually be implemented.
 
     .. MATH::
 
       \begin{aligned}
       E_6 & \to C_4, A_2, G_2
-      \\ E_7 &\to A_2,  A_1, A_1, A_1\times F_4, A_1\times G_2, A_1\times A_1
-      \\ E_8 & \to C_7 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
+      \\ E_7 &\to A_2,  A_1, A_1, A_1\times A_1
+      \\ E_8 & \to C_2 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
       \\ F_4 & \to A_1
       \end{aligned}
 
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..24063e4 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1703,21 +1703,38 @@ def branch_weyl_character(chi, R, S, rule="default"):
 
     Related to the automorphic type, when `G` admits
     an outer automorphism (usually of degree 2) we may consider
-    the branching rule to the isotropy subgroup `H`. In many cases
-    the Dynkin diagram of `H` can be obtained by folding the Dynkin
-    diagram of `G`. For such isotropy subgroups use ``rule="symmetric"``.
-    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
-    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+    the branching rule to the isotropy subgroup `H`. Outer
+    automorphisms correspond to symmetries of the Dynkin diagram.
+    For such isotropy subgroups use ``rule="symmetric"``.
+    We may thus obtain the following branching rules.
 
     .. MATH::
 
-        A_{2r+1} & \to B_r
-        \\ A_{2r} & \to C_r
-        \\ A_{2r} & \to D_r
+        A_{2r} & \to B_r
+        \\ A_{2r-1} & \to C_r
+        \\ A_{2r-1} & \to D_r
         \\ D_r & \to B_{r-1}
         \\ E_6 & \to F_4
+        \\ E_6 & \to C_4
         \\ D_4 & \to G_2
 
+    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
+    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+
+    In some cases, two outer automorphisms that differ by an
+    inner automorphism may have different fixed subgroups.
+    Thus, while the Dynkin diagram of `E_6` has a single
+    involutory automorphism, there are two involutions
+    of the group (differing by an inner automorphism) with
+    fixed subgroups `F_4` and `C_4`. Similarly
+    `SL(2r)`, of Cartan type `A_{2r-1}`, has subgroups
+    `SO(2r)` and `Sp(2r)`, both fixed subgroups of outer
+    automorphisms that differ from each other by an inner
+    automorphism.
+
+    In many cases the Dynkin diagram of `H` can be obtained by
+    folding the Dynkin diagram of `G`.
+
     EXAMPLES::
 
         sage: [w.branch(B2,rule="symmetric") for w in [A4(1,0,0,0,0),A4(1,1,0,0,0),A4(1,1,1,0,0),A4(2,0,0,0,0)]]
@@ -1737,6 +1754,12 @@ def branch_weyl_character(chi, R, S, rule="default"):
          F4(1,0,0,0) + 2*F4(0,0,1,0) + F4(1,0,0,1) + F4(0,1,0,0),
          F4(0,0,0,1) + F4(1,0,0,0) + F4(0,0,1,0),
          F4(0,0,0,0) + F4(0,0,0,1)]
+        sage: E6=WeylCharacterRing("E6",style="coroots")
+        sage: C4=WeylCharacterRing("C4",style="coroots")
+        sage: chi = E6(1,0,0,0,0,0); chi.degree()
+        27
+        sage: chi.branch(C4,rule="symmetric")
+        C4(0,1,0,0)
 
     .. RUBRIC:: Extended Type
 
@@ -1954,6 +1977,7 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
@@ -1975,6 +1999,9 @@ def branch_weyl_character(chi, R, S, rule="default"):
         sage: G2xC3=WeylCharacterRing("G2xC3",style="coroots")
         sage: E7(0,1,0,0,0,0,0).branch(G2xC3,rule="miscellaneous") # long time (1.84s)
         G2xC3(1,0,1,0,0) + G2xC3(1,0,1,1,0) + G2xC3(0,1,0,0,1) + G2xC3(2,0,1,0,0) + G2xC3(0,0,1,1,0)
+        sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
+        sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
+        F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
         sage: E8 = WeylCharacterRing("E8",style="coroots")
         sage: G2xF4 = WeylCharacterRing("G2xF4",style="coroots")
         sage: E8(0,0,0,0,0,0,0,1).branch(G2xF4,rule="miscellaneous") # long time (0.76s)
@@ -2285,6 +2312,41 @@ class BranchingRule(SageObject):
         except:
             return self._f(x.to_vector())
 
+    def __cmp__(self, other):
+        """
+        Two branching rules with the same source and target Cartan types are
+        considered equal if they have the same effect on the fundamental
+        representations.
+
+        EXAMPLES::
+
+            sage: b = branching_rule("E6","F4","symmetric")*branching_rule("F4","B3","levi")*branching_rule("B3","G2","miscellaneous"); b
+            composite branching rule E6 => (symmetric) F4 => (levi) B3 => (miscellaneous) G2
+            sage: c = branching_rule("E6", "G2xA2", "miscellaneous")*branching_rule("G2xA2", "G2", "proj1"); c
+            composite branching rule E6 => (miscellaneous) G2xA2 => (proj1) G2
+            sage: b == c
+            True
+            sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi"); d
+            composite branching rule A3 => (levi) A2 => (levi) A1
+            sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")*branching_rule("B2","A1","levi"); e
+            composite branching rule A3 => (isomorphic) D3 => (symmetric) B2 => (levi) A1
+            sage: d == e
+            False
+        """
+        Rspace = RootSystem(self._R).ambient_space()
+        Rspace_other = RootSystem(other._R).ambient_space()
+        if Rspace != Rspace_other:
+            return cmp(Rspace, Rspace_other)
+        Sspace = RootSystem(self._S).ambient_space()
+        Sspace_other = RootSystem(other._S).ambient_space()
+        if Sspace != Sspace_other:
+            return cmp(Sspace, Sspace_other)
+        for v in Rspace.fundamental_weights():
+            [a, b] = [Sspace(self(list(v.to_vector()))), Sspace(other(list(v.to_vector())))]
+            if a != b:
+                return cmp(a, b)
+        return 0
+
     def __mul__(self, other):
         """
         EXAMPLES::
@@ -2583,10 +2645,15 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                 raise ValueError("Rule not found")
         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")
-        elif Rtype[0] == 'D' and r == 4 and Stype[0] == 'G':
+        elif Rtype == CartanType("D4") and Stype == CartanType("G2"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
-        elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
+        elif Rtype == CartanType("E6") and Stype == CartanType("F4"):
             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
+        elif Rtype == CartanType("E6") and Stype == CartanType("C4"):
+            def f(x):
+                [x0,x1,x2,x3,x4,x5]=x[:6]
+                return [(x0+x1+x2+x3+x4-3*x5)/2, (-x0-x1-x2-x3+x4-3*x5)/2,  -x0+x3,  -x1+x2]
+            return BranchingRule(Rtype, Stype, f, "symmetric")
         else:
             raise ValueError("Rule not found")
     elif rule == "extended" or rule == "orthogonal_sum":
@@ -2761,26 +2828,29 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(x[0]-x[1])/2], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
-                 all(t[0] == 'A' for t in stypes):
-            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
             def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
+            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
@@ -2895,6 +2965,16 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[6],x[4]+x[5],-x[4]+x[5],x[1]+x[3],x[2]-x[3],-x[1]-x[2]],"miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("C3")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3],x[2]-x[3],-x[1]-x[2],-2*x[6],x[4]+x[5],-x[4]+x[5]],"miscellaneous")
+                elif stypes == [CartanType("F4"),CartanType("A1")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2,x5-x6,x6-x5]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
+                elif stypes == [CartanType("A1"),CartanType("F4")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [x5-x6,x6-x5,(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
                 else:
                     raise ValueError("Rule not found")
         elif Rtype == CartanType("E8"):
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 3.91422510147 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0139729976654 seconds
Total time spent compiling C/C++ extensions:  0.249349117279 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m6.122s
user	0m3.012s
sys	0m0.752s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-26-04-49-27-d77cfc67.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [461 tests, 25.46 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 25.6 seconds
    cpu time: 24.5 seconds
    cumulative wall time: 25.5 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: E7.simple_roots()
Finite family {1: (1/2, -1/2, -1/2, -1/2, -1/2, -1/2, -1/2, 1/2), 2: (1, 1, 0, 0, 0, 0, 0, 0), 3: (-1, 1, 0, 0, 0, 0, 0, 0), 4: (0, -1, 1, 0, 0, 0, 0, 0), 5: (0, 0, -1, 1, 0, 0, 0, 0), 6: (0, 0, 0, -1, 1, 0, 0, 0), 7: (0, 0, 0, 0, -1, 1, 0, 0)}
sage: ### reloading attached file a1.sage modified at 12:59:30 ###
### reloading attached file a1.sage modified at 13:00:11 ###
f(v) for v in E7.simple_roots()
  File "<ipython-input-3-2ba1b4fc89cd>", line 1
    f(v) for v in E7.simple_roots()
           ^
SyntaxError: invalid syntax

sage: v in E7.simple_roots(): print f(v)
  File "<ipython-input-4-d65a1237f5c3>", line 1
    v in E7.simple_roots(): print f(v)
                          ^
SyntaxError: invalid syntax

sage: for v in E7.simple_roots(): print f(v)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-5-a62ed53d0230> in <module>()
----> 1 for v in E7.simple_roots(): print f(v)

/Users/bump/.sage/temp/meep2/14278/a1.sagevl3vwB.py in f(x)
     46 def f(x):
     47     [x0,x1,x2,x3,x4,x5,x6,x7]=x
---> 48     return c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5+c6*x6
     49 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__mul__ (sage/structure/element.c:14533)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8114)()

TypeError: 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular' object cannot be interpreted as an index
sage: ### reloading attached file a1.sage modified at 13:01:02 ###

sage: for v in E7.simple_roots(): print f(v)
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6
c0 + c1
-c0 + c1
-c1 + c2
-c2 + c3
-c3 + c4
-c4 + c5
sage: ### reloading attached file a1.sage modified at 13:02:46 ###
for v in E7.simple_roots(): print f(v)
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - c4 - 1/2*c6 - 1
c0 + c1
-c0 + c1
-c1 + c2
-c2 + c3
-c3 + c4
2
sage: ### reloading attached file a1.sage modified at 13:03:24 ###

sage: for v in E7.simple_roots(): print f(v)
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
<ipython-input-8-a62ed53d0230> in <module>()
----> 1 for v in E7.simple_roots(): print f(v)

/Users/bump/.sage/temp/meep2/14278/a1.sageEPraYx.py in f(x)
     47 def f(x):
     48     [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
---> 49     c5 = c4+_sage_const_2
     50     c4 = c3+_sage_const_2
     51     print (c0,c1,c2,c3,c4,c5,c6)

UnboundLocalError: local variable 'c4' referenced before assignment
sage: ### reloading attached file a1.sage modified at 13:03:33 ###

sage: for v in E7.simple_roots(): print f(v)
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
1/2*c0 - 1/2*c1 - 1/2*c2 - 3/2*c3 - 1/2*c6 - 3
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
c0 + c1
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
-c0 + c1
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
-c1 + c2
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
-c2 + c3
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
2
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
2
sage: ### reloading attached file a1.sage modified at 13:04:54 ###
res()
(c0, c1, c2, c3, c3 + 2, c3 + 4, c6)
1/2*c0 - 1/2*c1 - 1/2*c2 - 3/2*c3 - 1/2*c6 - 3
c0 + c1
-c0 + c1
-c1 + c2
-c2 + c3
2
2
sage: ### reloading attached file a1.sage modified at 13:05:29 ###
res()
(c0, c1, c2, c2 + 2, c2 + 4, c2 + 6, c6) 

1/2*c0 - 1/2*c1 - 2*c2 - 1/2*c6 - 6
c0 + c1
-c0 + c1
-c1 + c2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:06:13 ###

sage: res()
(c0, c0 + 2, c0 + 4, c0 + 6, c0 + 8, c0 + 10, c6) 

-2*c0 - 1/2*c6 - 15
2*c0 + 2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:06:41 ###
### reloading attached file a1.sage modified at 13:07:17 ###
res()
(0, 2, 4, 6, 8, 10, 34) 

-32
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:07:26 ###

sage: res()
(0, 2, 4, 6, 8, 10, c6) 

-1/2*c6 - 15
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:08:53 ###
res()
(0, 2, 4, 6, 8, 10, -34) 

2
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:11:18 ###

sage: E7(1,0,0,0,0,0,0).degree()
133
sage: E7(1,0,0,0,0,0,0).branch(A1,b)
A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(34)
sage: E7(0,0,0,0,0,0,1).degree()
56
sage: E7(0,0,0,0,0,0,1).branch(A1,b)
A1(9) + A1(17) + A1(27)
sage: ### reloading attached file a1.sage modified at 13:14:40 ###

sage: 
Exiting Sage (CPU time 0m7.67s, Wall time 20m24.02s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.84361004829 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00581693649292 seconds
Total time spent compiling C/C++ extensions:  0.140131950378 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m4.024s
user	0m2.933s
sys	0m0.694s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: [G2(f).branch(A1,"a1") for f in G2.fundamental_weights()]
A1(6)
sage: G2(0,1).branch(A1,"a1")
A1(2) + A1(10)
sage: F4(1,0,0,0).branch(A1,"a1")
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-78d5eda3ed1b> in <module>()
----> 1 F4(Integer(1),Integer(0),Integer(0),Integer(0)).branch(A1,"a1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2249                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2250             else:
-> 2251                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2252         else:
   2253             h = S._space(rule(list(k.to_vector())))

TypeError: 'NoneType' object is not callable
sage: 
Exiting Sage (CPU time 0m6.20s, Wall time 3m11.19s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.52340483665 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00498580932617 seconds
Total time spent compiling C/C++ extensions:  0.135054826736 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.705s
user	0m2.934s
sys	0m0.682s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: [G2(f).branch(A1,"a1") for f in G2.fundamental_weights()]
[A1(6), A1(2) + A1(10)]
sage: [F4(f).branch(A1,"a1") for f in F4.fundamental_weights()]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-3b40abc05e69> in <module>()
----> 1 [F4(f).branch(A1,"a1") for f in F4.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2249                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2250             else:
-> 2251                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2252         else:
   2253             h = S._space(rule(list(k.to_vector())))

TypeError: 'NoneType' object is not callable
sage: F4
The Weyl Character Ring of Type F4 with Integer Ring coefficients
sage: A1
The Weyl Character Ring of Type A1 with Integer Ring coefficients
sage: 
Exiting Sage (CPU time 0m6.04s, Wall time 1m10.15s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.53912806511 seconds)
running install
running build
running build_py
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00449395179749 seconds
Total time spent compiling C/C++ extensions:  0.140564203262 seconds.
running install_lib
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.720s
user	0m2.934s
sys	0m0.675s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: [G2(f).branch(A1,"a1") for f in G2.fundamental_weights()]
[A1(6), A1(2) + A1(10)]
sage: [F4(f).branch(A1,"a1") for f in F4.fundamental_weights()]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-3b40abc05e69> in <module>()
----> 1 [F4(f).branch(A1,"a1") for f in F4.fundamental_weights()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2249                     h = S._space(rule(list(k.to_vector()))).coerce_to_e7()
   2250             else:
-> 2251                 h = (S._space(rule(list(k.to_vector())))).coerce_to_sl()
   2252         else:
   2253             h = S._space(rule(list(k.to_vector())))

TypeError: 'NoneType' object is not callable
sage: b = branching_rule("F4","A1","a1")
sage: b
sage: 
Exiting Sage (CPU time 0m6.19s, Wall time 1m53.21s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.5255150795 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00390005111694 seconds
Total time spent compiling C/C++ extensions:  0.132377147675 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.721s
user	0m2.954s
sys	0m0.679s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: [G2(f).branch(A1,"a1") for f in G2.fundamental_weights()]
[A1(6), A1(2) + A1(10)]
sage: [F4(f).branch(A1,"a1") for f in F4.fundamental_weights()]
[A1(2) + A1(10) + A1(14) + A1(22),
 3*A1(2) + A1(4) + 4*A1(6) + 3*A1(8) + 5*A1(10) + 5*A1(12) + 6*A1(14) + 4*A1(16) + 6*A1(18) + 4*A1(20) + 5*A1(22) + 4*A1(24) + 4*A1(26) + 2*A1(28) + 3*A1(30) + 2*A1(32) + 2*A1(34) + A1(36) + A1(38) + A1(42),
 A1(2) + 2*A1(6) + A1(8) + 2*A1(10) + A1(12) + 2*A1(14) + A1(16) + 2*A1(18) + A1(20) + A1(22) + A1(24) + A1(26) + A1(30),
 A1(8) + A1(16)]
sage: E7(1,0,0,0,0,0,0).branch(A1,"a1")
A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(34)
sage: E7(0,0,0,0,0,0,1).branch(A1,"a1")
A1(9) + A1(17) + A1(27)
sage: ### reloading attached file a1.sage modified at 13:32:37 ###

sage: res()
(c0, c1, c2, c3, c4, c5, c6, c7) 

1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7
c0 + c1
-c0 + c1
-c1 + c2
-c2 + c3
-c3 + c4
-c4 + c5
-c5 + c6
sage: ### reloading attached file a1.sage modified at 13:33:30 ###
res()
(0, 2, c2, c3, c4, c5, c6, c7) 

-1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 - 1
2
2
c2 - 2
-c2 + c3
-c3 + c4
-c4 + c5
-c5 + c6
sage: ### reloading attached file a1.sage modified at 13:34:06 ###
res()
(0, 2, 4, 6, 8, 10, 12, c7) 

1/2*c7 - 21
2
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:34:51 ###
res()
(0, 2, 4, 6, 8, 10, 12, 46) 

2
2
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:35:04 ###
res()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-10-02f34e208de4> in <module>()
----> 1 res()

/Users/bump/.sage/temp/meep2/14656/a1.sageHkbYDC.py in res()
     56     c6 = _sage_const_12
     57     c7 = _sage_const_46
---> 58     print (_sage_const_1 /_sage_const_2 )*(c0,c1,c2,c3,c4,c5,c6,c7), "\n"
     59     def f(x):
     60         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__mul__ (sage/structure/element.c:14533)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8114)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/rational.so in sage.rings.rational.Rational.__index__ (sage/rings/rational.c:6921)()

TypeError: rational is not an integer
sage: ### reloading attached file a1.sage modified at 13:35:17 ###
res()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-11-02f34e208de4> in <module>()
----> 1 res()

/Users/bump/.sage/temp/meep2/14656/a1.sageU0VXi7.py in res()
     56     c6 = _sage_const_12
     57     c7 = _sage_const_46
---> 58     print (c0,c1,c2,c3,c4,c5,c6,c7)/_sage_const_2 , "\n"
     59     def f(x):
     60         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__div__ (sage/structure/element.c:15218)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8169)()

TypeError: unsupported operand parent(s) for '/': '<type 'tuple'>' and 'Integer Ring'
sage: ### reloading attached file a1.sage modified at 13:35:39 ###
res()
(0, 2, 4, 6, 8, 10, 12, 46) 

2
2
2
2
2
2
2
2
sage: ### reloading attached file a1.sage modified at 13:37:33 ###
  File "/Users/bump/.sage/temp/meep2/14656/a1.sageEhz3Pj.py", line 49
    b = BranchingRule(CartanType("E8"), CartanType("A1"), lambda x:[x[_sage_const_1 ]+_sage_const_2 *x[_sage_const_2 ]+_sage_const_3 *x[_sage_const_3 ]+_sage_const_4 *x[_sage_const_4 ]+_sage_const_5 *x[_sage_const_5 ]+_sage_const_6 *x[_sage_const_6 ]+_sage_const_17 *x[_sage_const_7 ],"a1")
                                                                                                                                                                                                                                                                                                 ^
SyntaxError: invalid syntax

### reloading attached file a1.sage modified at 13:41:08 ###
  File "/Users/bump/.sage/temp/meep2/14656/a1.sageF8HwCO.py", line 49
    b1 = BranchingRule(CartanType("E8"), CartanType("A1"), lambda x:[x[_sage_const_1 ]+_sage_const_2 *x[_sage_const_2 ]+_sage_const_3 *x[_sage_const_3 ]+_sage_const_4 *x[_sage_const_4 ]+_sage_const_5 *x[_sage_const_5 ]+_sage_const_6 *x[_sage_const_6 ]+_sage_const_17 *x[_sage_const_7 ],"a1")
                                                                                                                                                                                                                                                                                                  ^
SyntaxError: invalid syntax

### reloading attached file a1.sage modified at 13:42:19 ###

sage: E8(1,0,0,0,0,0,0,0).branch(A1,rule="a1")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-13-55e45c013072> in <module>()
----> 1 E8(Integer(1),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0)).branch(A1,rule="a1")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2235     """
   2236     if type(rule) is str or type(rule) is list:
-> 2237         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2238     if hasattr(rule,"_S"):
   2239         if rule._S != S.cartan_type():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   3007                           lambda x:[x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6],-(x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6])],"a1")
   3008         else:
-> 3009             raise ValueError("Rule not found")
   3010 
   3011 branching_rule = get_branching_rule

ValueError: Rule not found
sage: E8(1,0,0,0,0,0,0,0).branch(A1,rule=b1)
2*A1(0) + 3*A1(4) + A1(6) + 4*A1(8) + 2*A1(10) + 6*A1(12) + 3*A1(14) + 6*A1(16) + 4*A1(18) + 7*A1(20) + 4*A1(22) + 7*A1(24) + 5*A1(26) + 7*A1(28) + 5*A1(30) + 6*A1(32) + 4*A1(34) + 7*A1(36) + 4*A1(38) + 5*A1(40) + 3*A1(42) + 5*A1(44) + 3*A1(46) + 4*A1(48) + 2*A1(50) + 3*A1(52) + 2*A1(54) + 2*A1(56) + A1(58) + 2*A1(60) + A1(62) + A1(64) + A1(68) + A1(72)
sage: res()
(0, 2, 4, 6, 8, 10, 12, 46) 

2
2
2
2
2
2
2
2
sage: [c/2 for c in (0, 2, 4, 6, 8, 10, 12, 46) ]
[0, 1, 2, 3, 4, 5, 6, 23]
sage: ### reloading attached file a1.sage modified at 13:50:21 ###
E8(1,0,0,0,0,0,0,0).branch(A1,rule=b1)
2*A1(0) + 2*A1(4) + 2*A1(8) + 4*A1(12) + 2*A1(14) + 3*A1(16) + A1(18) + 4*A1(20) + 2*A1(22) + 5*A1(24) + 3*A1(26) + 4*A1(28) + 2*A1(30) + 4*A1(32) + 3*A1(34) + 5*A1(36) + 3*A1(38) + 4*A1(40) + 2*A1(42) + 4*A1(44) + 3*A1(46) + 4*A1(48) + 2*A1(50) + 3*A1(52) + 2*A1(54) + 3*A1(56) + 2*A1(58) + 3*A1(60) + A1(62) + 2*A1(64) + A1(66) + 2*A1(68) + A1(70) + 2*A1(72) + A1(76) + A1(78) + A1(80) + A1(84) + A1(92)
sage: res()
(0, 2, 4, 6, 8, 10, 12, 46) 

2
2
2
2
2
2
2
2
sage: b.describe()

            O 2
            |
            |
O---O---O---O---O---O---O
0   1   3   4   5   6   7
E7~
root restrictions E7 => A1:

O
1
A1

1 => 1
2 => 1
3 => 1
4 => 1
5 => 1
6 => 1
7 => 1

For more detailed information use verbose=True
sage: b1.describe()

        O 2
        |
        |
O---O---O---O---O---O---O---O
1   3   4   5   6   7   8   0
E8~
root restrictions E8 => A1:

O
1
A1

1 => 1
2 => 1
3 => 1
4 => 1
5 => 1
6 => 1
7 => 1
8 => 1

For more detailed information use verbose=True
sage: E8(1,0).degree()
3875
sage: E8(0,1).degree()
147250
sage: E8(0,0,0,0,0,0,0,1).degree()
248
sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule=b1)
A1(2) + A1(14) + A1(22) + A1(26) + A1(34) + A1(38) + A1(46) + A1(58)
sage: ### reloading attached file a1.sage modified at 14:29:25 ###

sage: res7
<function __main__.res7>
sage: res7()
(c0, c1, c2, c3, c4, c5, c6, c7) 

1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6
c0 + c1
-c0 + c1
-c1 + c2
-c2 + c3
-c3 + c4
-c4 + c5
sage: E7.dynkin_diagram()
        O 2
        |
        |
O---O---O---O---O---O
1   3   4   5   6   7
E7
sage: ### reloading attached file a1.sage modified at 14:32:46 ###
res7()
(c0, c1, c2, c3, c4, c5, c6, c7) 

1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 = 2
c0 + c1 = 2
-c0 + c1 = 2
-c1 + c2 = 0
-c2 + c3 = 2
-c3 + c4 = 2
-c4 + c5 = 2
sage: ### reloading attached file a1.sage modified at 14:34:40 ###
res7()
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
<ipython-input-29-f4315da5c611> in <module>()
----> 1 res7()

/Users/bump/.sage/temp/meep2/14656/a1.sagexelZ5P.py in res7()
     50 
     51 def res7():
---> 52     print (c0,c1,c2,c3,c4,c5,c6,c7), "\n"
     53     c0 = _sage_const_0
     54     c1 = _sage_const_2

UnboundLocalError: local variable 'c0' referenced before assignment
sage: ### reloading attached file a1.sage modified at 14:34:57 ###
res7()
(0, 2, 2, c3, c4, c5, c6, c7) 

-1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 - 2 = 2
2 = 2
2 = 2
0 = 0
c3 - 2 = 2
-c3 + c4 = 2
-c4 + c5 = 2
sage: ### reloading attached file a1.sage modified at 14:35:34 ###
res7()
(0, 2, 2, 4, 6, 8, c6, c7) 

-1/2*c6 - 11 = 2
2 = 2
2 = 2
0 = 0
2 = 2
2 = 2
2 = 2
sage: ### reloading attached file a1.sage modified at 14:35:55 ###
res7()
(0, 2, 2, 4, 6, 8, -26, c7) 

2 = 2
2 = 2
2 = 2
0 = 0
2 = 2
2 = 2
2 = 2
sage: ### reloading attached file a1.sage modified at 14:36:13 ###

sage: E7.dynkin_diagram()
        O 2
        |
        |
O---O---O---O---O---O
1   3   4   5   6   7
E7
sage: ### reloading attached file a1.sage modified at 14:41:16 ###

sage: resvi()
(c0, c1, c2, c3, c4, c5, c6, c7) 

1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 = 2
c0 + c1 = 2
-c0 + c1 = 2
-c1 + c2 = 0
-c2 + c3 = 2
-c3 + c4 = 2
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 14:42:24 ###
resvi()
(0, 2, c2, c3, c4, c5, c6, c7) 

-1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 - 1 = 2
2 = 2
2 = 2
c2 - 2 = 0
-c2 + c3 = 2
-c3 + c4 = 2
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 14:42:46 ###
resvi()
(0, 2, 4, 4, c4, c5, c6, c7) 

-1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 - 5 = 2
2 = 2
2 = 2
2 = 0
0 = 2
c4 - 4 = 2
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 14:42:56 ###
resvi()
(0, 2, 2, 4, c4, c5, c6, c7) 

-1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 - 4 = 2
2 = 2
2 = 2
0 = 0
2 = 2
c4 - 4 = 2
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 14:43:24 ###
resvi()
(0, 2, 2, 4, 6, 8, c6, c7) 

-1/2*c6 + 1/2*c7 - 11 = 2
2 = 2
2 = 2
0 = 0
2 = 2
2 = 2
2 = 2
c6 - 8 = 2
sage: ### reloading attached file a1.sage modified at 14:43:38 ###
resvi()
(0, 2, 2, 4, 6, 8, 10, c7) 

1/2*c7 - 16 = 2
2 = 2
2 = 2
0 = 0
2 = 2
2 = 2
2 = 2
2 = 2
sage: ### reloading attached file a1.sage modified at 14:43:56 ###
resvi()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-40-a79577b5db29> in <module>()
----> 1 resvi()

/Users/bump/.sage/temp/meep2/14656/a1.sagembpvtK.py in resvi()
     70 
     71 def resvi():
---> 72     [c0,c1,c2,c3,c4,c5,c6]=[_sage_const_0 ,_sage_const_2 ,_sage_const_2 ,_sage_const_4 ,_sage_const_6 ,_sage_const_8 ,_sage_const_10 ,_sage_const_36 ]
     73     print (c0,c1,c2,c3,c4,c5,c6,c7), "\n"
     74     def f(x):

ValueError: too many values to unpack
sage: ### reloading attached file a1.sage modified at 14:44:06 ###
resvi()
(0, 2, 2, 4, 6, 8, 10, 36) 

2 = 2
2 = 2
2 = 2
0 = 0
2 = 2
2 = 2
2 = 2
2 = 2
sage: ### reloading attached file a1.sage modified at 14:59:11 ###

sage: resvii()
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
<ipython-input-42-47a1b603e8e8> in <module>()
----> 1 resvii()

/Users/bump/.sage/temp/meep2/14656/a1.sageF1KzWf.py in resvii()
     84 
     85 def resvii():
---> 86     [c0,c1,c2,c3,c4,c5,c6,c7]=[c0,c1,c2,c3,c4,c5,c6,c7]
     87     print (c0,c1,c2,c3,c4,c5,c6,c7), "\n"
     88     def f(x):

UnboundLocalError: local variable 'c0' referenced before assignment
sage: ### reloading attached file a1.sage modified at 15:00:41 ###

sage: resvii()
(c0, c1, c2, c3, c4, c5, c6, c7) 

1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 = 2
c0 + c1 = 2
-c0 + c1 = 2
-c1 + c2 = 0
-c2 + c3 = 2
-c3 + c4 = 0
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 15:01:25 ###
resvii()
(0, 2, 2, 4, c4, c5, c6, c7) 

-1/2*c4 - 1/2*c5 - 1/2*c6 + 1/2*c7 - 4 = 2
2 = 2
2 = 2
0 = 0
2 = 2
c4 - 4 = 0
-c4 + c5 = 2
-c5 + c6 = 2
sage: ### reloading attached file a1.sage modified at 15:01:38 ###
### reloading attached file a1.sage modified at 15:01:49 ###
resvii()
(0, 2, 2, 4, 4, 6, 8, c7) 

1/2*c7 - 13 = 2
2 = 2
2 = 2
0 = 0
2 = 2
0 = 0
2 = 2
2 = 2
sage: ### reloading attached file a1.sage modified at 15:02:03 ###
resvii()
(0, 2, 2, 4, 4, 6, 8, 30) 

2 = 2
2 = 2
2 = 2
0 = 0
2 = 2
0 = 0
2 = 2
2 = 2
sage: 
Exiting Sage (CPU time 0m19.74s, Wall time 100m15.50s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.97095704079 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00421094894409 seconds
Total time spent compiling C/C++ extensions:  0.136203050613 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m4.856s
user	0m2.969s
sys	0m0.723s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A1=WeylCharacterRing("A1",style="coroots")
sage: G2=WeylCharacterRing("G1",style="coroots")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-1aacb20f969b> in <module>()
----> 1 G2=WeylCharacterRing("G1",style="coroots")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:1224)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __classcall__(cls, ct, base_ring, prefix, style)
    102             True
    103         """
--> 104         ct = CartanType(ct)
    105         if prefix == None:
    106             if ct.is_atomic():

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in __call__(self, *args)
    554                 return CartanType(t[:-1]).affine()
    555             else:
--> 556                 return CartanType([t[0], eval(t[1:])])
    557 
    558         t = list(t)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in __call__(self, *args)
    651                     if letter == "E" and t[2] == 2 and n == 6:
    652                         return CartanType(["F", 4, 1]).dual()
--> 653             raise ValueError("%s is not a valid cartan type"%t)
    654         import type_reducible
    655         return type_reducible.CartanType([ CartanType(subtype) for subtype in t ])

ValueError: ['G', 1] is not a valid cartan type
sage: A1=WeylCharacterRing("A1",style="coroots")
sage: G2=WeylCharacterRing("G2",style="coroots")
sage: F4=WeylCharacterRing("F4",style="coroots")
sage: E7=WeylCharacterRing("E7",style="coroots")
sage: E8=WeylCharacterRing("E8",style="coroots")
sage: [G2(f).branch(A1,rule="i") for f in G2.fundamental_weights()]
[A1(6), A1(2) + A1(10)]
sage: F4(1,0,0,0).branch(A1,rule="ii")
A1(2) + A1(10) + A1(14) + A1(22)
sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iii")
A1(9) + A1(17) + A1(27)
sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iv")
A1(5) + A1(11) + A1(15) + A1(21)
sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="v")
A1(2) + A1(14) + A1(22) + A1(26) + A1(34) + A1(38) + A1(46) + A1(58)
sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vi")
A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(28) + A1(34) + A1(38) + A1(46)
sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vii")
A1(2) + A1(6) + A1(10) + A1(14) + A1(16) + A1(18) + 2*A1(22) + A1(26) + A1(28) + A1(34) + A1(38)
sage: 
sage: 
Exiting Sage (CPU time 0m5.72s, Wall time 12m44.40s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.55968499184 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00399708747864 seconds
Total time spent compiling C/C++ extensions:  0.142205953598 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.757s
user	0m2.989s
sys	0m0.698s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-26-07-29-27-abd138e9.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [473 tests, 25.24 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 25.4 seconds
    cpu time: 24.8 seconds
    cumulative wall time: 25.2 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage:         sage: A1=WeylCharacterRing("A1",style="coroots")
        sage: G2=WeylCharacterRing("G2",style="coroots")
        sage: F4=WeylCharacterRing("F4",style="coroots")
        sage: E7=WeylCharacterRing("E7",style="coroots")
        sage: E8=WeylCharacterRing("E8",style="coroots")

sage: sage: sage: sage: sage: sage: time [G2(f).branch(A1,rule="i") for f in G2.fundamental_weights()]
/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.py:371: DeprecationWarning: Use %time instead of time.
See http://trac.sagemath.org/12719 for details.
  line = f(line, line_number)
CPU times: user 0.02 s, sys: 0.00 s, total: 0.02 s
Wall time: 0.02 s
[A1(6), A1(2) + A1(10)]
sage: time F4(1,0,0,0).branch(A1,rule="ii")
CPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s
Wall time: 0.04 s
A1(2) + A1(10) + A1(14) + A1(22)
sage: time E7(0,0,0,0,0,0,1).branch(A1,rule="iii")
CPU times: user 0.13 s, sys: 0.01 s, total: 0.14 s
Wall time: 0.13 s
A1(9) + A1(17) + A1(27)
sage: time E8(0,0,0,0,0,0,0,1).branch(A1,rule="v")
CPU times: user 0.56 s, sys: 0.05 s, total: 0.61 s
Wall time: 0.58 s
A1(2) + A1(14) + A1(22) + A1(26) + A1(34) + A1(38) + A1(46) + A1(58)
sage: time E8(0,0,0,0,0,0,0,1).branch(A1,rule="vi")
CPU times: user 0.10 s, sys: 0.01 s, total: 0.11 s
Wall time: 0.10 s
A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(28) + A1(34) + A1(38) + A1(46)
sage: time E8(0,0,0,0,0,0,0,1).branch(A1,rule="vii")
CPU times: user 0.09 s, sys: 0.01 s, total: 0.09 s
Wall time: 0.09 s
A1(2) + A1(6) + A1(10) + A1(14) + A1(16) + A1(18) + 2*A1(22) + A1(26) + A1(28) + A1(34) + A1(38)
sage: branching_rule("G2","A1","i")
i branching rule G2 => A1
sage: branching_rule("G2","A1","i").describe()

  3
O=<=O---O
1   2   0
G2~
root restrictions G2 => A1:

O
1
A1

1 => 1
2 => 1

For more detailed information use verbose=True
sage: branching_rule("F2","A1","ii")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-14-0d112d4c6ac8> in <module>()
----> 1 branching_rule("F2","A1","ii")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   2509        [[1, 0], [1, 1], [1, 0]]
   2510     """
-> 2511     Rtype=CartanType(Rtype)
   2512     Stype=CartanType(Stype)
   2513     r = Rtype.rank()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in __call__(self, *args)
    554                 return CartanType(t[:-1]).affine()
    555             else:
--> 556                 return CartanType([t[0], eval(t[1:])])
    557 
    558         t = list(t)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/cartan_type.pyc in __call__(self, *args)
    651                     if letter == "E" and t[2] == 2 and n == 6:
    652                         return CartanType(["F", 4, 1]).dual()
--> 653             raise ValueError("%s is not a valid cartan type"%t)
    654         import type_reducible
    655         return type_reducible.CartanType([ CartanType(subtype) for subtype in t ])

ValueError: ['F', 2] is not a valid cartan type
sage: branching_rule("F4","A1","ii")
ii branching rule F4 => A1
sage: branching_rule("E7","A1","iii")
iii branching rule E7 => A1
sage: branching_rule("E7","A1","iv")
iv branching rule E7 => A1
sage: branching_rule("E8","A1","v")
v branching rule E8 => A1
sage: branching_rule("E8","A1","vi")
vi branching rule E8 => A1
sage: branching_rule("E8","A1","vii")
vii branching rule E8 => A1
sage: branching_rule("E8","A1","vii").describe()

        O 2
        |
        |
O---O---O---O---O---O---O---O
1   3   4   5   6   7   8   0
E8~
root restrictions E8 => A1:

O
1
A1

1 => 1
2 => 1
3 => 1
5 => 1
7 => 1
8 => 1

For more detailed information use verbose=True
sage: 
Exiting Sage (CPU time 0m5.80s, Wall time 16m28.55s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.56454515457 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0041241645813 seconds
Total time spent compiling C/C++ extensions:  0.134126901627 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.749s
user	0m2.973s
sys	0m0.686s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-26-07-57-15-6199a758.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [473 tests, 25.22 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 25.4 seconds
    cpu time: 24.9 seconds
    cumulative wall time: 25.2 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: branching_rule("G2","A2","i")
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-1-ad57f0696e93> in <module>()
----> 1 branching_rule("G2","A2","i")

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in get_branching_rule(Rtype, Stype, rule)
   3016     elif rule in ["i","ii","iii","iv","v","vi","vii"]:
   3017         if Stype != CartanType("A1"):
-> 3018             raise ValueError("Wrong target Cartan Type for rule %s"%rule)
   3019         if rule == "i" and Rtype == CartanType("G2"):
   3020             return BranchingRule(Rtype, Stype, lambda x : [(5*x[0]-x[1]-4*x[2])/3,-(5*x[0]-x[1]-4*x[2])/3], "i")

ValueError: Wrong target Cartan Type for rule i
sage: branching_rule("G2","A1","i")
i branching rule G2 => A1
sage: branching_rule("F4","A1","ii")
ii branching rule F4 => A1
sage: branching_rule("E7","A1","iii")
iii branching rule E7 => A1
sage: branching_rule("E7","A1","iv")
iv branching rule E7 => A1
sage: branching_rule("E8","A1","v")
v branching rule E8 => A1
sage: branching_rule("E8","A1","vi")
vi branching rule E8 => A1
sage: branching_rule("E8","A1","vii")
vii branching rule E8 => A1
sage: branching_rule("E8","A1","vii").describe()

        O 2
        |
        |
O---O---O---O---O---O---O---O
1   3   4   5   6   7   8   0
E8~
root restrictions E8 => A1:

O
1
A1

1 => 1
2 => 1
3 => 1
4 => (zero)
5 => 1
6 => (zero)
7 => 1
8 => 1

For more detailed information use verbose=True
sage: 
Exiting Sage (CPU time 0m0.93s, Wall time 19m30.35s).
~/sagemath/sage/src/sage/combinat/root_system:$ pushd ~/sagemath/sage/src/doc/en/thematic_tutorials/lie/
~/sagemath/sage/src/doc/en/thematic_tutorials/lie ~/sagemath/sage/src/sage/combinat/root_system
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ sage -t --long branching_rules.rst 
Running doctests with ID 2013-12-26-08-25-14-d7aa8b55.
Doctesting 1 file.
sage -t --long branching_rules.rst
**********************************************************************
File "branching_rules.rst", line 454, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    b.describe()
Expected:
    <BLANKLINE>
            O 0
            |
            |
            O 2
            |
            |
    O---O---O---O---O
    1   3   4   5   6
    E6~
    root restrictions E6 => A5:
    <BLANKLINE>
    O---O---O---O---O
    1   2   3   4   5
    A5
    <BLANKLINE>
    1 => 1
    3 => 2
    4 => 3
    5 => 4
    6 => 5
    <BLANKLINE>
    For more detailed information use verbose=True
Got:
    <BLANKLINE>
            O 0
            |
            |
            O 2
            |
            |
    O---O---O---O---O
    1   3   4   5   6
    E6~
    root restrictions E6 => A5:
    <BLANKLINE>
    O---O---O---O---O
    1   2   3   4   5
    A5
    <BLANKLINE>
    0 => (zero)
    1 => 1
    3 => 2
    4 => 3
    5 => 4
    6 => 5
    <BLANKLINE>
    For more detailed information use verbose=True
**********************************************************************
File "branching_rules.rst", line 867, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[92]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 869, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[93]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 871, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[94]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 877, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[95]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 879, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,1,0).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[96]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(1),Integer(0)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
1 item had failures:
   6 of  98 in doc.en.thematic_tutorials.lie.branching_rules
    [97 tests, 6 failures, 6.61 s]
----------------------------------------------------------------------
sage -t --long branching_rules.rst  # 6 doctests failed
----------------------------------------------------------------------
Total time for all tests: 7.1 seconds
    cpu time: 6.4 seconds
    cumulative wall time: 6.6 seconds
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ sage -t branching_rules.rst 
Running doctests with ID 2013-12-26-08-28-46-edf5f8ab.
Doctesting 1 file.
sage -t branching_rules.rst
**********************************************************************
File "branching_rules.rst", line 454, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    b.describe()
Expected:
    <BLANKLINE>
            O 0
            |
            |
            O 2
            |
            |
    O---O---O---O---O
    1   3   4   5   6
    E6~
    root restrictions E6 => A5:
    <BLANKLINE>
    O---O---O---O---O
    1   2   3   4   5
    A5
    <BLANKLINE>
    1 => 1
    3 => 2
    4 => 3
    5 => 4
    6 => 5
    <BLANKLINE>
    For more detailed information use verbose=True
Got:
    <BLANKLINE>
            O 0
            |
            |
            O 2
            |
            |
    O---O---O---O---O
    1   3   4   5   6
    E6~
    root restrictions E6 => A5:
    <BLANKLINE>
    O---O---O---O---O
    1   2   3   4   5
    A5
    <BLANKLINE>
    0 => (zero)
    1 => 1
    3 => 2
    4 => 3
    5 => 4
    6 => 5
    <BLANKLINE>
    For more detailed information use verbose=True
**********************************************************************
File "branching_rules.rst", line 867, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[91]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 869, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[92]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 871, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[93]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 877, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[94]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 879, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,1,0).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[95]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(1),Integer(0)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
1 item had failures:
   6 of  97 in doc.en.thematic_tutorials.lie.branching_rules
    [96 tests, 6 failures, 5.07 s]
----------------------------------------------------------------------
sage -t branching_rules.rst  # 6 doctests failed
----------------------------------------------------------------------
Total time for all tests: 5.6 seconds
    cpu time: 4.9 seconds
    cumulative wall time: 5.1 seconds
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ sage -t branching_rules.rst 
Running doctests with ID 2013-12-26-08-30-39-9652b172.
Doctesting 1 file.
sage -t branching_rules.rst
**********************************************************************
File "branching_rules.rst", line 868, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[91]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 870, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[92]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 872, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[93]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="triality").branch(D4,rule="triality").branch(D4,rule="triality")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 878, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,0,1).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[94]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(0),Integer(1)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
File "branching_rules.rst", line 880, in doc.en.thematic_tutorials.lie.branching_rules
Failed example:
    D4(0,0,1,0).branch(D4,rule="automorphic")
Exception raised:
    Traceback (most recent call last):
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest doc.en.thematic_tutorials.lie.branching_rules[95]>", line 1, in <module>
        D4(Integer(0),Integer(0),Integer(1),Integer(0)).branch(D4,rule="automorphic")
    NameError: name 'D4' is not defined
**********************************************************************
1 item had failures:
   5 of  97 in doc.en.thematic_tutorials.lie.branching_rules
    [96 tests, 5 failures, 5.26 s]
----------------------------------------------------------------------
sage -t branching_rules.rst  # 5 doctests failed
----------------------------------------------------------------------
Total time for all tests: 5.8 seconds
    cpu time: 4.9 seconds
    cumulative wall time: 5.3 seconds
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/bibliography.rst b/src/doc/en/thematic_tutorials/lie/bibliography.rst
index b7b576b..42c0673 100644
--- a/src/doc/en/thematic_tutorials/lie/bibliography.rst
+++ b/src/doc/en/thematic_tutorials/lie/bibliography.rst
@@ -18,6 +18,10 @@ Bibliography
 .. [Dyer1993] M. J. Dyer. The nil Hecke ring and Deodhar's conjecture
    on Bruhat intervals. Inventiones Mathematicae, 111(1):571--574, 1993.
 
+.. [Dynkin1952] E. B. Dynkin,
+   Semisimple subalgebras of semisimple Lie algebras. (Russian) 
+   Mat. Sbornik N.S. 30(72):349–462, 1952.
+
 .. [FauserEtAl2006] B. Fauser, P. D. Jarvis, R. C. King, and
    B. G. Wybourne. New branching rules induced by plethysm. *Journal of
    Physics A*. 39(11):2611--2655, 2006.
@@ -94,6 +98,10 @@ Bibliography
    Kirillov--Reshetikhin crystals for nonexceptional types.
    *Representation Theory* 12:186--207, 2008.
 
+.. [Seitz1991] G. Seitz,
+   Maximal subgroups of exceptional algebraic groups. 
+   Mem. Amer. Math. Soc. 90 (1991), no. 441.
+
 .. [Rubenthaler2008] H. Rubenthaler, 
    The (A2,G2) duality in E6, octonions and the triality principle.
    Trans. Amer. Math. Soc. 360 (2008), no. 1, 347–367 
@@ -105,3 +113,5 @@ Bibliography
 .. [Stanley1999] R. P. Stanley. *Enumerative Combinatorics, Volume
    2*. Cambridge University Press, 1999.
 
+.. [Testerman1992] Testerman, Donna M. The construction of the maximal A1's in
+   the exceptional algebraic groups. Proc. Amer. Math. Soc. 116 (1992), no. 3, 635–644.
\ No newline at end of file
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index fd10f2b..f91a7d6 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -30,6 +30,7 @@ so not by memorizing a combinatorial rule, but by computing the
 character and restricting the character to a maximal torus of `H`.
 What Sage has memorized (in a series of built-in encoded rules)
 are the various embeddings of maximal tori of maximal subgroups of `G`.
+The maximal subgroups of Lie groups were determined in [Dynkin1952]_.
 This approach to computing branching rules has a limitation: the
 character must fit into memory and be computable by Sage's
 internal code in real time.
@@ -266,7 +267,6 @@ two accidental isomorphisms ``C2=B2`` and ``D2=A1xA1``. It is much
 easier to go in one step using ``rule="levi"``, but reassuring that we
 get the same answer!
 
-
 Subgroups classified by the extended Dynkin diagram
 ---------------------------------------------------
 
@@ -300,6 +300,21 @@ For embeddings of this type, the rank of the subgroup `H` is the same
 as the rank of `G`. This is in contrast with embeddings of Levi type,
 where `H` has rank one less than `G`.
 
+Levi subgroups of `G_2`
+-----------------------
+
+The exceptional group `G_2` has two Levi subgroups of type
+`A_1`. Neither is maximal, as we can see from the extended
+Dynkin diagram: the subgroups `A_1\times A_1` and `A_2`
+are maximal and each contains a Levi subgroup. (Actually
+`A_1\times A_1` contains a conjugate of both.) Only
+the Levi subgroup containing the short root is implemented
+as an instance of ``rule="levi"``. To obtain the other,
+use the rule
+
+     branching_rule("G2","A2","extended")*branching_rule("A2","A1","levi")
+
+which branches to the `A_1` Levi subgroup containing a long root.
 
 Orthogonal and symplectic subgroups of orthogonal and symplectic groups
 -----------------------------------------------------------------------
@@ -430,36 +445,37 @@ Dynkin diagram (see below) gives ``A5xA1``. To
 construct the branching rule to `A_5` we may proceed
 as follows::
 
-   sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
-   composite branching rule E6 => (extended) A5xA1 => (proj1) A5
-   sage: E6=WeylCharacterRing("E6",style="coroots")
-   sage: A5=WeylCharacterRing("A5",style="coroots")
-   sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
-   3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
-   sage: b.describe()
-   <BLANKLINE>
-           O 0
-           |
-           |
-           O 2
-           |
-           |
-   O---O---O---O---O
-   1   3   4   5   6
-   E6~
-   root restrictions E6 => A5:
-   <BLANKLINE>
-   O---O---O---O---O
-   1   2   3   4   5
-   A5
-   <BLANKLINE>
-   1 => 1
-   3 => 2
-   4 => 3
-   5 => 4
-   6 => 5
-   <BLANKLINE>
-   For more detailed information use verbose=True
+    sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
+    composite branching rule E6 => (extended) A5xA1 => (proj1) A5
+    sage: E6=WeylCharacterRing("E6",style="coroots")
+    sage: A5=WeylCharacterRing("A5",style="coroots")
+    sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
+    3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
+    sage: b.describe()
+    <BLANKLINE>
+            O 0
+            |
+            |
+            O 2
+            |
+            |
+    O---O---O---O---O
+    1   3   4   5   6
+    E6~
+    root restrictions E6 => A5:
+    <BLANKLINE>
+    O---O---O---O---O
+    1   2   3   4   5
+    A5
+    <BLANKLINE>
+    0 => (zero)
+    1 => 1
+    3 => 2
+    4 => 3
+    5 => 4
+    6 => 5
+    <BLANKLINE>
+    For more detailed information use verbose=True
 
 Note that it is not necessary to construct the WeylCharacterRing
 for the intermediate group ``A5xA1``.
@@ -640,15 +656,90 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
 The first rule corresponds to the embedding of ``G_2`` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The remaining rules come about as follows. Let `G` be
+`F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
+or else (if `G=E_7`) `F_4`. We embed `H` into `G`
+in the most obvious way; that is, in the chain
+of subgroups
+
+    .. MATH::
+
+       G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
+
+
+
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
 
+Maximal A1 subgroups of Exceptional Groups
+------------------------------------------
+
+There are seven embeddings of `SL(2)` into an exceptional
+group as a maximal subgroup: one each for `G_2` and `F_4`,
+two nonconjugate embeddings for `E_7` and three for `E_8`
+These are constructed in [Testerman1992]_. Create the
+corresponding branching rules as follows. The names of
+the rules are roman numerals referring to the seven
+cases of Testerman's Theorem 1::
+
+       sage: branching_rule("G2","A1","i")
+       i branching rule G2 => A1
+       sage: branching_rule("F4","A1","ii")
+       ii branching rule F4 => A1
+       sage: branching_rule("E7","A1","iii")
+       iii branching rule E7 => A1
+       sage: branching_rule("E7","A1","iv")
+       iv branching rule E7 => A1
+       sage: branching_rule("E8","A1","v")
+       v branching rule E8 => A1
+       sage: branching_rule("E8","A1","vi")
+       vi branching rule E8 => A1
+       sage: branching_rule("E8","A1","vii")
+       vii branching rule E8 => A1
+
+The embeddings are characterized by the root
+restrictions in their branching rules: usually
+a simple root of the ambient group `G` restricts
+to the unique simple root of `A_1`, except for
+root `\alpha_4` for rules iv, vi and vii,
+and the root `\alpha_6` for root vii; this is
+essentially the way Testerman characterizes
+the embeddings, and this information may
+be obtained from Sage by employing the 
+``describe()`` method of the branching rule.
+Thus::
+
+       sage: branching_rule("E8","A1","vii").describe()
+       <BLANKLINE>
+               O 2
+               |
+               |
+       O---O---O---O---O---O---O---O
+       1   3   4   5   6   7   8   0
+       E8~
+       root restrictions E8 => A1:
+       <BLANKLINE>
+       O
+       1
+       A1
+       <BLANKLINE>       
+       1 => 1
+       2 => 1
+       3 => 1
+       4 => (zero)
+       5 => 1
+       6 => (zero)
+       7 => 1
+       8 => 1
+       <BLANKLINE>       
+       For more detailed information use verbose=True
 
 Writing your own branching rules
 --------------------------------
@@ -659,16 +750,17 @@ cannot be created by using the tools you already have, all
 of which are related to the exceptional groups. Of all the
 branching rules listed in [McKayPatera1981]_ the only ones
 that are not implemented or constructible by plethysms
-are given by the following table. (The information given
-in this table is of course not sufficent to describe the embedding.)
-Some of these may eventually be implemented.
+are given by the following table. The information given
+in this table is not intended to suffice to describe the embedding.
+See [Dynkin1952]_ or [Seitz1991]_ for descriptions of these
+subgroups. We hope that all of these may eventually be implemented.
 
     .. MATH::
 
       \begin{aligned}
       E_6 & \to C_4, A_2, G_2
-      \\ E_7 &\to A_2,  A_1, A_1, A_1\times F_4, A_1\times G_2, A_1\times A_1
-      \\ E_8 & \to C_7 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
+      \\ E_7 &\to A_2,  A_1, A_1, A_1\times A_1
+      \\ E_8 & \to C_2 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
       \\ F_4 & \to A_1
       \end{aligned}
 
@@ -773,6 +865,7 @@ representation of `SO(8)` and the two
 eight-dimensional spin representations. These are
 permuted by triality::
 
+    sage: D4=WeylCharacterRing("D4",style="coroots")
     sage: D4(0,0,0,1).branch(D4,rule="triality")
     D4(1,0,0,0)
     sage: D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..e5ab7fa 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1703,21 +1703,38 @@ def branch_weyl_character(chi, R, S, rule="default"):
 
     Related to the automorphic type, when `G` admits
     an outer automorphism (usually of degree 2) we may consider
-    the branching rule to the isotropy subgroup `H`. In many cases
-    the Dynkin diagram of `H` can be obtained by folding the Dynkin
-    diagram of `G`. For such isotropy subgroups use ``rule="symmetric"``.
-    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
-    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+    the branching rule to the isotropy subgroup `H`. Outer
+    automorphisms correspond to symmetries of the Dynkin diagram.
+    For such isotropy subgroups use ``rule="symmetric"``.
+    We may thus obtain the following branching rules.
 
     .. MATH::
 
-        A_{2r+1} & \to B_r
-        \\ A_{2r} & \to C_r
-        \\ A_{2r} & \to D_r
+        A_{2r} & \to B_r
+        \\ A_{2r-1} & \to C_r
+        \\ A_{2r-1} & \to D_r
         \\ D_r & \to B_{r-1}
         \\ E_6 & \to F_4
+        \\ E_6 & \to C_4
         \\ D_4 & \to G_2
 
+    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
+    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+
+    In some cases, two outer automorphisms that differ by an
+    inner automorphism may have different fixed subgroups.
+    Thus, while the Dynkin diagram of `E_6` has a single
+    involutory automorphism, there are two involutions
+    of the group (differing by an inner automorphism) with
+    fixed subgroups `F_4` and `C_4`. Similarly
+    `SL(2r)`, of Cartan type `A_{2r-1}`, has subgroups
+    `SO(2r)` and `Sp(2r)`, both fixed subgroups of outer
+    automorphisms that differ from each other by an inner
+    automorphism.
+
+    In many cases the Dynkin diagram of `H` can be obtained by
+    folding the Dynkin diagram of `G`.
+
     EXAMPLES::
 
         sage: [w.branch(B2,rule="symmetric") for w in [A4(1,0,0,0,0),A4(1,1,0,0,0),A4(1,1,1,0,0),A4(2,0,0,0,0)]]
@@ -1737,6 +1754,12 @@ def branch_weyl_character(chi, R, S, rule="default"):
          F4(1,0,0,0) + 2*F4(0,0,1,0) + F4(1,0,0,1) + F4(0,1,0,0),
          F4(0,0,0,1) + F4(1,0,0,0) + F4(0,0,1,0),
          F4(0,0,0,0) + F4(0,0,0,1)]
+        sage: E6=WeylCharacterRing("E6",style="coroots")
+        sage: C4=WeylCharacterRing("C4",style="coroots")
+        sage: chi = E6(1,0,0,0,0,0); chi.degree()
+        27
+        sage: chi.branch(C4,rule="symmetric")
+        C4(0,1,0,0)
 
     .. RUBRIC:: Extended Type
 
@@ -1954,6 +1977,7 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
@@ -1975,11 +1999,47 @@ def branch_weyl_character(chi, R, S, rule="default"):
         sage: G2xC3=WeylCharacterRing("G2xC3",style="coroots")
         sage: E7(0,1,0,0,0,0,0).branch(G2xC3,rule="miscellaneous") # long time (1.84s)
         G2xC3(1,0,1,0,0) + G2xC3(1,0,1,1,0) + G2xC3(0,1,0,0,1) + G2xC3(2,0,1,0,0) + G2xC3(0,0,1,1,0)
+        sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
+        sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
+        F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
         sage: E8 = WeylCharacterRing("E8",style="coroots")
         sage: G2xF4 = WeylCharacterRing("G2xF4",style="coroots")
         sage: E8(0,0,0,0,0,0,0,1).branch(G2xF4,rule="miscellaneous") # long time (0.76s)
         G2xF4(1,0,0,0,0,1) + G2xF4(0,1,0,0,0,0) + G2xF4(0,0,1,0,0,0)
 
+    .. RUBRIC:: A1 maximal subgroups of exceptional groups
+
+    There are seven cases where the exceptional group `G_2`, `F_4`,
+    `E_7` or `E_8` contains a maximal subgroup of type `A_1`.
+    These are tabulated in Theorem 1 of Testerman,
+    The construction of the maximal A1's in the exceptional algebraic groups,
+    Proc. Amer. Math. Soc. 116 (1992), no. 3, 635–644. The
+    names of these branching rules are roman numerals referring
+    to the seven cases of her Theorem 1. Use these branching
+    rules as in the following examples.
+
+    EXAMPLES::
+
+        sage: A1=WeylCharacterRing("A1",style="coroots")
+        sage: G2=WeylCharacterRing("G2",style="coroots")
+        sage: F4=WeylCharacterRing("F4",style="coroots")
+        sage: E7=WeylCharacterRing("E7",style="coroots")
+        sage: E8=WeylCharacterRing("E8",style="coroots")
+        sage: [G2(f).branch(A1,rule="i") for f in G2.fundamental_weights()]
+        [A1(6), A1(2) + A1(10)]
+        sage: F4(1,0,0,0).branch(A1,rule="ii")
+        A1(2) + A1(10) + A1(14) + A1(22)
+        sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iii")
+        A1(9) + A1(17) + A1(27)
+        sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iv")
+        A1(5) + A1(11) + A1(15) + A1(21)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="v") # long time (0.6s)
+        A1(2) + A1(14) + A1(22) + A1(26) + A1(34) + A1(38) + A1(46) + A1(58)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vi") # long time (0.6s)
+        A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(28) + A1(34) + A1(38) + A1(46)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vii") # long time (0.6s)
+        A1(2) + A1(6) + A1(10) + A1(14) + A1(16) + A1(18) + 2*A1(22) + A1(26) + A1(28) + A1(34) + A1(38)
+
     .. RUBRIC:: Branching Rules From Plethysms
 
     Nearly all branching rules `G \to H` where `G` is of type `A`, `B`, `C`
@@ -2285,6 +2345,41 @@ class BranchingRule(SageObject):
         except:
             return self._f(x.to_vector())
 
+    def __cmp__(self, other):
+        """
+        Two branching rules with the same source and target Cartan types are
+        considered equal if they have the same effect on the fundamental
+        representations.
+
+        EXAMPLES::
+
+            sage: b = branching_rule("E6","F4","symmetric")*branching_rule("F4","B3","levi")*branching_rule("B3","G2","miscellaneous"); b
+            composite branching rule E6 => (symmetric) F4 => (levi) B3 => (miscellaneous) G2
+            sage: c = branching_rule("E6", "G2xA2", "miscellaneous")*branching_rule("G2xA2", "G2", "proj1"); c
+            composite branching rule E6 => (miscellaneous) G2xA2 => (proj1) G2
+            sage: b == c
+            True
+            sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi"); d
+            composite branching rule A3 => (levi) A2 => (levi) A1
+            sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")*branching_rule("B2","A1","levi"); e
+            composite branching rule A3 => (isomorphic) D3 => (symmetric) B2 => (levi) A1
+            sage: d == e
+            False
+        """
+        Rspace = RootSystem(self._R).ambient_space()
+        Rspace_other = RootSystem(other._R).ambient_space()
+        if Rspace != Rspace_other:
+            return cmp(Rspace, Rspace_other)
+        Sspace = RootSystem(self._S).ambient_space()
+        Sspace_other = RootSystem(other._S).ambient_space()
+        if Sspace != Sspace_other:
+            return cmp(Sspace, Sspace_other)
+        for v in Rspace.fundamental_weights():
+            [a, b] = [Sspace(self(list(v.to_vector()))), Sspace(other(list(v.to_vector())))]
+            if a != b:
+                return cmp(a, b)
+        return 0
+
     def __mul__(self, other):
         """
         EXAMPLES::
@@ -2365,8 +2460,7 @@ class BranchingRule(SageObject):
                 done = False
                 if resr == Sspace.zero():
                     done = True
-                    if verbose:
-                        print "%s => (zero)"%j
+                    print "%s => (zero)"%j
                 else:
                     for s in Sspace.roots():
                         if s == resr:
@@ -2583,10 +2677,15 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                 raise ValueError("Rule not found")
         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")
-        elif Rtype[0] == 'D' and r == 4 and Stype[0] == 'G':
+        elif Rtype == CartanType("D4") and Stype == CartanType("G2"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
-        elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
+        elif Rtype == CartanType("E6") and Stype == CartanType("F4"):
             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
+        elif Rtype == CartanType("E6") and Stype == CartanType("C4"):
+            def f(x):
+                [x0,x1,x2,x3,x4,x5]=x[:6]
+                return [(x0+x1+x2+x3+x4-3*x5)/2, (-x0-x1-x2-x3+x4-3*x5)/2,  -x0+x3,  -x1+x2]
+            return BranchingRule(Rtype, Stype, f, "symmetric")
         else:
             raise ValueError("Rule not found")
     elif rule == "extended" or rule == "orthogonal_sum":
@@ -2761,26 +2860,29 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(x[0]-x[1])/2], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
-                 all(t[0] == 'A' for t in stypes):
-            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
             def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
+            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
@@ -2874,10 +2976,6 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     a = sum((2*r-2*i-1)*x[i] for i in range(r))
                     return [a/2,-a/2]
                 return BranchingRule(Rtype, Stype, rule, "symmetric_power")
-            else:
-                raise ValueError("Rule not found")
-        else:
-            raise ValueError("Rule not found")
     elif rule == "miscellaneous":
         if Rtype[0] == 'B' and Stype[0] == 'G' and r == 3:
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "miscellaneous")
@@ -2887,34 +2985,58 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[5],x[5]+x[4],x[5]-x[4],x[2]+x[3],x[1]-x[2],-x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3],x[1]-x[2],-x[1]-x[3],-2*x[5],x[5]+x[4],x[5]-x[4]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
         elif Rtype == CartanType("E7"):
             if Stype.is_compound():
                 if stypes == [CartanType("C3"),CartanType("G2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[6],x[4]+x[5],-x[4]+x[5],x[1]+x[3],x[2]-x[3],-x[1]-x[2]],"miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("C3")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3],x[2]-x[3],-x[1]-x[2],-2*x[6],x[4]+x[5],-x[4]+x[5]],"miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
+                elif stypes == [CartanType("F4"),CartanType("A1")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2,x5-x6,x6-x5]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
+                elif stypes == [CartanType("A1"),CartanType("F4")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [x5-x6,x6-x5,(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
         elif Rtype == CartanType("E8"):
             if Stype.is_compound():
                 if stypes == [CartanType("F4"),CartanType("G2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[7], x[6], x[5], x[4], x[1]+x[3], -x[3]+x[2], -x[1]-x[2]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("F4")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3], -x[3]+x[2], -x[1]-x[2], x[7], x[6], x[5], x[4]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
         elif Rtype[0] == 'F':
             if Stype.is_compound():
                 if stypes == [CartanType("A1"),CartanType("G2")]:
                     return BranchingRule("F4","A1xG2", lambda x : [ 2*x[0], -2*x[0], x[1]+x[2], -x[2]+x[3], -x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A1")]:
                     return BranchingRule("F4","G2xA1", lambda x : [x[1]+x[2], -x[2]+x[3], -x[1]-x[3], 2*x[0], -2*x[0]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
-        else:
-            raise ValueError("Rule not found")
+    elif rule in ["i","ii","iii","iv","v","vi","vii"]:
+        if Stype != CartanType("A1"):
+            raise ValueError("Wrong target Cartan Type for rule %s"%rule)
+        if rule == "i" and Rtype == CartanType("G2"):
+            return BranchingRule(Rtype, Stype, lambda x : [(5*x[0]-x[1]-4*x[2])/3,-(5*x[0]-x[1]-4*x[2])/3], "i")
+        elif rule == "ii" and Rtype == CartanType("F4"):
+            return BranchingRule(Rtype, Stype, lambda x : [8*x[0]+3*x[1]+2*x[2]+x[3],-(8*x[0]+3*x[1]+2*x[2]+x[3])], "ii")
+        elif rule == "iii" and Rtype == CartanType("E7"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6],-(x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6])],"iii")
+        elif rule == "iv" and Rtype == CartanType("E7"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x: [x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]-13*x[6],-(x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]-13*x[6])],"iv")
+        elif rule == "v" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]+6*x[6]+23*x[7],-(x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]+6*x[6]+23*x[7])],"v")
+        elif rule == "vi" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]+5*x[6]+18*x[7],-(x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]+5*x[6]+18*x[7])],"vi")
+        elif rule == "vii" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+x[2]+2*x[3]+2*x[4]+3*x[5]+4*x[6]+15*x[7],-(x[1]+x[2]+2*x[3]+2*x[4]+3*x[5]+4*x[6]+15*x[7])],"vii")
+        raise ValueError("Wrong source Cartan Type for rule %s"%rule)
+    raise ValueError("Rule not found")
 
 branching_rule = get_branching_rule
 
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ git diff branching_rules.rst 
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index fd10f2b..f91a7d6 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -30,6 +30,7 @@ so not by memorizing a combinatorial rule, but by computing the
 character and restricting the character to a maximal torus of `H`.
 What Sage has memorized (in a series of built-in encoded rules)
 are the various embeddings of maximal tori of maximal subgroups of `G`.
+The maximal subgroups of Lie groups were determined in [Dynkin1952]_.
 This approach to computing branching rules has a limitation: the
 character must fit into memory and be computable by Sage's
 internal code in real time.
@@ -266,7 +267,6 @@ two accidental isomorphisms ``C2=B2`` and ``D2=A1xA1``. It is much
 easier to go in one step using ``rule="levi"``, but reassuring that we
 get the same answer!
 
-
 Subgroups classified by the extended Dynkin diagram
 ---------------------------------------------------
 
@@ -300,6 +300,21 @@ For embeddings of this type, the rank of the subgroup `H` is the same
 as the rank of `G`. This is in contrast with embeddings of Levi type,
 where `H` has rank one less than `G`.
 
+Levi subgroups of `G_2`
+-----------------------
+
+The exceptional group `G_2` has two Levi subgroups of type
+`A_1`. Neither is maximal, as we can see from the extended
+Dynkin diagram: the subgroups `A_1\times A_1` and `A_2`
+are maximal and each contains a Levi subgroup. (Actually
+`A_1\times A_1` contains a conjugate of both.) Only
+the Levi subgroup containing the short root is implemented
+as an instance of ``rule="levi"``. To obtain the other,
+use the rule
+
+     branching_rule("G2","A2","extended")*branching_rule("A2","A1","levi")
+
+which branches to the `A_1` Levi subgroup containing a long root.
 
 Orthogonal and symplectic subgroups of orthogonal and symplectic groups
 -----------------------------------------------------------------------
@@ -430,36 +445,37 @@ Dynkin diagram (see below) gives ``A5xA1``. To
 construct the branching rule to `A_5` we may proceed
 as follows::
 
-   sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
-   composite branching rule E6 => (extended) A5xA1 => (proj1) A5
-   sage: E6=WeylCharacterRing("E6",style="coroots")
-   sage: A5=WeylCharacterRing("A5",style="coroots")
-   sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
-   3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
-   sage: b.describe()
-   <BLANKLINE>
-           O 0
-           |
-           |
-           O 2
-           |
-           |
-   O---O---O---O---O
-   1   3   4   5   6
-   E6~
-   root restrictions E6 => A5:
-   <BLANKLINE>
-   O---O---O---O---O
-   1   2   3   4   5
-   A5
-   <BLANKLINE>
-   1 => 1
-   3 => 2
-   4 => 3
-   5 => 4
-   6 => 5
-   <BLANKLINE>
-   For more detailed information use verbose=True
+    sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
+    composite branching rule E6 => (extended) A5xA1 => (proj1) A5
+    sage: E6=WeylCharacterRing("E6",style="coroots")
+    sage: A5=WeylCharacterRing("A5",style="coroots")
+    sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
+    3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
+    sage: b.describe()
+    <BLANKLINE>
+            O 0
+            |
+            |
+            O 2
+            |
+            |
+    O---O---O---O---O
+    1   3   4   5   6
+    E6~
+    root restrictions E6 => A5:
+    <BLANKLINE>
+    O---O---O---O---O
+    1   2   3   4   5
+    A5
+    <BLANKLINE>
+    0 => (zero)
+    1 => 1
+    3 => 2
+    4 => 3
+    5 => 4
+    6 => 5
+    <BLANKLINE>
+    For more detailed information use verbose=True
 
 Note that it is not necessary to construct the WeylCharacterRing
 for the intermediate group ``A5xA1``.
@@ -640,15 +656,90 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
 The first rule corresponds to the embedding of ``G_2`` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The remaining rules come about as follows. Let `G` be
+`F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
+or else (if `G=E_7`) `F_4`. We embed `H` into `G`
+in the most obvious way; that is, in the chain
+of subgroups
+
+    .. MATH::
+
+       G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
+
+
+
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
 
+Maximal A1 subgroups of Exceptional Groups
+------------------------------------------
+
+There are seven embeddings of `SL(2)` into an exceptional
+group as a maximal subgroup: one each for `G_2` and `F_4`,
+two nonconjugate embeddings for `E_7` and three for `E_8`
+These are constructed in [Testerman1992]_. Create the
+corresponding branching rules as follows. The names of
+the rules are roman numerals referring to the seven
+cases of Testerman's Theorem 1::
+
+       sage: branching_rule("G2","A1","i")
+       i branching rule G2 => A1
+       sage: branching_rule("F4","A1","ii")
+       ii branching rule F4 => A1
+       sage: branching_rule("E7","A1","iii")
+       iii branching rule E7 => A1
+       sage: branching_rule("E7","A1","iv")
+       iv branching rule E7 => A1
+       sage: branching_rule("E8","A1","v")
+       v branching rule E8 => A1
+       sage: branching_rule("E8","A1","vi")
+       vi branching rule E8 => A1
+       sage: branching_rule("E8","A1","vii")
+       vii branching rule E8 => A1
+
+The embeddings are characterized by the root
+restrictions in their branching rules: usually
+a simple root of the ambient group `G` restricts
+to the unique simple root of `A_1`, except for
+root `\alpha_4` for rules iv, vi and vii,
+and the root `\alpha_6` for root vii; this is
+essentially the way Testerman characterizes
+the embeddings, and this information may
+be obtained from Sage by employing the 
+``describe()`` method of the branching rule.
+Thus::
+
+       sage: branching_rule("E8","A1","vii").describe()
+       <BLANKLINE>
+               O 2
+               |
+               |
+       O---O---O---O---O---O---O---O
+       1   3   4   5   6   7   8   0
+       E8~
+       root restrictions E8 => A1:
+       <BLANKLINE>
+       O
+       1
+       A1
+       <BLANKLINE>       
+       1 => 1
+       2 => 1
+       3 => 1
+       4 => (zero)
+       5 => 1
+       6 => (zero)
+       7 => 1
+       8 => 1
+       <BLANKLINE>       
+       For more detailed information use verbose=True
 
 Writing your own branching rules
 --------------------------------
@@ -659,16 +750,17 @@ cannot be created by using the tools you already have, all
 of which are related to the exceptional groups. Of all the
 branching rules listed in [McKayPatera1981]_ the only ones
 that are not implemented or constructible by plethysms
-are given by the following table. (The information given
-in this table is of course not sufficent to describe the embedding.)
-Some of these may eventually be implemented.
+are given by the following table. The information given
+in this table is not intended to suffice to describe the embedding.
+See [Dynkin1952]_ or [Seitz1991]_ for descriptions of these
+subgroups. We hope that all of these may eventually be implemented.
 
     .. MATH::
 
       \begin{aligned}
       E_6 & \to C_4, A_2, G_2
-      \\ E_7 &\to A_2,  A_1, A_1, A_1\times F_4, A_1\times G_2, A_1\times A_1
-      \\ E_8 & \to C_7 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
+      \\ E_7 &\to A_2,  A_1, A_1, A_1\times A_1
+      \\ E_8 & \to C_2 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
       \\ F_4 & \to A_1
       \end{aligned}
 
@@ -773,6 +865,7 @@ representation of `SO(8)` and the two
 eight-dimensional spin representations. These are
 permuted by triality::
 
+    sage: D4=WeylCharacterRing("D4",style="coroots")
     sage: D4(0,0,0,1).branch(D4,rule="triality")
     D4(1,0,0,0)
     sage: D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ sage -t branching_rules.rst
Running doctests with ID 2013-12-26-08-33-08-984a018a.
Doctesting 1 file.
sage -t branching_rules.rst
    [97 tests, 4.96 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 5.5 seconds
    cpu time: 4.9 seconds
    cumulative wall time: 5.0 seconds
~/sagemath/sage/src/doc/en/thematic_tutorials/lie:$ popd
~/sagemath/sage/src/sage/combinat/root_system
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/bibliography.rst b/src/doc/en/thematic_tutorials/lie/bibliography.rst
index b7b576b..42c0673 100644
--- a/src/doc/en/thematic_tutorials/lie/bibliography.rst
+++ b/src/doc/en/thematic_tutorials/lie/bibliography.rst
@@ -18,6 +18,10 @@ Bibliography
 .. [Dyer1993] M. J. Dyer. The nil Hecke ring and Deodhar's conjecture
    on Bruhat intervals. Inventiones Mathematicae, 111(1):571--574, 1993.
 
+.. [Dynkin1952] E. B. Dynkin,
+   Semisimple subalgebras of semisimple Lie algebras. (Russian) 
+   Mat. Sbornik N.S. 30(72):349–462, 1952.
+
 .. [FauserEtAl2006] B. Fauser, P. D. Jarvis, R. C. King, and
    B. G. Wybourne. New branching rules induced by plethysm. *Journal of
    Physics A*. 39(11):2611--2655, 2006.
@@ -94,6 +98,10 @@ Bibliography
    Kirillov--Reshetikhin crystals for nonexceptional types.
    *Representation Theory* 12:186--207, 2008.
 
+.. [Seitz1991] G. Seitz,
+   Maximal subgroups of exceptional algebraic groups. 
+   Mem. Amer. Math. Soc. 90 (1991), no. 441.
+
 .. [Rubenthaler2008] H. Rubenthaler, 
    The (A2,G2) duality in E6, octonions and the triality principle.
    Trans. Amer. Math. Soc. 360 (2008), no. 1, 347–367 
@@ -105,3 +113,5 @@ Bibliography
 .. [Stanley1999] R. P. Stanley. *Enumerative Combinatorics, Volume
    2*. Cambridge University Press, 1999.
 
+.. [Testerman1992] Testerman, Donna M. The construction of the maximal A1's in
+   the exceptional algebraic groups. Proc. Amer. Math. Soc. 116 (1992), no. 3, 635–644.
\ No newline at end of file
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index fd10f2b..f91a7d6 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -30,6 +30,7 @@ so not by memorizing a combinatorial rule, but by computing the
 character and restricting the character to a maximal torus of `H`.
 What Sage has memorized (in a series of built-in encoded rules)
 are the various embeddings of maximal tori of maximal subgroups of `G`.
+The maximal subgroups of Lie groups were determined in [Dynkin1952]_.
 This approach to computing branching rules has a limitation: the
 character must fit into memory and be computable by Sage's
 internal code in real time.
@@ -266,7 +267,6 @@ two accidental isomorphisms ``C2=B2`` and ``D2=A1xA1``. It is much
 easier to go in one step using ``rule="levi"``, but reassuring that we
 get the same answer!
 
-
 Subgroups classified by the extended Dynkin diagram
 ---------------------------------------------------
 
@@ -300,6 +300,21 @@ For embeddings of this type, the rank of the subgroup `H` is the same
 as the rank of `G`. This is in contrast with embeddings of Levi type,
 where `H` has rank one less than `G`.
 
+Levi subgroups of `G_2`
+-----------------------
+
+The exceptional group `G_2` has two Levi subgroups of type
+`A_1`. Neither is maximal, as we can see from the extended
+Dynkin diagram: the subgroups `A_1\times A_1` and `A_2`
+are maximal and each contains a Levi subgroup. (Actually
+`A_1\times A_1` contains a conjugate of both.) Only
+the Levi subgroup containing the short root is implemented
+as an instance of ``rule="levi"``. To obtain the other,
+use the rule
+
+     branching_rule("G2","A2","extended")*branching_rule("A2","A1","levi")
+
+which branches to the `A_1` Levi subgroup containing a long root.
 
 Orthogonal and symplectic subgroups of orthogonal and symplectic groups
 -----------------------------------------------------------------------
@@ -430,36 +445,37 @@ Dynkin diagram (see below) gives ``A5xA1``. To
 construct the branching rule to `A_5` we may proceed
 as follows::
 
-   sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
-   composite branching rule E6 => (extended) A5xA1 => (proj1) A5
-   sage: E6=WeylCharacterRing("E6",style="coroots")
-   sage: A5=WeylCharacterRing("A5",style="coroots")
-   sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
-   3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
-   sage: b.describe()
-   <BLANKLINE>
-           O 0
-           |
-           |
-           O 2
-           |
-           |
-   O---O---O---O---O
-   1   3   4   5   6
-   E6~
-   root restrictions E6 => A5:
-   <BLANKLINE>
-   O---O---O---O---O
-   1   2   3   4   5
-   A5
-   <BLANKLINE>
-   1 => 1
-   3 => 2
-   4 => 3
-   5 => 4
-   6 => 5
-   <BLANKLINE>
-   For more detailed information use verbose=True
+    sage: b = branching_rule("E6","A5xA1","extended")*branching_rule("A5xA1","A5","proj1"); b
+    composite branching rule E6 => (extended) A5xA1 => (proj1) A5
+    sage: E6=WeylCharacterRing("E6",style="coroots")
+    sage: A5=WeylCharacterRing("A5",style="coroots")
+    sage: E6(0,1,0,0,0,0).branch(A5,rule=b)
+    3*A5(0,0,0,0,0) + 2*A5(0,0,1,0,0) + A5(1,0,0,0,1)
+    sage: b.describe()
+    <BLANKLINE>
+            O 0
+            |
+            |
+            O 2
+            |
+            |
+    O---O---O---O---O
+    1   3   4   5   6
+    E6~
+    root restrictions E6 => A5:
+    <BLANKLINE>
+    O---O---O---O---O
+    1   2   3   4   5
+    A5
+    <BLANKLINE>
+    0 => (zero)
+    1 => 1
+    3 => 2
+    4 => 3
+    5 => 4
+    6 => 5
+    <BLANKLINE>
+    For more detailed information use verbose=True
 
 Note that it is not necessary to construct the WeylCharacterRing
 for the intermediate group ``A5xA1``.
@@ -640,15 +656,90 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
 The first rule corresponds to the embedding of ``G_2`` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The remaining rules come about as follows. Let `G` be
+`F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
+or else (if `G=E_7`) `F_4`. We embed `H` into `G`
+in the most obvious way; that is, in the chain
+of subgroups
+
+    .. MATH::
+
+       G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
+
+
+
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
 
+Maximal A1 subgroups of Exceptional Groups
+------------------------------------------
+
+There are seven embeddings of `SL(2)` into an exceptional
+group as a maximal subgroup: one each for `G_2` and `F_4`,
+two nonconjugate embeddings for `E_7` and three for `E_8`
+These are constructed in [Testerman1992]_. Create the
+corresponding branching rules as follows. The names of
+the rules are roman numerals referring to the seven
+cases of Testerman's Theorem 1::
+
+       sage: branching_rule("G2","A1","i")
+       i branching rule G2 => A1
+       sage: branching_rule("F4","A1","ii")
+       ii branching rule F4 => A1
+       sage: branching_rule("E7","A1","iii")
+       iii branching rule E7 => A1
+       sage: branching_rule("E7","A1","iv")
+       iv branching rule E7 => A1
+       sage: branching_rule("E8","A1","v")
+       v branching rule E8 => A1
+       sage: branching_rule("E8","A1","vi")
+       vi branching rule E8 => A1
+       sage: branching_rule("E8","A1","vii")
+       vii branching rule E8 => A1
+
+The embeddings are characterized by the root
+restrictions in their branching rules: usually
+a simple root of the ambient group `G` restricts
+to the unique simple root of `A_1`, except for
+root `\alpha_4` for rules iv, vi and vii,
+and the root `\alpha_6` for root vii; this is
+essentially the way Testerman characterizes
+the embeddings, and this information may
+be obtained from Sage by employing the 
+``describe()`` method of the branching rule.
+Thus::
+
+       sage: branching_rule("E8","A1","vii").describe()
+       <BLANKLINE>
+               O 2
+               |
+               |
+       O---O---O---O---O---O---O---O
+       1   3   4   5   6   7   8   0
+       E8~
+       root restrictions E8 => A1:
+       <BLANKLINE>
+       O
+       1
+       A1
+       <BLANKLINE>       
+       1 => 1
+       2 => 1
+       3 => 1
+       4 => (zero)
+       5 => 1
+       6 => (zero)
+       7 => 1
+       8 => 1
+       <BLANKLINE>       
+       For more detailed information use verbose=True
 
 Writing your own branching rules
 --------------------------------
@@ -659,16 +750,17 @@ cannot be created by using the tools you already have, all
 of which are related to the exceptional groups. Of all the
 branching rules listed in [McKayPatera1981]_ the only ones
 that are not implemented or constructible by plethysms
-are given by the following table. (The information given
-in this table is of course not sufficent to describe the embedding.)
-Some of these may eventually be implemented.
+are given by the following table. The information given
+in this table is not intended to suffice to describe the embedding.
+See [Dynkin1952]_ or [Seitz1991]_ for descriptions of these
+subgroups. We hope that all of these may eventually be implemented.
 
     .. MATH::
 
       \begin{aligned}
       E_6 & \to C_4, A_2, G_2
-      \\ E_7 &\to A_2,  A_1, A_1, A_1\times F_4, A_1\times G_2, A_1\times A_1
-      \\ E_8 & \to C_7 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
+      \\ E_7 &\to A_2,  A_1, A_1, A_1\times A_1
+      \\ E_8 & \to C_2 , A_1\times A_2 , A_1 , A_1 , A_1                                                           
       \\ F_4 & \to A_1
       \end{aligned}
 
@@ -773,6 +865,7 @@ representation of `SO(8)` and the two
 eight-dimensional spin representations. These are
 permuted by triality::
 
+    sage: D4=WeylCharacterRing("D4",style="coroots")
     sage: D4(0,0,0,1).branch(D4,rule="triality")
     D4(1,0,0,0)
     sage: D4(0,0,0,1).branch(D4,rule="triality").branch(D4,rule="triality")
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index 8e5234b..e5ab7fa 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1703,21 +1703,38 @@ def branch_weyl_character(chi, R, S, rule="default"):
 
     Related to the automorphic type, when `G` admits
     an outer automorphism (usually of degree 2) we may consider
-    the branching rule to the isotropy subgroup `H`. In many cases
-    the Dynkin diagram of `H` can be obtained by folding the Dynkin
-    diagram of `G`. For such isotropy subgroups use ``rule="symmetric"``.
-    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
-    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+    the branching rule to the isotropy subgroup `H`. Outer
+    automorphisms correspond to symmetries of the Dynkin diagram.
+    For such isotropy subgroups use ``rule="symmetric"``.
+    We may thus obtain the following branching rules.
 
     .. MATH::
 
-        A_{2r+1} & \to B_r
-        \\ A_{2r} & \to C_r
-        \\ A_{2r} & \to D_r
+        A_{2r} & \to B_r
+        \\ A_{2r-1} & \to C_r
+        \\ A_{2r-1} & \to D_r
         \\ D_r & \to B_{r-1}
         \\ E_6 & \to F_4
+        \\ E_6 & \to C_4
         \\ D_4 & \to G_2
 
+    The last branching rule, `D_4 \to G_2` is not to a maximal subgroup
+    since `D_4 \to B_3 \to G_2`, but it is included for convenience.
+
+    In some cases, two outer automorphisms that differ by an
+    inner automorphism may have different fixed subgroups.
+    Thus, while the Dynkin diagram of `E_6` has a single
+    involutory automorphism, there are two involutions
+    of the group (differing by an inner automorphism) with
+    fixed subgroups `F_4` and `C_4`. Similarly
+    `SL(2r)`, of Cartan type `A_{2r-1}`, has subgroups
+    `SO(2r)` and `Sp(2r)`, both fixed subgroups of outer
+    automorphisms that differ from each other by an inner
+    automorphism.
+
+    In many cases the Dynkin diagram of `H` can be obtained by
+    folding the Dynkin diagram of `G`.
+
     EXAMPLES::
 
         sage: [w.branch(B2,rule="symmetric") for w in [A4(1,0,0,0,0),A4(1,1,0,0,0),A4(1,1,1,0,0),A4(2,0,0,0,0)]]
@@ -1737,6 +1754,12 @@ def branch_weyl_character(chi, R, S, rule="default"):
          F4(1,0,0,0) + 2*F4(0,0,1,0) + F4(1,0,0,1) + F4(0,1,0,0),
          F4(0,0,0,1) + F4(1,0,0,0) + F4(0,0,1,0),
          F4(0,0,0,0) + F4(0,0,0,1)]
+        sage: E6=WeylCharacterRing("E6",style="coroots")
+        sage: C4=WeylCharacterRing("C4",style="coroots")
+        sage: chi = E6(1,0,0,0,0,0); chi.degree()
+        27
+        sage: chi.branch(C4,rule="symmetric")
+        C4(0,1,0,0)
 
     .. RUBRIC:: Extended Type
 
@@ -1954,6 +1977,7 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
+        \\ E_7 & \to F_4 \times A_1,
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
@@ -1975,11 +1999,47 @@ def branch_weyl_character(chi, R, S, rule="default"):
         sage: G2xC3=WeylCharacterRing("G2xC3",style="coroots")
         sage: E7(0,1,0,0,0,0,0).branch(G2xC3,rule="miscellaneous") # long time (1.84s)
         G2xC3(1,0,1,0,0) + G2xC3(1,0,1,1,0) + G2xC3(0,1,0,0,1) + G2xC3(2,0,1,0,0) + G2xC3(0,0,1,1,0)
+        sage: F4xA1=WeylCharacterRing("F4xA1",style="coroots")
+        sage: E7(0,0,0,0,0,0,1).branch(F4xA1,"miscellaneous")
+        F4xA1(0,0,0,1,1) + F4xA1(0,0,0,0,3)
         sage: E8 = WeylCharacterRing("E8",style="coroots")
         sage: G2xF4 = WeylCharacterRing("G2xF4",style="coroots")
         sage: E8(0,0,0,0,0,0,0,1).branch(G2xF4,rule="miscellaneous") # long time (0.76s)
         G2xF4(1,0,0,0,0,1) + G2xF4(0,1,0,0,0,0) + G2xF4(0,0,1,0,0,0)
 
+    .. RUBRIC:: A1 maximal subgroups of exceptional groups
+
+    There are seven cases where the exceptional group `G_2`, `F_4`,
+    `E_7` or `E_8` contains a maximal subgroup of type `A_1`.
+    These are tabulated in Theorem 1 of Testerman,
+    The construction of the maximal A1's in the exceptional algebraic groups,
+    Proc. Amer. Math. Soc. 116 (1992), no. 3, 635–644. The
+    names of these branching rules are roman numerals referring
+    to the seven cases of her Theorem 1. Use these branching
+    rules as in the following examples.
+
+    EXAMPLES::
+
+        sage: A1=WeylCharacterRing("A1",style="coroots")
+        sage: G2=WeylCharacterRing("G2",style="coroots")
+        sage: F4=WeylCharacterRing("F4",style="coroots")
+        sage: E7=WeylCharacterRing("E7",style="coroots")
+        sage: E8=WeylCharacterRing("E8",style="coroots")
+        sage: [G2(f).branch(A1,rule="i") for f in G2.fundamental_weights()]
+        [A1(6), A1(2) + A1(10)]
+        sage: F4(1,0,0,0).branch(A1,rule="ii")
+        A1(2) + A1(10) + A1(14) + A1(22)
+        sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iii")
+        A1(9) + A1(17) + A1(27)
+        sage: E7(0,0,0,0,0,0,1).branch(A1,rule="iv")
+        A1(5) + A1(11) + A1(15) + A1(21)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="v") # long time (0.6s)
+        A1(2) + A1(14) + A1(22) + A1(26) + A1(34) + A1(38) + A1(46) + A1(58)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vi") # long time (0.6s)
+        A1(2) + A1(10) + A1(14) + A1(18) + A1(22) + A1(26) + A1(28) + A1(34) + A1(38) + A1(46)
+        sage: E8(0,0,0,0,0,0,0,1).branch(A1,rule="vii") # long time (0.6s)
+        A1(2) + A1(6) + A1(10) + A1(14) + A1(16) + A1(18) + 2*A1(22) + A1(26) + A1(28) + A1(34) + A1(38)
+
     .. RUBRIC:: Branching Rules From Plethysms
 
     Nearly all branching rules `G \to H` where `G` is of type `A`, `B`, `C`
@@ -2285,6 +2345,41 @@ class BranchingRule(SageObject):
         except:
             return self._f(x.to_vector())
 
+    def __cmp__(self, other):
+        """
+        Two branching rules with the same source and target Cartan types are
+        considered equal if they have the same effect on the fundamental
+        representations.
+
+        EXAMPLES::
+
+            sage: b = branching_rule("E6","F4","symmetric")*branching_rule("F4","B3","levi")*branching_rule("B3","G2","miscellaneous"); b
+            composite branching rule E6 => (symmetric) F4 => (levi) B3 => (miscellaneous) G2
+            sage: c = branching_rule("E6", "G2xA2", "miscellaneous")*branching_rule("G2xA2", "G2", "proj1"); c
+            composite branching rule E6 => (miscellaneous) G2xA2 => (proj1) G2
+            sage: b == c
+            True
+            sage: d = branching_rule("A3","A2","levi")*branching_rule("A2","A1","levi"); d
+            composite branching rule A3 => (levi) A2 => (levi) A1
+            sage: e = branching_rule("A3","D3","isomorphic")*branching_rule("D3","B2","symmetric")*branching_rule("B2","A1","levi"); e
+            composite branching rule A3 => (isomorphic) D3 => (symmetric) B2 => (levi) A1
+            sage: d == e
+            False
+        """
+        Rspace = RootSystem(self._R).ambient_space()
+        Rspace_other = RootSystem(other._R).ambient_space()
+        if Rspace != Rspace_other:
+            return cmp(Rspace, Rspace_other)
+        Sspace = RootSystem(self._S).ambient_space()
+        Sspace_other = RootSystem(other._S).ambient_space()
+        if Sspace != Sspace_other:
+            return cmp(Sspace, Sspace_other)
+        for v in Rspace.fundamental_weights():
+            [a, b] = [Sspace(self(list(v.to_vector()))), Sspace(other(list(v.to_vector())))]
+            if a != b:
+                return cmp(a, b)
+        return 0
+
     def __mul__(self, other):
         """
         EXAMPLES::
@@ -2365,8 +2460,7 @@ class BranchingRule(SageObject):
                 done = False
                 if resr == Sspace.zero():
                     done = True
-                    if verbose:
-                        print "%s => (zero)"%j
+                    print "%s => (zero)"%j
                 else:
                     for s in Sspace.roots():
                         if s == resr:
@@ -2583,10 +2677,15 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                 raise ValueError("Rule not found")
         elif Rtype[0] == 'D' and Stype[0] == 'B' and s == r-1:
             return BranchingRule(Rtype, Stype, lambda x : x[:s], "symmetric")
-        elif Rtype[0] == 'D' and r == 4 and Stype[0] == 'G':
+        elif Rtype == CartanType("D4") and Stype == CartanType("G2"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "symmetric")
-        elif Rtype[0] == 'E' and Stype[0] == 'F' and r == 6 and s == 4:
+        elif Rtype == CartanType("E6") and Stype == CartanType("F4"):
             return BranchingRule(Rtype, Stype, lambda x : [(x[4]-3*x[5])/2,(x[0]+x[1]+x[2]+x[3])/2,(-x[0]-x[1]+x[2]+x[3])/2,(-x[0]+x[1]-x[2]+x[3])/2], "symmetric")
+        elif Rtype == CartanType("E6") and Stype == CartanType("C4"):
+            def f(x):
+                [x0,x1,x2,x3,x4,x5]=x[:6]
+                return [(x0+x1+x2+x3+x4-3*x5)/2, (-x0-x1-x2-x3+x4-3*x5)/2,  -x0+x3,  -x1+x2]
+            return BranchingRule(Rtype, Stype, f, "symmetric")
         else:
             raise ValueError("Rule not found")
     elif rule == "extended" or rule == "orthogonal_sum":
@@ -2761,26 +2860,29 @@ def get_branching_rule(Rtype, Stype, rule="default"):
             raise ValueError("Incompatible ranks")
         if Rtype == Stype:
             return BranchingRule(Rtype, Stype, lambda x : x, "isomorphic")
-        elif Rtype[0] == 'B' and r == 2 and Stype[0] == 'C':
+        elif Rtype == CartanType("B2") and Stype == CartanType("C2"):
             def rule(x) : [x1, x2] = x; return [x1+x2, x1-x2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'B' and r == 1 and Stype[0] == 'A':
-            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
-        elif Rtype[0] == 'C' and r == 2 and Stype[0] == 'B':
+        elif Rtype == CartanType("C2") and Stype == CartanType("B2"):
             def rule(x) : [x1, x2] = x; return [(x1+x2)/2, (x1-x2)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'C' and r == 1 and Stype[0] == 'A':
+        elif Rtype == CartanType("B1") and Stype == CartanType("A1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0],-x[0]], "isomorphic")
+        elif Rtype == CartanType("A1") and Stype == CartanType("B1"):
+            return BranchingRule(Rtype, Stype, lambda x : [(x[0]-x[1])/2], "isomorphic")
+        elif Rtype == CartanType("C1") and Stype == CartanType("A1"):
             return BranchingRule(Rtype, Stype, lambda x : [x[0]/2,-x[0]/2], "isomorphic")
-        elif Rtype[0] == 'A' and r == 3 and Stype[0] == 'D':
+        elif Rtype == CartanType("A1") and Stype == CartanType("C1"):
+            return BranchingRule(Rtype, Stype, lambda x : [x[0]-x[1]], "isomorphic")
+        elif Rtype == CartanType("A3") and Stype == CartanType("D3"):
             def rule(x): [x1, x2, x3, x4] = x; return [(x1+x2-x3-x4)/2, (x1-x2+x3-x4)/2, (x1-x2-x3+x4)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 2 and Stype.is_compound() and \
-                 all(t[0] == 'A' for t in stypes):
-            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
-            return BranchingRule(Rtype, Stype, rule, "isomorphic")
-        elif Rtype[0] == 'D' and r == 3 and Stype[0] == 'A':
+        elif Rtype == CartanType("D3") and Stype == CartanType("A3"):
             def rule(x): [t1, t2, t3] = x; return [(t1+t2+t3)/2, (t1-t2-t3)/2, (-t1+t2-t3)/2, (-t1-t2+t3)/2]
             return BranchingRule(Rtype, Stype, rule, "isomorphic")
+        elif Rtype == CartanType("D2") and Stype == CartanType("A1xA1"):
+            def rule(x): [t1, t2] = x; return [(t1-t2)/2, -(t1-t2)/2, (t1+t2)/2, -(t1+t2)/2]
+            return BranchingRule(Rtype, Stype, rule, "isomorphic")
         else:
             raise ValueError("Rule not found")
     elif rule == "tensor" or rule == "tensor-debug":
@@ -2874,10 +2976,6 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     a = sum((2*r-2*i-1)*x[i] for i in range(r))
                     return [a/2,-a/2]
                 return BranchingRule(Rtype, Stype, rule, "symmetric_power")
-            else:
-                raise ValueError("Rule not found")
-        else:
-            raise ValueError("Rule not found")
     elif rule == "miscellaneous":
         if Rtype[0] == 'B' and Stype[0] == 'G' and r == 3:
             return BranchingRule(Rtype, Stype, lambda x : [x[0]+x[1], -x[1]+x[2], -x[0]-x[2]], "miscellaneous")
@@ -2887,34 +2985,58 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[5],x[5]+x[4],x[5]-x[4],x[2]+x[3],x[1]-x[2],-x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3],x[1]-x[2],-x[1]-x[3],-2*x[5],x[5]+x[4],x[5]-x[4]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
         elif Rtype == CartanType("E7"):
             if Stype.is_compound():
                 if stypes == [CartanType("C3"),CartanType("G2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[6],x[4]+x[5],-x[4]+x[5],x[1]+x[3],x[2]-x[3],-x[1]-x[2]],"miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("C3")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3],x[2]-x[3],-x[1]-x[2],-2*x[6],x[4]+x[5],-x[4]+x[5]],"miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
+                elif stypes == [CartanType("F4"),CartanType("A1")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2,x5-x6,x6-x5]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
+                elif stypes == [CartanType("A1"),CartanType("F4")]:
+                    def f(x) :
+                        [x0,x1,x2,x3,x4,x5,x6] = x[:7]
+                        return [x5-x6,x6-x5,(x4-x5)/2-x6,(x0+x1+x2+x3)/2,(-x0-x1+x2+x3)/2,(-x0+x1-x2+x3)/2]
+                    return BranchingRule(Rtype, Stype, f, "miscellaneous")
         elif Rtype == CartanType("E8"):
             if Stype.is_compound():
                 if stypes == [CartanType("F4"),CartanType("G2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[7], x[6], x[5], x[4], x[1]+x[3], -x[3]+x[2], -x[1]-x[2]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("F4")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[1]+x[3], -x[3]+x[2], -x[1]-x[2], x[7], x[6], x[5], x[4]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
         elif Rtype[0] == 'F':
             if Stype.is_compound():
                 if stypes == [CartanType("A1"),CartanType("G2")]:
                     return BranchingRule("F4","A1xG2", lambda x : [ 2*x[0], -2*x[0], x[1]+x[2], -x[2]+x[3], -x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A1")]:
                     return BranchingRule("F4","G2xA1", lambda x : [x[1]+x[2], -x[2]+x[3], -x[1]-x[3], 2*x[0], -2*x[0]], "miscellaneous")
-                else:
-                    raise ValueError("Rule not found")
-        else:
-            raise ValueError("Rule not found")
+    elif rule in ["i","ii","iii","iv","v","vi","vii"]:
+        if Stype != CartanType("A1"):
+            raise ValueError("Wrong target Cartan Type for rule %s"%rule)
+        if rule == "i" and Rtype == CartanType("G2"):
+            return BranchingRule(Rtype, Stype, lambda x : [(5*x[0]-x[1]-4*x[2])/3,-(5*x[0]-x[1]-4*x[2])/3], "i")
+        elif rule == "ii" and Rtype == CartanType("F4"):
+            return BranchingRule(Rtype, Stype, lambda x : [8*x[0]+3*x[1]+2*x[2]+x[3],-(8*x[0]+3*x[1]+2*x[2]+x[3])], "ii")
+        elif rule == "iii" and Rtype == CartanType("E7"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6],-(x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]-17*x[6])],"iii")
+        elif rule == "iv" and Rtype == CartanType("E7"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x: [x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]-13*x[6],-(x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]-13*x[6])],"iv")
+        elif rule == "v" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]+6*x[6]+23*x[7],-(x[1]+2*x[2]+3*x[3]+4*x[4]+5*x[5]+6*x[6]+23*x[7])],"v")
+        elif rule == "vi" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]+5*x[6]+18*x[7],-(x[1]+x[2]+2*x[3]+3*x[4]+4*x[5]+5*x[6]+18*x[7])],"vi")
+        elif rule == "vii" and Rtype == CartanType("E8"):
+            return BranchingRule(Rtype, Stype, \
+                          lambda x : [x[1]+x[2]+2*x[3]+2*x[4]+3*x[5]+4*x[6]+15*x[7],-(x[1]+x[2]+2*x[3]+2*x[4]+3*x[5]+4*x[6]+15*x[7])],"vii")
+        raise ValueError("Wrong source Cartan Type for rule %s"%rule)
+    raise ValueError("Rule not found")
 
 branching_rule = get_branching_rule
 
~/sagemath/sage/src/sage/combinat/root_system:$ git commit -a -m "several rules implemented, including A1 embeddings into exceptional groups."
[15361-branching-rules ac6cfe3] several rules implemented, including A1 embeddings into exceptional groups.
 3 files changed, 298 insertions(+), 73 deletions(-)
~/sagemath/sage/src/sage/combinat/root_system:$ git push
fatal: The upstream branch of your current branch does not match
the name of your current branch.  To push to the upstream branch
on the remote, use



To push to the branch of the same name on the remote, use

    git push origin 15361-branching-rules

~/sagemath/sage/src/sage/combinat/root_system:$     git push origin HEAD:public/combinat/15361-branching-rules
Counting objects: 91, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (13/13), done.
Writing objects: 100% (13/13), 5.07 KiB | 0 bytes/s, done.
Total 13 (delta 12), reused 0 (delta 0)
remote: Trac #15361: Commit changed to ac6cfe.        
To git@trac.sagemath.org:sage.git
   db39e92..ac6cfe3  HEAD -> public/combinat/15361-branching-rules
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: for f in G2.fundamental_weights(): print f
(1, 0, -1)
(2, -1, -1)
sage: for f in E6.fundamental_weights(): print f
(0, 0, 0, 0, 0, -2/3, -2/3, 2/3)
(1/2, 1/2, 1/2, 1/2, 1/2, -1/2, -1/2, 1/2)
(-1/2, 1/2, 1/2, 1/2, 1/2, -5/6, -5/6, 5/6)
(0, 0, 1, 1, 1, -1, -1, 1)
(0, 0, 0, 1, 1, -2/3, -2/3, 2/3)
(0, 0, 0, 0, 1, -1/3, -1/3, 1/3)
sage: ### reloading attached file a1.sage modified at 19:38:04 ###
sage: ### reloading attached file a1.sage modified at 19:38:04 ###
sage: ew = E6.fundamental_weights()
sage: fe(ew[1])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-6-5d6dadee86b0> in <module>()
----> 1 fe(ew[Integer(1)])

/Users/bump/.sage/temp/meep2/15418/a1.sagevwfxAe.py in fe(x)
     98 
     99 def fe(x):
--> 100     [x0,x1,x2,x3,x4,x5]=x.to_vector()
    101     return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    102 

ValueError: too many values to unpack
sage: ### reloading attached file a1.sage modified at 19:39:17 ###

sage: fe(ew[1])
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-7-5d6dadee86b0> in <module>()
----> 1 fe(ew[Integer(1)])

/Users/bump/.sage/temp/meep2/15418/a1.sagei6kfpP.py in fe(x)
     99 def fe(x):
    100     [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
--> 101     return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    102 
    103 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2392             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2393         """
-> 2394         if self._S == other._R:
   2395             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2396             internames = flatten([self._intermediate_names, other._intermediate_names])

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.__getattr__ (sage/structure/element.c:3873)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1696)()

AttributeError: 'sage.rings.rational.Rational' object has no attribute '_R'
sage: fe
<function __main__.fe>
sage: ### reloading attached file a1.sage modified at 19:40:16 ###
fe(ew[1])
a0 a1 b0 a1 branching rule E8 => A1 c0 c1
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-9-5d6dadee86b0> in <module>()
----> 1 fe(ew[Integer(1)])

/Users/bump/.sage/temp/meep2/15418/a1.sageKAXuYf.py in fe(x)
    100     [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
    101     print a0, a1, b0, b1, c0, c1
--> 102     return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    103 
    104 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __mul__(self, other)
   2392             A5(0,0,0,1,0) + 2*A5(1,0,0,0,0)
   2393         """
-> 2394         if self._S == other._R:
   2395             intermediates = flatten([self._intermediate_types, self._S, other._intermediate_types])
   2396             internames = flatten([self._intermediate_names, other._intermediate_names])

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.__getattr__ (sage/structure/element.c:3873)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1696)()

AttributeError: 'sage.rings.rational.Rational' object has no attribute '_R'
sage: ### reloading attached file a1.sage modified at 19:40:41 ###
### reloading attached file a1.sage modified at 19:40:52 ###
### reloading attached file a1.sage modified at 19:40:55 ###
fe(ew[1])
a0 a1 b0 b1 c0 c1
[-2/3*a5, -2/3*b5, -2/3*c5]
sage: gw=G2.fundamental_weights()
sage: G2.dynkin_diagram()
  3
O=<=O
1   2
G2
sage: 2*gw[1]+gw[2]
(4, -1, -3)
sage: 2*gw[1]+gw[2]-fe(ew[1])
a0 a1 b0 b1 c0 c1
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-14-7efc7d16a4c8> in <module>()
----> 1 Integer(2)*gw[Integer(1)]+gw[Integer(2)]-fe(ew[Integer(1)])

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/categories/commutative_additive_groups.pyc in __sub__(left, right)
     63             from sage.structure.element import get_coercion_model
     64             import operator
---> 65             return get_coercion_model().bin_op(left, right, operator.sub)
     66 
     67         ##################################################

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8280)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8169)()

TypeError: unsupported operand parent(s) for '-': 'Ambient space of the Root system of type ['G', 2]' and '<type 'list'>'
sage: (2*gw[1]+gw[2],fe(ew[1]))
a0 a1 b0 b1 c0 c1
((4, -1, -3), [-2/3*a5, -2/3*b5, -2/3*c5])
sage: (2*gw[1]+gw[2],fe(ew[1]).to_vector())
a0 a1 b0 b1 c0 c1
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-16-0e8778929bff> in <module>()
----> 1 (Integer(2)*gw[Integer(1)]+gw[Integer(2)],fe(ew[Integer(1)]).to_vector())

AttributeError: 'list' object has no attribute 'to_vector'
sage: (2*gw[1]+gw[2],vector(fe(ew[1])))
a0 a1 b0 b1 c0 c1
((4, -1, -3), (-2/3*a5, -2/3*b5, -2/3*c5))
sage: 2*gw[1]+gw[2]-vector(fe(ew[1])))
  File "<ipython-input-18-bb09c3dbff08>", line 1
    Integer(2)*gw[Integer(1)]+gw[Integer(2)]-vector(fe(ew[Integer(1)])))
                                                                       ^
SyntaxError: invalid syntax

sage: 2*gw[1]+gw[2]-vector(fe(ew[1]))
a0 a1 b0 b1 c0 c1
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-19-93fd22514302> in <module>()
----> 1 Integer(2)*gw[Integer(1)]+gw[Integer(2)]-vector(fe(ew[Integer(1)]))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/categories/commutative_additive_groups.pyc in __sub__(left, right)
     63             from sage.structure.element import get_coercion_model
     64             import operator
---> 65             return get_coercion_model().bin_op(left, right, operator.sub)
     66 
     67         ##################################################

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8280)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:8169)()

TypeError: unsupported operand parent(s) for '-': 'Ambient space of the Root system of type ['G', 2]' and 'Ambient free module of rank 3 over the integral domain Multivariate Polynomial Ring in X0, X1, X2, X3, X4, X5, X6, X7, X8, c0, c1, c2, c3, c4, c5, c6, c7, a0, a1, a2, a3, a4, a5, a6, a7, b0, b1, b2, b3, b4, b5, b6, b7 over Rational Field'
sage: 2*gw[1]+gw[2]-G2.space()(vector(fe(ew[1])))
a0 a1 b0 b1 c0 c1
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-20-6c739afa7b39> in <module>()
----> 1 Integer(2)*gw[Integer(1)]+gw[Integer(2)]-G2.space()(vector(fe(ew[Integer(1)])))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __call__(self, v)
    179             return self._from_dict(dict((i,K(c)) for i,c in enumerate(v) if c))
    180         else:
--> 181             return CombinatorialFreeModule.__call__(self, v)
    182 
    183 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8372)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3856)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3757)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.pyc in _element_constructor_(self, x)
   1543                 except TypeError:
   1544                     pass
-> 1545             raise TypeError, "do not know how to make x (= %s) an element of self (=%s)"%(x,self)
   1546 
   1547     def _an_element_impl(self):

TypeError: do not know how to make x (= (-2/3*a5, -2/3*b5, -2/3*c5)) an element of self (=Ambient space of the Root system of type ['G', 2])
sage: G2.space()(fe(ew[1]))
a0 a1 b0 b1 c0 c1
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-21-065e866375a5> in <module>()
----> 1 G2.space()(fe(ew[Integer(1)]))

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in __call__(self, v)
    177         if isinstance(v, (list, tuple)):
    178             K = self.base_ring()
--> 179             return self._from_dict(dict((i,K(c)) for i,c in enumerate(v) if c))
    180         else:
    181             return CombinatorialFreeModule.__call__(self, v)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/ambient_space.pyc in <genexpr>((i, c))
    177         if isinstance(v, (list, tuple)):
    178             K = self.base_ring()
--> 179             return self._from_dict(dict((i,K(c)) for i,c in enumerate(v) if c))
    180         else:
    181             return CombinatorialFreeModule.__call__(self, v)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8372)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.ConstantPolynomialSection._call_ (sage/rings/polynomial/polynomial_element.c:52911)()

TypeError: not a constant polynomial
sage: fe(ew[1])
a0 a1 b0 b1 c0 c1
[-2/3*a5, -2/3*b5, -2/3*c5]
sage: (2*gw[1]+gw[2],vector(fe(ew[1])))
a0 a1 b0 b1 c0 c1
((4, -1, -3), (-2/3*a5, -2/3*b5, -2/3*c5))
sage: ### reloading attached file a1.sage modified at 19:52:09 ###
resg()
(c0, c1, c2, c3, c4, c5, c6) 

---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-24-b6b1b265e156> in <module>()
----> 1 resg()

/Users/bump/.sage/temp/meep2/15418/a1.sage42oyLP.py in resg()
    113         for i in range(_sage_const_3 ):
    114             print u[i]-v[i]
--> 115     comp(_sage_const_2 *gw[_sage_const_1 ]+gw[_sage_const_2 ],vector(f(ew[_sage_const_1 ])))
    116 
    117 

/Users/bump/.sage/temp/meep2/15418/a1.sage42oyLP.py in f(x)
    108     print (c0,c1,c2,c3,c4,c5,c6), "\n"
    109     def f(x):
--> 110         [x0,x1,x2,x3,x4,x5]=x.to_vector()
    111         return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    112     def comp(u,v):

ValueError: too many values to unpack
sage: ### reloading attached file a1.sage modified at 19:52:31 ###
resg()
(c0, c1, c2, c3, c4, c5, c6) 

2/3*a5 + 4
2/3*b5 - 1
2/3*c5 - 3
sage: ### reloading attached file a1.sage modified at 19:56:41 ###
  File "/Users/bump/.sage/temp/meep2/15418/a1.sagedrgrDJ.py", line 112
    v = vector(f(ew[k])))
                        ^
SyntaxError: invalid syntax


sage: resg()
(c0, c1, c2, c3, c4, c5, c6) 

2/3*a5 + 4
2/3*b5 - 1
2/3*c5 - 3
sage: ### reloading attached file a1.sage modified at 19:56:53 ###
resg()
2/3*a5 + 2
2/3*b5
2/3*c5 - 2
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 2
sage: ### reloading attached file a1.sage modified at 19:58:47 ###
resg()
2/3*a5 + 2
2/3*b5
2/3*c5 - 2
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 2
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 5/6*a5 + 4
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 5/6*b5 - 1
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 5/6*c5 - 3
-a2 - a3 - a4 + a5 + 6
-b2 - b3 - b4 + b5 - 3
-c2 - c3 - c4 + c5 - 3
-a3 - a4 + 2/3*a5 + 4
-b3 - b4 + 2/3*b5 - 1
-c3 - c4 + 2/3*c5 - 3
-a4 + 1/3*a5 + 2
-b4 + 1/3*b5
-c4 + 1/3*c5 - 2
sage: ew[1]
(0, 0, 0, 0, 0, -2/3, -2/3, 2/3)
sage: ew[6]
(0, 0, 0, 0, 1, -1/3, -1/3, 1/3)
sage: ### reloading attached file a1.sage modified at 20:01:56 ###
resg()
2/3*a5 + 2
2/3*b5
2/3*c5 - 2
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 2
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 5/6*a5 + 4
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 5/6*b5 - 1
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 5/6*c5 - 3
-a2 - a3 - a4 + a5 + 6
-b2 - b3 - b4 + b5 - 3
-c2 - c3 - c4 + c5 - 3
-a3 - a4 + 2/3*a5 + 4
-b3 - b4 + 2/3*b5 - 1
-c3 - c4 + 2/3*c5 - 3
-a4 + 1/3*a5 + 2
-b4 + 1/3*b5
-c4 + 1/3*c5 - 2
sage: ### reloading attached file a1.sage modified at 20:02:47 ###
resg()
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 3/2
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 - 1
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 3/2
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 - 1
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/2
-a2 - a3 - a4 + 3
-b2 - b3 - b4 - 3
-c2 - c3 - c4
-a3 - a4 + 2
-b3 - b4 - 1
-c3 - c4 - 1
-a4 + 1
-b4
-c4 - 1
sage: ### reloading attached file a1.sage modified at 20:03:08 ###
resg()
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 + 1
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 + 1
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3
-a2 - a3 + 2
-b2 - b3 - 3
-c2 - c3 + 1
-a3 + 1
-b3 - 1
-c3
0
0
0
sage: ### reloading attached file a1.sage modified at 20:03:20 ###
resg()
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 + 1/2
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2
-1/2*c0 - 1/2*c1 - 1/2*c2
1/2*a0 - 1/2*a1 - 1/2*a2 + 1/2
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2
1/2*c0 - 1/2*c1 - 1/2*c2
-a2 + 1
-b2 - 2
-c2 + 1
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:03:34 ###
resg()
0
0
0
-1/2*a0 - 1/2*a1
-1/2*b0 - 1/2*b1
-1/2*c0 - 1/2*c1 - 1/2
1/2*a0 - 1/2*a1
1/2*b0 - 1/2*b1
1/2*c0 - 1/2*c1 - 1/2
0
-1
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:04:15 ###
resg()
0
0
0
-1/2*a0 - 1/2*a1
-1/2*b0 - 1/2*b1 + 1/2
-1/2*c0 - 1/2*c1 - 1/2
1/2*a0 - 1/2*a1
1/2*b0 - 1/2*b1 + 1/2
1/2*c0 - 1/2*c1 - 1/2
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:05:09 ###
resg()
0
0
0
0
-1/2*b0 - 1/2*b1 + 1/2
-1/2*c0 - 1/2*c1 - 1/2
0
1/2*b0 - 1/2*b1 + 1/2
1/2*c0 - 1/2*c1 - 1/2
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:21:44 ###
resg()
0
0
0
0
1
0
0
1
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:22:04 ###
resg()
0
0
0
0
-1/2*b0 - 1/2*b1 + 1/2
0
0
1/2*b0 - 1/2*b1 + 1/2
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:22:27 ###
### reloading attached file a1.sage modified at 20:22:34 ###
resg()
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: for r in E6.simple_roots(): print r
(1/2, -1/2, -1/2, -1/2, -1/2, -1/2, -1/2, 1/2)
(1, 1, 0, 0, 0, 0, 0, 0)
(-1, 1, 0, 0, 0, 0, 0, 0)
(0, -1, 1, 0, 0, 0, 0, 0)
(0, 0, -1, 1, 0, 0, 0, 0)
(0, 0, 0, -1, 1, 0, 0, 0)
sage: ### reloading attached file a1.sage modified at 20:23:41 ###
resg()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-43-b6b1b265e156> in <module>()
----> 1 resg()

/Users/bump/.sage/temp/meep2/15418/a1.sageUpGycz.py in resg()
    128         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
    129         return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
--> 130     print f([X0,X1,X2,X3,X4,X5,X5,-X5])
    131 
    132     def comp(u,k):

/Users/bump/.sage/temp/meep2/15418/a1.sageUpGycz.py in f(x)
    126 
    127     def f(x):
--> 128         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
    129         return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    130     print f([X0,X1,X2,X3,X4,X5,X5,-X5])

AttributeError: 'list' object has no attribute 'to_vector'
sage: ### reloading attached file a1.sage modified at 20:24:03 ###
resg()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-44-b6b1b265e156> in <module>()
----> 1 resg()

/Users/bump/.sage/temp/meep2/15418/a1.sage1I0beI.py in resg()
    128         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
    129         return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
--> 130     print f((X0,X1,X2,X3,X4,X5,X5,-X5))
    131 
    132     def comp(u,k):

/Users/bump/.sage/temp/meep2/15418/a1.sage1I0beI.py in f(x)
    126 
    127     def f(x):
--> 128         [x0,x1,x2,x3,x4,x5,x6,x7]=x.to_vector()
    129         return [a0*x0+a1*x1+a2*x2+a3*x3+a4*x4+a5*x5,b0*x0+b1*x1+b2*x2+b3*x3+b4*x4+b5*x5,c0*x0+c1*x1+c2*x2+c3*x3+c4*x4+c5*x5]
    130     print f((X0,X1,X2,X3,X4,X5,X5,-X5))

AttributeError: 'tuple' object has no attribute 'to_vector'
sage: ### reloading attached file a1.sage modified at 20:24:54 ###
### reloading attached file a1.sage modified at 20:25:04 ###
resg()
[X2 + X3 + X4 - 3*X5, X1 - 2*X2 - X3, -X1 + X2 - X4 + 3*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 20:27:49 ###
E6(1,0,0,0,0,0).degree()
27
sage: E6(1,0,0,0,0,0).branch(G2,b)
G2(2,0)
sage: E6(0,0,0,0,0,1).branch(G2,b)
G2(2,0)
sage: E6(0,1,0,0,0,0).degree()
78
sage: E6(0,1,0,0,0,0).branch(G2,b)
G2(0,1) + G2(1,1)
sage: E6(0,0,0,0,1,0).branch(G2,b)
G2(1,0) + G2(0,1) + G2(1,1) + G2(3,0) + G2(2,1)
sage: E6(0,0,0,0,1,0).degree()
351
sage: E6.dynkin_diagram()
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6
sage: b.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => G2:

  3
O=<=O
1   2
G2

1 => 1
2 => 1
3 => 1
5 => 1
6 => 1

For more detailed information use verbose=True
sage: b.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => G2:

  3
O=<=O
1   2
G2

0 => weight (-3, 1, 2)
1 => 1
2 => 1
3 => 1
4 => weight (1, -3, 2)
5 => 1
6 => 1

fundamental weight restrictions E6 => G2:
1 => (2, 0)
2 => (1, 1)
3 => (2, 1)
4 => (0, 3)
5 => (2, 1)
6 => (2, 0)
sage: E6(2,0).degree()
351
sage: E6(2,0).branch(G2,b)
G2(0,0) + G2(2,0) + G2(1,1) + G2(0,2) + G2(4,0)
sage: E6(1,1,0).degree()
1728
sage: E6(0,1,0).degree()
78
sage: E6(0,0,1).degree()
351
sage: E6(1,0,1).degree()
5824
sage: E6(0,1,1).degree()
17550
sage: E6(1,0,0,0,0,1).degree()
650
sage: E6(1,0,0,0,0,1).branch(G2,b)
G2(1,0) + 2*G2(2,0) + G2(1,1) + G2(3,0) + G2(0,2) + G2(2,1) + G2(4,0)
sage: 
Exiting Sage (CPU time 0m13.57s, Wall time 82m20.10s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 4.0972700119 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00448393821716 seconds
Total time spent compiling C/C++ extensions:  0.201018095016 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m6.321s
user	0m3.085s
sys	0m0.777s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage:  %attach /Users/bump/branch/a1.sage
sage: 
Exiting Sage (CPU time 0m6.99s, Wall time 6m39.70s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: time E6(0,0,0,0,0,2).branch(G2,"miscellaneous")
/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.py:371: DeprecationWarning: Use %time instead of time.
See http://trac.sagemath.org/12719 for details.
  line = f(line, line_number)
CPU times: user 0.55 s, sys: 0.05 s, total: 0.59 s
Wall time: 0.56 s
G2(0,0) + G2(2,0) + G2(1,1) + G2(0,2) + G2(4,0)
sage: 
Exiting Sage (CPU time 0m6.43s, Wall time 0m51.92s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-26-13-03-54-975d0434.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [477 tests, 25.73 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 25.9 seconds
    cpu time: 25.6 seconds
    cumulative wall time: 25.7 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t weyl_characters.py 
Running doctests with ID 2013-12-26-13-04-34-bae6f84c.
Doctesting 1 file.
sage -t weyl_characters.py
    [463 tests, 12.00 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 12.2 seconds
    cpu time: 11.9 seconds
    cumulative wall time: 12.0 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-1-9c4d2dd2ba0a> in <module>()
----> 1 get_ipython().magic(u'attach /Users/bump/branch/a1.sage')

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2134         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2135         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2136         return self.run_line_magic(magic_name, magic_arg_s)
   2137 
   2138     #-------------------------------------------------------------------------

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2060                 args.append(sys._getframe(stack_depth).f_locals)
   2061             with self.builtin_trap:
-> 2062                 result = fn(*args)
   2063             return result
   2064 

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    189     # but it's overkill for just that one bit of state.
    190     def magic_deco(arg):
--> 191         call = lambda f, *a, **k: f(*a, **k)
    192 
    193         if callable(arg):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/sage_extension.pyc in attach(self, s)
    118         """
    119         from sage.misc.preparser import load_wrap
--> 120         return self.shell.ex(load_wrap(s, attach=True))
    121 
    122     @line_magic

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in ex(self, cmd)
   2382         """Execute a normal python statement in user namespace."""
   2383         with self.builtin_trap:
-> 2384             exec cmd in self.user_global_ns, self.user_ns
   2385 
   2386     def ev(self, expr):

<string> in <module>()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/misc/preparser.pyc in load(filename, globals, attach)
   1766             # See Trac 11812.
   1767             exec_file_is(fpath)
-> 1768             execfile(preparse_file_named(fpath), globals)
   1769         else:
   1770             # Preparse in memory only for speed.

/Users/bump/.sage/temp/meep2/15716/a1.sageKH7GHM.py in <module>()
    144     comp(_sage_const_2 *gw[_sage_const_1 ],_sage_const_6 )
    145 
--> 146 aw[_sage_const_1 ] = (_sage_const_2 /_sage_const_3 ,-_sage_const_1 /_sage_const_3 ,-_sage_const_1 /_sage_const_3 )
    147 aw[_sage_const_2 ] = (_sage_const_1 /_sage_const_3 ,_sage_const_1 /_sage_const_3 ,-_sage_const_2 /_sage_const_3 )
    148 

NameError: name 'aw' is not defined
sage: ### reloading attached file a1.sage modified at 21:25:02 ###
sage
<module 'sage' from '/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/__init__.pyc'>
sage: 
Exiting Sage (CPU time 0m6.07s, Wall time 0m41.64s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
sage: resa()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 + X5*a5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + X5*b5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + X5*c5]
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-2-d6854edb1e30> in <module>()
----> 1 resa()

/Users/bump/.sage/temp/meep2/15759/a1.sage9TkWVV.py in resa()
    162         for i in range(_sage_const_3 ):
    163             print u[i]-v[i]
--> 164     comp(_sage_const_2 *gw[_sage_const_1 ]+_sage_const_2 *gw[_sage_const_2 ],_sage_const_1 )
    165     comp(gw[_sage_const_1 ]+_sage_const_4 *gw[_sage_const_2 ],_sage_const_2 )
    166     comp(_sage_const_2 *gw[_sage_const_1 ]+_sage_const_5 *gw[_sage_const_2 ],_sage_const_3 )

NameError: global name 'gw' is not defined
sage: ### reloading attached file a1.sage modified at 21:25:39 ###
resa()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 + X5*a5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + X5*b5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + X5*c5]
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-3-d6854edb1e30> in <module>()
----> 1 resa()

/Users/bump/.sage/temp/meep2/15759/a1.sageqVo2U9.py in resa()
    162         for i in range(_sage_const_3 ):
    163             print u[i]-v[i]
--> 164     comp(_sage_const_2 *aw[_sage_const_1 ]+_sage_const_2 *aw[_sage_const_2 ],_sage_const_1 )
    165     comp(aw[_sage_const_1 ]+_sage_const_4 *aw[_sage_const_2 ],_sage_const_2 )
    166     comp(_sage_const_2 *aw[_sage_const_1 ]+_sage_const_5 *aw[_sage_const_2 ],_sage_const_3 )

/Users/bump/.sage/temp/meep2/15759/a1.sageqVo2U9.py in comp(u, k)
    159 
    160     def comp(u,k):
--> 161         v = vector(f(ew[k]))
    162         for i in range(_sage_const_3 ):
    163             print u[i]-v[i]

NameError: global name 'ew' is not defined
sage: ### reloading attached file a1.sage modified at 21:26:22 ###
resa()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 + X5*a5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + X5*b5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + X5*c5]
2/3*a5 + 2/3
2/3*b5 - 1/3
2/3*c5 - 1/3
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 2/3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1/3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 1/3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 5/6*a5 + 2/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 5/6*b5 - 1/3
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 5/6*c5 - 1/3
-a2 - a3 - a4 + a5 + 1/3
-b2 - b3 - b4 + b5 + 1/3
-c2 - c3 - c4 + c5 - 2/3
-a3 - a4 + 2/3*a5 + 2/3
-b3 - b4 + 2/3*b5 - 1/3
-c3 - c4 + 2/3*c5 - 1/3
-a4 + 1/3*a5 + 2/3
-b4 + 1/3*b5 - 1/3
-c4 + 1/3*c5 - 1/3
sage: ### reloading attached file a1.sage modified at 21:27:13 ###
resa()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/12
-a2 - a3 - a4 - 2/3
-b2 - b3 - b4 + 5/6
-c2 - c3 - c4 - 1/6
-a3 - a4
-b3 - b4
-c3 - c4
-a4 + 1/3
-b4 - 1/6
-c4 - 1/6
sage: ### reloading attached file a1.sage modified at 21:27:46 ###
resa()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 + 1/6
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 + 1/6
-a2 - a3 - 1
-b2 - b3 + 1
-c2 - c3
-a3 - 1/3
-b3 + 1/6
-c3 + 1/6
0
0
0
sage: ### reloading attached file a1.sage modified at 21:28:10 ###
resa()
[X0*a0 + X1*a1 + X2*a2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 + 1/12
-a2 - 2/3
-b2 + 5/6
-c2 - 1/6
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:28:34 ###
resa()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
-1/2*c0 - 1/2*c1
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
1/2*c0 - 1/2*c1 + 1/6
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:29:34 ###
resa()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -X0*c1 + X1*c1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
-c1 + 1/6
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:29:48 ###
resa()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
-1/2*c0 - 1/2*c1
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
1/2*c0 - 1/2*c1 + 1/6
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:29:57 ###
resa()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -X0*c1 + X1*c1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
-c1 + 1/6
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:30:08 ###
resa()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
0
0
0
0
0
0
0
0
0
0
sage: -1/2*a0 - 1/2*a1 + 1/2 + 1/2*a0 - 1/2*a1 + 1/6
-a1 + 2/3
sage: ### reloading attached file a1.sage modified at 21:30:46 ###
-1/2*a0 - 1/2*a1 + 1/2 + 1/2*a0 - 1/2*a1 + 1/6
-a1 + 2/3
sage: resa()
[X0*a0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 + 1/6
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/6
1/2*b0 - 1/2*b1 - 1/3
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:31:14 ###
resa()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
-1/2*b0 - 1/2*b1 - 1/2
0
0
1/2*b0 - 1/2*b1 - 1/3
0
0
0
0
0
0
0
0
0
0
sage: 1/2*b0 - 1/2*b1 - 1/3 -1/2*b0 - 1/2*b1 - 1/2
-b1 - 5/6
sage: ### reloading attached file a1.sage modified at 21:31:41 ###
resa()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
-1/2*b0 - 1/12
0
0
1/2*b0 + 1/12
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 21:31:55 ###
resa()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: f([X0,X1,X2,X3,X4,X5,X5,-X5])
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-20-e09ee77cc42a> in <module>()
----> 1 f([X0,X1,X2,X3,X4,X5,X5,-X5])

NameError: name 'f' is not defined
sage: resa()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: dirs
[]
sage: dirs
[]
sage: resa()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: [6*u for u in [1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]]
[2*X0 + 4*X1 - 4*X2 - 2*X3 + 2*X4 - 6*X5,
 -X0 - 5*X1 + 5*X2 + X3 - X4 + 3*X5,
 -X0 + X1 - X2 + X3 - X4 + 3*X5]
sage: ### reloading attached file a1.sage modified at 21:38:20 ###
  File "/Users/bump/.sage/temp/meep2/15759/a1.sagejA95mo.py", line 193
    
    ^
SyntaxError: invalid syntax

sage: ### reloading attached file a1.sage modified at 21:38:20 ###
sage: E6(1,0,0,0,0,0).branch(A2,rule=c)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-27-419f9ef1e45f> in <module>()
----> 1 E6(Integer(1),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0)).branch(A2,rule=c)

NameError: name 'c' is not defined
sage: ### reloading attached file a1.sage modified at 21:38:50 ###
E6(1,0,0,0,0,0).branch(A2,rule=c)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-28-419f9ef1e45f> in <module>()
----> 1 E6(Integer(1),Integer(0),Integer(0),Integer(0),Integer(0),Integer(0)).branch(A2,rule=c)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2296         else:
   2297             mdict[h] = chi_mdict[k]
-> 2298     return S.char_from_weights(mdict)
   2299 
   2300 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: b(f) for f in E6.simple_roots()
  File "<ipython-input-29-9195888c7602>", line 1
    b(f) for f in E6.simple_roots()
           ^
SyntaxError: invalid syntax

sage: c.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => A2:

O---O
1   2
A2

2 => 1

For more detailed information use verbose=True
sage: c.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => A2:

O---O
1   2
A2

0 => weight (-2/3, 1/3, 1/3)
1 => weight (2/3, -1/3, -1/3)
2 => 1
3 => weight (1/3, -2/3, 1/3)
4 => weight (-4/3, 5/3, -1/3)
5 => weight (1/3, -2/3, 1/3)
6 => weight (2/3, -1/3, -1/3)

fundamental weight restrictions E6 => A2:
1 => (1, 0)
2 => (1, 0)
3 => (1, 0)
4 => (0, 1)
5 => (1, 0)
6 => (1, 0)
sage: E6.simple_roots()
Finite family {1: (1/2, -1/2, -1/2, -1/2, -1/2, -1/2, -1/2, 1/2), 2: (1, 1, 0, 0, 0, 0, 0, 0), 3: (-1, 1, 0, 0, 0, 0, 0, 0), 4: (0, -1, 1, 0, 0, 0, 0, 0), 5: (0, 0, -1, 1, 0, 0, 0, 0), 6: (0, 0, 0, -1, 1, 0, 0, 0)}
sage: 
Exiting Sage (CPU time 0m11.08s, Wall time 82m3.43s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: 
Exiting Sage (CPU time 0m5.99s, Wall time 1m11.24s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/e6.sage
sage: b = branching_rule("E6","G2","miscellaneous")
sage: E6.branch(G2,b)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-3-6770ffbc2ebb> in <module>()
----> 1 E6.branch(G2,b)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:6823)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1606)()

AttributeError: 'WeylCharacterRing_with_category' object has no attribute 'branch'
sage: E6(1,0).branch(G2,b)
G2(2,0)
sage: b(E6.fundamental_weights()[1])
[2, 0, -2]
sage: G2.fundamental_weights()[1]
(1, 0, -1)
sage: A2(2,2).degree()
27
sage: resa1
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-8-eb673f112e8d> in <module>()
----> 1 resa1

NameError: name 'resa1' is not defined
sage: %attach /Users/bump/branch/a1.sage
sage: ### reloading attached file a1.sage modified at 23:53:45 ###
resa1()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 + X5*a5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + X5*b5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + X5*c5]
2/3*a5 + 2/3
2/3*b5 - 1/3
2/3*c5 - 1/3
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 2/3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1/3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 1/3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 5/6*a5 + 2/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 5/6*b5 - 1/3
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 5/6*c5 - 1/3
-a2 - a3 - a4 + a5 + 1/3
-b2 - b3 - b4 + b5 + 1/3
-c2 - c3 - c4 + c5 - 2/3
-a3 - a4 + 2/3*a5 + 2/3
-b3 - b4 + 2/3*b5 - 1/3
-c3 - c4 + 2/3*c5 - 1/3
-a4 + 1/3*a5 + 2/3
-b4 + 1/3*b5 - 1/3
-c4 + 1/3*c5 - 1/3
sage: ### reloading attached file a1.sage modified at 23:54:23 ###
resa1()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/12
-a2 - a3 - a4 - 2/3
-b2 - b3 - b4 + 5/6
-c2 - c3 - c4 - 1/6
-a3 - a4
-b3 - b4
-c3 - c4
-a4 + 1/3
-b4 - 1/6
-c4 - 1/6
sage: ### reloading attached file a1.sage modified at 23:54:43 ###
resa1()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 + 1/6
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 + 1/6
-a2 - a3 - 1
-b2 - b3 + 1
-c2 - c3
-a3 - 1/3
-b3 + 1/6
-c3 + 1/6
0
0
0
sage: ### reloading attached file a1.sage modified at 23:55:07 ###
resa1()
[X0*a0 + X1*a1 + X2*a2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 + 1/12
-a2 - 2/3
-b2 + 5/6
-c2 - 1/6
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:55:31 ###
resa1()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
-1/2*c0 - 1/2*c1
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
1/2*c0 - 1/2*c1 + 1/6
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:55:57 ###
resa1()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 - X1*c0 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
c0 + 1/6
0
0
0
0
0
0
0
0
0
sage: 1/2*a0 - 1/2*a1 + 1/6-1/2*a0 - 1/2*a1 + 1/2
-a1 + 2/3
sage: -1/2*b0 - 1/2*b1 - 1/2+1/2*b0 - 1/2*b1 - 1/3
-b1 - 5/6
sage: ### reloading attached file a1.sage modified at 23:56:52 ###
-1/2*b0 - 1/2*b1 - 1/2+1/2*b0 - 1/2*b1 - 1/3
-b1 - 5/6
sage: resa1()
[X0*a0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 + 1/6
-1/2*b0 - 11/12
0
1/2*a0 - 1/6
1/2*b0 - 3/4
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:57:21 ###
resa1()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, 3/2*X0 + 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
-5/3
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:57:29 ###
resa1()
[X0*a0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, 3/2*X0 + 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 + 1/6
-5/3
0
1/2*a0 - 1/6
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:57:35 ###
resa1()
[X0*a0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 + 1/6
-1/2*b0 - 11/12
0
1/2*a0 - 1/6
1/2*b0 - 3/4
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:57:47 ###
resa1()
[X0*a0 + X1*a1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/2
-1/2*b0 - 1/2*b1 - 1/2
0
1/2*a0 - 1/2*a1 + 1/6
1/2*b0 - 1/2*b1 - 1/3
0
0
0
0
0
0
0
0
0
0
sage: -1/2*a0 - 1/2*a1 + 1/2+1/2*a0 - 1/2*a1 + 1/6
-a1 + 2/3
sage: -1/2*b0 - 1/2*b1 - 1/2+1/2*b0 - 1/2*b1 - 1/3
-b1 - 5/6
sage: ### reloading attached file a1.sage modified at 23:58:34 ###
resa1()
[X0*a0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 + 1/6
-1/2*b0 - 1/12
0
1/2*a0 - 1/6
1/2*b0 + 1/12
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:59:01 ###
resa1()
[1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 23:59:18 ###
[6*y for y in [1/3*X0 + 2/3*X1 - 2/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 5/6*X1 + 5/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 + 1/6*X1 - 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]]
[2*X0 + 4*X1 - 4*X2 - 2*X3 + 2*X4 - 6*X5,
 -X0 - 5*X1 + 5*X2 + X3 - X4 + 3*X5,
 -X0 + X1 - X2 + X3 - X4 + 3*X5]
sage: ### reloading attached file a1.sage modified at 00:05:07 ###

sage: E6(1,0).branch("A2",d)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-29-df037b8a7a41> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch("A2",d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2276         rule = branching_rule(R._cartan_type, S._cartan_type, rule)
   2277     if hasattr(rule,"_S"):
-> 2278         if rule._S != S.cartan_type():
   2279             raise ValueError,"rule has wrong target Cartan type"
   2280     mdict = {}

AttributeError: 'str' object has no attribute 'cartan_type'
sage: ### reloading attached file a1.sage modified at 00:05:37 ###
d
misc branching rule E6 => A2
sage: d.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => A2:

O---O
1   2
A2

2 => 1

For more detailed information use verbose=True
sage: E6(1,0).branch(A2,d)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-32-9e2737d2edb6> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch(A2,d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2296         else:
   2297             mdict[h] = chi_mdict[k]
-> 2298     return S.char_from_weights(mdict)
   2299 
   2300 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: b(E6.fundamental_weights()[1])
[2, 0, -2]
sage: A2.fundamental_weights()
Finite family {1: (1, 0, 0), 2: (1, 1, 0)}
sage: E6(1,0).weight_multiplicities()
{(-1, 0, 0, 0, 0, 1/3, 1/3, -1/3): 1,
 (-1/2, -1/2, -1/2, -1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, -1/2, -1/2, 1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, -1/2, 1/2, -1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, -1/2, 1/2, 1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, 1/2, -1/2, -1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, 1/2, -1/2, 1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, 1/2, 1/2, -1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (-1/2, 1/2, 1/2, 1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (1/2, -1/2, -1/2, -1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (1/2, -1/2, -1/2, 1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (1/2, -1/2, 1/2, -1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (1/2, -1/2, 1/2, 1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (1/2, 1/2, -1/2, -1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (1/2, 1/2, -1/2, 1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (1/2, 1/2, 1/2, -1/2, 1/2, -1/6, -1/6, 1/6): 1,
 (1/2, 1/2, 1/2, 1/2, -1/2, -1/6, -1/6, 1/6): 1,
 (1, 0, 0, 0, 0, 1/3, 1/3, -1/3): 1,
 (0, -1, 0, 0, 0, 1/3, 1/3, -1/3): 1,
 (0, 1, 0, 0, 0, 1/3, 1/3, -1/3): 1,
 (0, 0, -1, 0, 0, 1/3, 1/3, -1/3): 1,
 (0, 0, 1, 0, 0, 1/3, 1/3, -1/3): 1,
 (0, 0, 0, -1, 0, 1/3, 1/3, -1/3): 1,
 (0, 0, 0, 1, 0, 1/3, 1/3, -1/3): 1,
 (0, 0, 0, 0, -1, 1/3, 1/3, -1/3): 1,
 (0, 0, 0, 0, 1, 1/3, 1/3, -1/3): 1,
 (0, 0, 0, 0, 0, -2/3, -2/3, 2/3): 1}
sage: [b(v) for v in E6(1,0).weight_multiplicities().keys()]
[[2, -2, 0],
 [0, -2, 2],
 [-1, -1, 2],
 [1, -2, 1],
 [1, -1, 0],
 [-2, 1, 1],
 [0, -1, 1],
 [0, 0, 0],
 [2, -1, -1],
 [-1, 1, 0],
 [-1, 0, 1],
 [-1, 1, 0],
 [0, 2, -2],
 [-1, 2, -1],
 [0, -1, 1],
 [0, 0, 0],
 [0, 1, -1],
 [1, 0, -1],
 [1, 0, -1],
 [-2, 0, 2],
 [1, -1, 0],
 [2, 0, -2],
 [-2, 2, 0],
 [0, 0, 0],
 [1, 1, -2],
 [-1, 0, 1],
 [0, 1, -1]]
sage: A2(2,2)
A2(2,2)
sage: A2(2,2).degree()
27
sage: A2(2,2).weight_multiplicities()
{(0, 0, 0): 3,
 (-2, 1, 1): 1,
 (-2, 2, 0): 1,
 (-2, 0, 2): 1,
 (-1, -1, 2): 1,
 (-1, 1, 0): 2,
 (-1, 2, -1): 1,
 (-1, 0, 1): 2,
 (1, -2, 1): 1,
 (1, -1, 0): 2,
 (1, 1, -2): 1,
 (1, 0, -1): 2,
 (2, -2, 0): 1,
 (2, -1, -1): 1,
 (2, 0, -2): 1,
 (0, -2, 2): 1,
 (0, -1, 1): 2,
 (0, 1, -1): 2,
 (0, 2, -2): 1}
sage: E6(1,0).branch(A2,rule=d)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-40-5d67829ec3fc> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch(A2,rule=d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    991                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    992             """
--> 993             return branch_weyl_character(self, self.parent(), S, rule=rule)
    994 
    995         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2296         else:
   2297             mdict[h] = chi_mdict[k]
-> 2298     return S.char_from_weights(mdict)
   2299 
   2300 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    895             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
    896         """
--> 897         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    898 
    899     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    922             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    923             if not highest.is_dominant():
--> 924                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    925             sdict = self._irr_weights(highest)
    926             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: A2
The Weyl Character Ring of Type A2 with Integer Ring coefficients
sage: A2._style
'coroots'
sage: 
Exiting Sage (CPU time 0m12.59s, Wall time 102m30.12s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 5.55766391754 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0179069042206 seconds
Total time spent compiling C/C++ extensions:  0.227963924408 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m8.400s
user	0m3.071s
sys	0m0.858s
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.58569788933 seconds)
running install
running build
running build_py
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.00379180908203 seconds
Total time spent compiling C/C++ extensions:  0.134119987488 seconds.
running install_lib
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.769s
user	0m2.972s
sys	0m0.686s
~/sagemath/sage/src/sage/combinat/root_system:$ A2=WeylCharacterRing("A2",style="coroots")
bash: syntax error near unexpected token `('
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: A2=WeylCharacterRing("A2",style="coroots")
sage: E6=WeylCharacterRing("E6",style="coroots")
sage: d = BranchingRule(CartanType("E6"), CartanType("A2"), lambda x: [(2*x[0]+4*x[1]-4*x[2]-2*x[3]+2*x[4]-6*x[5])/6,(-x[0]-5*x[1]+5*x[2]+x[3]-x[4]+3*x[5])/6,(-x[0]+x[1]-x[2]+x[3]-x[4]+3*x[5])/6],"misc")

sage: sage: E6(1,0).branch(A2,rule=d)
{(-1/3, 2/3, -1/3): 3, (-1, 1, 0): 3, (2/3, -1/3, -1/3): 3, (-2/3, 1/3, 1/3): 3, (1/3, -2/3, 1/3): 3, (0, 0, 0): 9, (1, -1, 0): 3}
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-4-5d67829ec3fc> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch(A2,rule=d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    992                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    993             """
--> 994             return branch_weyl_character(self, self.parent(), S, rule=rule)
    995 
    996         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2303         else:
   2304             mdict[h] = chi_mdict[k]
-> 2305     return S.char_from_weights(mdict)
   2306 
   2307 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    896         """
    897         print mdict
--> 898         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    899 
    900     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    923             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    924             if not highest.is_dominant():
--> 925                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    926             sdict = self._irr_weights(highest)
    927             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: E6(1,0).branch(A2,rule=d)
{(-1/3, 2/3, -1/3): 3, (-1, 1, 0): 3, (2/3, -1/3, -1/3): 3, (-2/3, 1/3, 1/3): 3, (1/3, -2/3, 1/3): 3, (0, 0, 0): 9, (1, -1, 0): 3}
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-5-5d67829ec3fc> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch(A2,rule=d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    992                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    993             """
--> 994             return branch_weyl_character(self, self.parent(), S, rule=rule)
    995 
    996         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2303         else:
   2304             mdict[h] = chi_mdict[k]
-> 2305     return S.char_from_weights(mdict)
   2306 
   2307 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    896         """
    897         print mdict
--> 898         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    899 
    900     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    923             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    924             if not highest.is_dominant():
--> 925                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    926             sdict = self._irr_weights(highest)
    927             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: d
misc branching rule E6 => A2
sage: d.describe()

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => A2:

O---O
1   2
A2

2 => 1

For more detailed information use verbose=True
sage: d.describe(verbose=true0
....: )
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-8-ddf2cd98f41f> in <module>()
----> 1 d.describe(verbose=true0
      2 )

NameError: name 'true0' is not defined
sage: d.describe(verbose=true)

        O 0
        |
        |
        O 2
        |
        |
O---O---O---O---O
1   3   4   5   6
E6~
root restrictions E6 => A2:

O---O
1   2
A2

0 => weight (-2/3, 1/3, 1/3)
1 => weight (2/3, -1/3, -1/3)
2 => 1
3 => weight (1/3, -2/3, 1/3)
4 => weight (-4/3, 5/3, -1/3)
5 => weight (1/3, -2/3, 1/3)
6 => weight (2/3, -1/3, -1/3)

fundamental weight restrictions E6 => A2:
1 => (1, 0)
2 => (1, 0)
3 => (1, 0)
4 => (0, 1)
5 => (1, 0)
6 => (1, 0)
sage: [drule(m) for m in E6(1,0).weight_multiplicities().keys()]
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-10-0e64a9f1059a> in <module>()
----> 1 [drule(m) for m in E6(Integer(1),Integer(0)).weight_multiplicities().keys()]

NameError: name 'drule' is not defined
sage: 
  File "/Users/bump/.sage/temp/meep2/16327/a1.sagejqmoWk.py", line 236
    d = BranchingRule(CartanType("E6"), CartanType("A2"), rule=drule,"misc")
SyntaxError: non-keyword arg after keyword arg

sage: ### reloading attached file a1.sage modified at 00:50:39 ###
E6(1,0).branch(A2,rule=d)
{(-1/3, 2/3, -1/3): 3, (-1, 1, 0): 3, (2/3, -1/3, -1/3): 3, (-2/3, 1/3, 1/3): 3, (1/3, -2/3, 1/3): 3, (0, 0, 0): 9, (1, -1, 0): 3}
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-12-5d67829ec3fc> in <module>()
----> 1 E6(Integer(1),Integer(0)).branch(A2,rule=d)

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch(self, S, rule)
    992                 A2(-1/2,-1/2,-1/2) + A2(1/2,-1/2,-1/2) + A2(1/2,1/2,-1/2) + A2(1/2,1/2,1/2)]
    993             """
--> 994             return branch_weyl_character(self, self.parent(), S, rule=rule)
    995 
    996         def __pow__(self, n):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in branch_weyl_character(chi, R, S, rule)
   2303         else:
   2304             mdict[h] = chi_mdict[k]
-> 2305     return S.char_from_weights(mdict)
   2306 
   2307 class BranchingRule(SageObject):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in char_from_weights(self, mdict)
    896         """
    897         print mdict
--> 898         return self._from_dict(self._char_from_weights(mdict), coerce=True)
    899 
    900     def _char_from_weights(self, mdict):

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in _char_from_weights(self, mdict)
    923             highest = max((x.inner_product(self._space.rho()),x) for x in ddict)[1]
    924             if not highest.is_dominant():
--> 925                 raise ValueError("multiplicity dictionary may not be Weyl group invariant")
    926             sdict = self._irr_weights(highest)
    927             c = ddict[highest]

ValueError: multiplicity dictionary may not be Weyl group invariant
sage: [drule(m) for m in E6(1,0).weight_multiplicities().keys()]
[[-1/3, 2/3, -1/3],
 [-1, 1, 0],
 [-1, 1, 0],
 [-1, 1, 0],
 [0, 0, 0],
 [0, 0, 0],
 [-1/3, 2/3, -1/3],
 [0, 0, 0],
 [0, 0, 0],
 [1/3, -2/3, 1/3],
 [0, 0, 0],
 [0, 0, 0],
 [1, -1, 0],
 [1, -1, 0],
 [-2/3, 1/3, 1/3],
 [0, 0, 0],
 [2/3, -1/3, -1/3],
 [0, 0, 0],
 [2/3, -1/3, -1/3],
 [-2/3, 1/3, 1/3],
 [-1/3, 2/3, -1/3],
 [2/3, -1/3, -1/3],
 [1/3, -2/3, 1/3],
 [0, 0, 0],
 [1, -1, 0],
 [-2/3, 1/3, 1/3],
 [1/3, -2/3, 1/3]]
sage: b
g2 branching rule E6 => G2
sage: ### reloading attached file a1.sage modified at 00:55:35 ###

sage: E6(1,0).branch(A2,rule=e)
{(1, 0, -1): 2, (-1, -1, 2): 1, (2, -2, 0): 1, (2, 0, -2): 1, (-2, 1, 1): 1, (0, -2, 2): 1, (1, -2, 1): 1, (0, 1, -1): 2, (1, 1, -2): 1, (2, -1, -1): 1, (0, 2, -2): 1, (0, 0, 0): 3, (-1, 0, 1): 2, (0, -1, 1): 2, (-2, 2, 0): 1, (-2, 0, 2): 1, (-1, 2, -1): 1, (-1, 1, 0): 2, (1, -1, 0): 2}
A2(2,2)
sage: E6(0,1).branch(A2,rule=e)
{(-1, -1, 2): 3, (-1, 2, -1): 3, (0, -2, 2): 2, (1, -2, 1): 3, (2, -1, -1): 3, (0, 2, -2): 2, (-2, 3, -1): 1, (-2, 0, 2): 2, (3, -1, -2): 1, (-2, -1, 3): 1, (2, 1, -3): 1, (-1, 3, -2): 1, (0, 1, -1): 5, (-2, 2, 0): 2, (-3, 1, 2): 1, (-1, 0, 1): 5, (2, -3, 1): 1, (-1, 1, 0): 5, (1, 0, -1): 5, (1, -3, 2): 1, (0, -1, 1): 5, (1, 1, -2): 3, (-3, 2, 1): 1, (3, -2, -1): 1, (2, -2, 0): 2, (1, 2, -3): 1, (-2, 1, 1): 3, (2, 0, -2): 2, (-1, -2, 3): 1, (0, 0, 0): 6, (1, -1, 0): 5}
A2(1,1) + A2(1,4) + A2(4,1)
sage: 
Exiting Sage (CPU time 0m7.50s, Wall time 27m30.01s).
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index e5ab7fa..3cbf454 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -894,6 +894,7 @@ class WeylCharacterRing(CombinatorialFreeModule):
             sage: A2.char_from_weights(d)
             -A2(2,1,1) - A2(2,2,0) + A2(3,1,0)
         """
+        print mdict
         return self._from_dict(self._char_from_weights(mdict), coerce=True)
 
     def _char_from_weights(self, mdict):
@@ -1968,12 +1969,14 @@ def branch_weyl_character(chi, R, S, rule="default"):
 
     .. RUBRIC:: Miscellaneous
 
-    Use ``rule="miscellaneous"`` for the following rules:
+    Use ``rule="miscellaneous"`` for the following rules embeddings of maximal subgroups,
+    all involving exceptional groups.
 
     .. MATH::
 
         \begin{aligned}
         B_3 & \to G_2,
+        E_6 & \to G_2,
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
@@ -1981,12 +1984,22 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
+    There is another more obvious embedding of `G_2` into `E_6`, but this is
+    a different one. It may be characterized by the condition that the
+    27-dimensional representations of `E_6` restrict irreducibly to `G_2`.
+
     EXAMPLES::
 
         sage: G2 = WeylCharacterRing("G2")
         sage: [fw1, fw2, fw3] = B3.fundamental_weights()
         sage: B3(fw1+fw3).branch(G2, rule="miscellaneous")
         G2(1,0,-1) + G2(2,-1,-1) + G2(2,0,-2)
+        sage: E6 = WeylCharacterRing("E6",style="coroots")
+        sage: G2 = WeylCharacterRing("G2",style="coroots")
+        sage: E6(1,0,0,0,0,0).branch(G2,"miscellaneous")
+        G2(2,0)
+        sage: E6(0,0,0,0,0,2).branch(G2,"miscellaneous") # long time (0.59s)
+        G2(0,0) + G2(2,0) + G2(1,1) + G2(0,2) + G2(4,0)
         sage: F4=WeylCharacterRing("F4",style="coroots")
         sage: G2xA1=WeylCharacterRing("G2xA1",style="coroots")
         sage: F4(0,0,1,0).branch(G2xA1,rule="miscellaneous")
@@ -2985,6 +2998,9 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[5],x[5]+x[4],x[5]-x[4],x[2]+x[3],x[1]-x[2],-x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3],x[1]-x[2],-x[1]-x[3],-2*x[5],x[5]+x[4],x[5]-x[4]], "miscellaneous")
+            else:
+                if Stype == CartanType("G2"):
+                    return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3]+x[4]-3*x[5], x[1]-2*x[2]-x[3], -x[1]+x[2]-x[4]+3*x[5]],"miscellaneous")
         elif Rtype == CartanType("E7"):
             if Stype.is_compound():
                 if stypes == [CartanType("C3"),CartanType("G2")]:
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 2.61829686165 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0042622089386 seconds
Total time spent compiling C/C++ extensions:  0.135544061661 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m3.813s
user	0m3.024s
sys	0m0.706s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach /Users/bump/branch/a1.sage
sage: E6(1,0).branch(A2,e)
A2(2,2)
sage: chi=E6(0,1); print chi.degree(); chi.branch(A2,e)
78
A2(1,1) + A2(1,4) + A2(4,1)
sage: chi=E6(0,0,1); print chi.degree(); chi.branch(A2,e)
351
A2(0,3) + A2(1,1) + A2(3,0) + A2(1,4) + A2(2,2) + A2(4,1) + A2(2,5) + A2(3,3) + A2(5,2)
sage: chi=E6(2,0); print chi.degree(); chi.branch(A2,e)
351
A2(0,0) + A2(1,1) + A2(1,4) + A2(0,6) + A2(2,2) + A2(4,1) + A2(3,3) + A2(6,0) + A2(4,4)
sage: chi=E6(1,0,0,0,0,1); print chi.degree(); chi.branch(A2,e)
    a5=-1
    b5=1/2
    c5=1/2
    a4=1/3
    b4=-1/6
    c4=-1/6
    a3=-1/3
    b3=1/6
    c3=1/6
    a2=-2/3
    b2=5/6
    c2=-1/6
    c0=-1/6
    c1=-c0
    a1=2/3
    b1=-5/6
    a0=1/3
    b0=-1/6
650
A2(0,3) + A2(1,1) + A2(3,0) + A2(1,4) + A2(0,6) + 3*A2(2,2) + A2(4,1) + A2(2,5) + 2*A2(3,3) + A2(6,0) + A2(5,2) + A2(4,4)
sage: for f in E6.fundamental_weights(): print e(f)
[2, 0, -2]
[3, -1, -2]
[4, -1, -3]
[6, -3, -3]
[4, -1, -3]
[2, 0, -2]
sage: for f in E6.fundamental_weights(): print [e(f).inner_product(a) for a in E6.simple_coroots()]
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-8-6317056a4017> in <module>()
----> 1 for f in E6.fundamental_weights(): print [e(f).inner_product(a) for a in E6.simple_coroots()]

AttributeError: 'list' object has no attribute 'inner_product'
sage: 
sage: for f in E6.fundamental_weights(): print [A2.space()(e(f)).inner_product(a) for a in A2.simple_coroots()]
[2, 2]
[4, 1]
[5, 2]
[9, 0]
[5, 2]
[2, 2]
sage: ### reloading attached file a1.sage modified at 01:32:09 ###
resa2()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 + X5*a5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + X5*b5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + X5*c5]
2/3*a5 + 2/3
2/3*b5 - 1/3
2/3*c5 - 1/3
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/2*a5 + 2/3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/2*b5 - 1/3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/2*c5 - 1/3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 5/6*a5 + 2/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 5/6*b5 - 1/3
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 5/6*c5 - 1/3
-a2 - a3 - a4 + a5 + 2/3
-b2 - b3 - b4 + b5 - 1/3
-c2 - c3 - c4 + c5 - 1/3
-a3 - a4 + 2/3*a5 + 2/3
-b3 - b4 + 2/3*b5 - 1/3
-c3 - c4 + 2/3*c5 - 1/3
-a4 + 1/3*a5 + 2/3
-b4 + 1/3*b5 - 1/3
-c4 + 1/3*c5 - 1/3
sage: ### reloading attached file a1.sage modified at 01:35:17 ###
resa2()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + X4*a4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 + X4*b4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 + X4*c4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/2*a4 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 - 1/2*b4 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 - 1/2*c4 + 1/12
-a2 - a3 - a4 - 1/3
-b2 - b3 - b4 + 1/6
-c2 - c3 - c4 + 1/6
-a3 - a4
-b3 - b4
-c3 - c4
-a4 + 1/3
-b4 - 1/6
-c4 - 1/6
sage: ### reloading attached file a1.sage modified at 01:35:41 ###
resa2()
[X0*a0 + X1*a1 + X2*a2 + X3*a3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + X3*b3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + X3*c3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/2*a3 - 1/3
1/2*b0 - 1/2*b1 - 1/2*b2 - 1/2*b3 + 1/6
1/2*c0 - 1/2*c1 - 1/2*c2 - 1/2*c3 + 1/6
-a2 - a3 - 2/3
-b2 - b3 + 1/3
-c2 - c3 + 1/3
-a3 - 1/3
-b3 + 1/6
-c3 + 1/6
0
0
0
sage: ### reloading attached file a1.sage modified at 01:36:02 ###
resa2()
[X0*a0 + X1*a1 + X2*a2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + X2*b2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + X2*c2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 - 1/2*a2 + 1/6
-1/2*b0 - 1/2*b1 - 1/2*b2 - 1/12
-1/2*c0 - 1/2*c1 - 1/2*c2 - 1/12
1/2*a0 - 1/2*a1 - 1/2*a2 - 1/6
1/2*b0 - 1/2*b1 - 1/2*b2 + 1/12
1/2*c0 - 1/2*c1 - 1/2*c2 + 1/12
-a2 - 1/3
-b2 + 1/6
-c2 + 1/6
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 01:36:22 ###
resa2()
[X0*a0 + X1*a1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b0 + X1*b1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c0 + X1*c1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-1/2*a0 - 1/2*a1 + 1/3
-1/2*b0 - 1/2*b1 - 1/6
-1/2*c0 - 1/2*c1 - 1/6
1/2*a0 - 1/2*a1
1/2*b0 - 1/2*b1
1/2*c0 - 1/2*c1
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 01:36:52 ###
resa2()
[X0*a1 + X1*a1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, X0*b1 + X1*b1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, X0*c1 + X1*c1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
-a1 + 1/3
-b1 - 1/6
-c1 - 1/6
0
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 01:37:10 ###
resa2()
[1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: for f in E6.fundamental_weights(): print e(f)
[2, 0, -2]
[3, -1, -2]
[4, -1, -3]
[6, -3, -3]
[4, -1, -3]
[2, 0, -2]
sage: for f in E6.fundamental_weights(): print [A2.space()(e(f)).inner_product(a) for a in A2.coroots()]
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-18-ec317520434c> in <module>()
----> 1 for f in E6.fundamental_weights(): print [A2.space()(e(f)).inner_product(a) for a in A2.coroots()]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:6823)()

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1606)()

AttributeError: 'WeylCharacterRing_with_category' object has no attribute 'coroots'
sage: for f in E6.fundamental_weights(): print [A2.space()(e(f)).inner_product(a) for a in A2.space().simple_coroots()]
[2, 2]
[4, 1]
[5, 2]
[9, 0]
[5, 2]
[2, 2]
sage: [u*6 for u in [1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]]
[2*X0 + 2*X1 - 2*X2 - 2*X3 + 2*X4 - 6*X5,  -X0 - X1 + X2 + X3 - X4 + 3*X5,  -X0 - X1 + X2 + X3 - X4 + 3*X5]
sage: def ea(x): return [u/6 for u in [2*x[0]+2*x[1]-2*x[2]-2*x[3]+2*x[4]-6*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5]]
....: ]
sage: def ea(x): return [u/6 for u in [2*x[0]+2*x[1]-2*x[2]-2*x[3]+2*x[4]-6*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5]]
....: 
....: ]
sage: def ea(x): return [u/6 for u in [2*x[0]+2*x[1]-2*x[2]-2*x[3]+2*x[4]-6*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5],-x[0]-x[1]+x[2]+x[3]-x[4]+3*x[5]]]
sage: 
sage: fw = E6.fundamental_weights()
sage: e(fw[1])
[2, 0, -2]
sage: ea(fw[1])
[2/3, -1/3, -1/3]
sage: ### reloading attached file a1.sage modified at 01:51:57 ###
resa2()
[1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
sage: ### reloading attached file a1.sage modified at 01:52:19 ###
### reloading attached file a1.sage modified at 01:52:33 ###

sage: ea(fw[1])
[2/3, -1/3, -1/3]
sage: BranchingRule("E6","G2","miscellaneous")(fw[1])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-29-2a4f273fed3c> in <module>()
----> 1 BranchingRule("E6","G2","miscellaneous")(fw[Integer(1)])

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.pyc in __call__(self, x)
   2356             return self._f(x)
   2357         except:
-> 2358             return self._f(x.to_vector())
   2359 
   2360     def __cmp__(self, other):

TypeError: 'str' object is not callable
sage: branching_rule("E6","G2","miscellaneous")(fw[1])
[2, 0, -2]
sage: ### reloading attached file a1.sage modified at 02:00:00 ###

sage: resa2()
[1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3) (2/3, -1/3, -1/3)
0
0
0
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3) (2/3, -1/3, -1/3)
0
0
0
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3) (2/3, -1/3, -1/3)
0
0
0
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3) (2/3, -1/3, -1/3)
0
0
0
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3) (2/3, -1/3, -1/3)
0
0
0
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3) (2/3, -1/3, -1/3)
0
0
0
sage: aw[1]
(2/3, -1/3, -1/3)
sage: ### reloading attached file a1.sage modified at 02:01:17 ###
aw[1]
(2/3, -1/3, -1/3)
sage: resa2()
[1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-34-2f1842bbb35b> in <module>()
----> 1 resa2()

/Users/bump/.sage/temp/meep2/16440/a1.sage7xzMrF.py in resa2()
    272         for i in range(_sage_const_3 ):
    273             print u[i]-v[i]
--> 274     comp(_sage_const_2 *aw[_sage_const_1 ]+_sage_const_2 *aw[_sage_const_2 ],_sage_const_1 )
    275     comp(_sage_const_4 *aw[_sage_const_1 ]+aw[_sage_const_2 ],_sage_const_2 )
    276     comp(_sage_const_5 *aw[_sage_const_1 ]+_sage_const_2 *aw[_sage_const_2 ],_sage_const_3 )

/Users/bump/.sage/temp/meep2/16440/a1.sage7xzMrF.py in comp(u, k)
    269     def comp(u,k):
    270         v = vector(ea(ew[k]))
--> 271         print "u=%s"%u, "v=%s"%v
    272         for i in range(_sage_const_3 ):
    273             print u[i]-v[i]

TypeError: not all arguments converted during string formatting
sage: 
sage: ### reloading attached file a1.sage modified at 02:02:11 ###
dirs
[]
sage: resa2()
[1/3*X0 + 1/3*X1 - 1/3*X2 - 1/3*X3 + 1/3*X4 - X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5, -1/6*X0 - 1/6*X1 + 1/6*X2 + 1/6*X3 - 1/6*X4 + 1/2*X5]
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3), v=(2/3, -1/3, -1/3)
0
0
0
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3), v=(2/3, -1/3, -1/3)
0
0
0
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3), v=(2/3, -1/3, -1/3)
0
0
0
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3), v=(2/3, -1/3, -1/3)
0
0
0
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3), v=(2/3, -1/3, -1/3)
0
0
0
u=(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3), v=(2/3, -1/3, -1/3)
0
0
0
sage: 2*aw[1]+2*a2[2]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-37-69051f1bb85e> in <module>()
----> 1 Integer(2)*aw[Integer(1)]+Integer(2)*a2[Integer(2)]

/Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.__getitem__ (sage/rings/polynomial/multi_polynomial_libsingular.cpp:20325)()

TypeError: x must have length self.ngens()
sage: 2*aw[1]+2*aw[2]
(2/3, -1/3, -1/3, 2/3, -1/3, -1/3, 1/3, 1/3, -2/3, 1/3, 1/3, -2/3)
sage: aw[1]
(2/3, -1/3, -1/3)
sage: 
Exiting Sage (CPU time 0m11.48s, Wall time 49m24.09s).
~/sagemath/sage/src/sage/combinat/root_system:$ sage -b
scons: `install' is up to date.
Updating Cython code....
Finished compiling Cython code (time = 5.68394184113 seconds)
running install
running build
running build_py
copying sage/combinat/root_system/weyl_characters.py -> build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system
running build_ext
Executing 0 commands (using 1 thread)
Time to execute 0 commands: 0.0138449668884 seconds
Total time spent compiling C/C++ extensions:  0.198834180832 seconds.
running install_lib
copying build/lib.macosx-10.7-x86_64-2.7/sage/combinat/root_system/weyl_characters.py -> /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system
byte-compiling /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/combinat/root_system/weyl_characters.py to weyl_characters.pyc
running install_egg_info
Removing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info
Writing /Users/bump/sagemath/sage/local/lib/python2.7/site-packages/sage-5.13.beta2-py2.7.egg-info

real	0m8.914s
user	0m3.086s
sys	0m0.837s
~/sagemath/sage/src/sage/combinat/root_system:$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 5.13.beta2, Release Date: 2013-10-31                  │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: E6=WeylCharacterRing("E6",style="coroots")
sage: A2=WeylCharacterRing("A2",style="coroots")
sage: E6(1,0,0,0,0,0).branch(A2,rule="miscellaneous")
A2(2,2)
sage: E6(0,1,0,0,0,0).branch(A2,rule="miscellaneous")
A2(1,1) + A2(1,4) + A2(4,1)
sage: G2=WeylCharacterRing("G2",style="coroots")
sage: E6(1,0).branch(G2,rule="miscellaneous")
G2(2,0)
sage: G2(2,0).branch(A2,rule="extended")
A2(0,0) + A2(0,1) + A2(1,0) + A2(0,2) + A2(1,1) + A2(2,0)
sage: (A2(0,0) + A2(0,1) + A2(1,0) + A2(0,2) + A2(1,1) + A2(2,0)).degree()
27
sage: 
Exiting Sage (CPU time 0m5.57s, Wall time 60m23.02s).
s
~/sagemath/sage/src/sage/combinat/root_system:$ bash: s: command not found
~/sagemath/sage/src/sage/combinat/root_system:$ sage -t --long weyl_characters.py 
Running doctests with ID 2013-12-26-19-08-39-924ffa09.
Doctesting 1 file.
sage -t --long weyl_characters.py
    [480 tests, 25.33 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 25.5 seconds
    cpu time: 23.7 seconds
    cumulative wall time: 25.3 seconds
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/bibliography.rst b/src/doc/en/thematic_tutorials/lie/bibliography.rst
index 42c0673..2e27e4a 100644
--- a/src/doc/en/thematic_tutorials/lie/bibliography.rst
+++ b/src/doc/en/thematic_tutorials/lie/bibliography.rst
@@ -113,5 +113,9 @@ Bibliography
 .. [Stanley1999] R. P. Stanley. *Enumerative Combinatorics, Volume
    2*. Cambridge University Press, 1999.
 
+.. [Testerman1989] Testerman, Donna M.
+   A construction of certain maximal subgroups of the algebraic groups E6 and F4. 
+   J. Algebra 122 (1989), no. 2, 299–322. 
+
 .. [Testerman1992] Testerman, Donna M. The construction of the maximal A1's in
    the exceptional algebraic groups. Proc. Amer. Math. Soc. 116 (1992), no. 3, 635–644.
\ No newline at end of file
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index f91a7d6..29c89cb 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -653,6 +653,8 @@ Use ``rule="miscellaneous"`` for the following rules.
 
         \begin{aligned}
         B_3 & \to G_2,
+	\\ E_6 & \to A_2,
+	\\ E_6 & \to G_2,
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
@@ -660,8 +662,22 @@ Use ``rule="miscellaneous"`` for the following rules.
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
-The first rule corresponds to the embedding of ``G_2`` in
+The first rule corresponds to the embedding of `G_2` in
 `\hbox{SO}(7)` in its action on the trace zero octonions.
+The two branching rules from `E_6` to `G_2` or `A_2`
+are described in [Testerman1989]_. We caution the reader
+that Theorem G.2 of that paper, proved there in positive
+characteristic is false over the complex numbers. On
+the other hand, the assumption of characteristic `p`
+is not important for Theorems G.1 and A.1, which
+describe the torus embeddings, hence contain enough
+information to compute the branching rule. There
+are other ways of embedding ``G_2`` or ``A_2`` into
+``E_6``.  These may embeddings be characterized by the
+condition that the two 27-dimensional representations of
+``E_6`` restrict irreducibly to ``G_2`` or ``A_2``.
+Their images are maximal subgroups.
+
 The remaining rules come about as follows. Let `G` be
 `F_4`, `E_6`, `E_7` or `E_8`, and let `H` be `G_2`,
 or else (if `G=E_7`) `F_4`. We embed `H` into `G`
@@ -672,8 +688,6 @@ of subgroups
 
        G_2\subset F_4\subset E_6 \subset E_7 \subset E_8
 
-
-
 Regarding the branching rule ``E_6\to G_2\times A_2``,
 Rubenthaler [Rubenthaler2008]_ describes the embedding
 and applies it in an interesting way.
diff --git a/src/sage/combinat/root_system/weyl_characters.py b/src/sage/combinat/root_system/weyl_characters.py
index e5ab7fa..55f7775 100644
--- a/src/sage/combinat/root_system/weyl_characters.py
+++ b/src/sage/combinat/root_system/weyl_characters.py
@@ -1968,12 +1968,15 @@ def branch_weyl_character(chi, R, S, rule="default"):
 
     .. RUBRIC:: Miscellaneous
 
-    Use ``rule="miscellaneous"`` for the following rules:
+    Use ``rule="miscellaneous"`` for the following rules embeddings of maximal subgroups,
+    all involving exceptional groups.
 
     .. MATH::
 
         \begin{aligned}
         B_3 & \to G_2,
+        E_6 & \to G_2,
+        E_6 & \to A_2,
         \\ F_4 & \to G_2 \times A_1,
         \\ E_6 & \to G_2 \times A_2,
         \\ E_7 & \to G_2 \times C_3,
@@ -1981,12 +1984,34 @@ def branch_weyl_character(chi, R, S, rule="default"):
         \\ E_8 & \to G_2 \times F_4.
         \end{aligned}
 
+    There are other more obvious embeddings of `A_2` and `G_2` into `E_6`.
+    The embeddings in question may be characterized by the condition that the
+    27-dimensional representations of `E_6` restrict irreducibly to `A_2` or
+    `G_2`. Since `G_2` has a subgroup isomorphic to `A_2`, it is worth
+    mentioning that the composite branching rules:
+
+        branching_rule("E6","G2","miscellaneous")*branching_rule("G2","A2","extended")
+        branching_rule("E6","A2","miscellaneous")
+
+    are distinct.
+
     EXAMPLES::
 
         sage: G2 = WeylCharacterRing("G2")
         sage: [fw1, fw2, fw3] = B3.fundamental_weights()
         sage: B3(fw1+fw3).branch(G2, rule="miscellaneous")
         G2(1,0,-1) + G2(2,-1,-1) + G2(2,0,-2)
+        sage: E6 = WeylCharacterRing("E6",style="coroots")
+        sage: G2 = WeylCharacterRing("G2",style="coroots")
+        sage: E6(1,0,0,0,0,0).branch(G2,"miscellaneous")
+        G2(2,0)
+        sage: A2=WeylCharacterRing("A2",style="coroots")
+        sage: E6(1,0,0,0,0,0).branch(A2,rule="miscellaneous")
+        A2(2,2)
+        sage: E6(0,1,0,0,0,0).branch(A2,rule="miscellaneous")
+        A2(1,1) + A2(1,4) + A2(4,1)
+        sage: E6(0,0,0,0,0,2).branch(G2,"miscellaneous") # long time (0.59s)
+        G2(0,0) + G2(2,0) + G2(1,1) + G2(0,2) + G2(4,0)
         sage: F4=WeylCharacterRing("F4",style="coroots")
         sage: G2xA1=WeylCharacterRing("G2xA1",style="coroots")
         sage: F4(0,0,1,0).branch(G2xA1,rule="miscellaneous")
@@ -2985,6 +3010,11 @@ def get_branching_rule(Rtype, Stype, rule="default"):
                     return BranchingRule(Rtype, Stype, lambda x : [-2*x[5],x[5]+x[4],x[5]-x[4],x[2]+x[3],x[1]-x[2],-x[1]-x[3]], "miscellaneous")
                 elif stypes == [CartanType("G2"),CartanType("A2")]:
                     return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3],x[1]-x[2],-x[1]-x[3],-2*x[5],x[5]+x[4],x[5]-x[4]], "miscellaneous")
+            else:
+                if Stype == CartanType("G2"):
+                    return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3]+x[4]-3*x[5], x[1]-2*x[2]-x[3], -x[1]+x[2]-x[4]+3*x[5]],"miscellaneous")
+                if Stype == CartanType("A2"):
+                    return BranchingRule(Rtype, Stype, lambda x : [x[2]+x[3]+x[4]-3*x[5], x[1]-2*x[2]-x[3], -x[1]+x[2]-x[4]+3*x[5]],"miscellaneous")
         elif Rtype == CartanType("E7"):
             if Stype.is_compound():
                 if stypes == [CartanType("C3"),CartanType("G2")]:
~/sagemath/sage/src/sage/combinat/root_system:$ git commit -a -m "added branching rules E6 => G2,A2 per Testerman (1989)"
[15361-branching-rules 4fffc86] added branching rules E6 => G2,A2 per Testerman (1989)
 3 files changed, 52 insertions(+), 4 deletions(-)
~/sagemath/sage/src/sage/combinat/root_system:$ git push
fatal: The upstream branch of your current branch does not match
the name of your current branch.  To push to the upstream branch
on the remote, use

    git push origin HEAD:public/combinat/15361-branching-rules

To push to the branch of the same name on the remote, use

    git push origin 15361-branching-rules

~/sagemath/sage/src/sage/combinat/root_system:$     git push origin HEAD:public/combinat/15361-branching-rules
Counting objects: 91, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (13/13), done.
Writing objects: 100% (13/13), 2.18 KiB | 0 bytes/s, done.
Total 13 (delta 12), reused 0 (delta 0)
remote: Trac #15361: Commit changed to 4fffc8.        
To git@trac.sagemath.org:sage.git
   ac6cfe3..4fffc86  HEAD -> public/combinat/15361-branching-rules
~/sagemath/sage/src/sage/combinat/root_system:$ git diff
diff --git a/src/doc/en/thematic_tutorials/lie/branching_rules.rst b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
index 29c89cb..b7cd054 100644
--- a/src/doc/en/thematic_tutorials/lie/branching_rules.rst
+++ b/src/doc/en/thematic_tutorials/lie/branching_rules.rst
@@ -844,7 +844,7 @@ effect may be computed using the branching rule code::
 In the special case where `G=D4`, the Dynkin diagram has
 extra symmetries, and these correspond to outer automorphisms
 of the group. These are implemented as the ``"triality"``
-branching rule.
+branching rule::
 
     sage: branching_rule("D4","D4","triality").describe()
     <BLANKLINE>
~/sagemath/sage/src/sage/combinat/root_system:$ git reset HEAD --hard
HEAD is now at 4fffc86 added branching rules E6 => G2,A2 per Testerman (1989)
~/sagemath/sage/src/sage/combinat/root_system:$ git pull
remote: Counting objects: 1255, done.        
remote: Compressing objects: 100% (745/745), done.        
remote: Total 766 (delta 563), reused 11 (delta 4)        
Receiving objects: 100% (766/766), 206.46 KiB | 0 bytes/s, done.
Resolving deltas: 100% (563/563), completed with 189 local objects.
From trac.sagemath.org:sage
   4fffc86..7185c7d  public/combinat/15361-branching-rules -> origin/public/combinat/15361-branching-rules
 * [new branch]      public/combinat/birational_rowmotion -> origin/public/combinat/birational_rowmotion
   cba6e81..222fdc2  public/combinat/crystals/more_affine -> origin/public/combinat/crystals/more_affine
   7982d3a..1adb368  public/combinat/partitions_constraints-15525 -> origin/public/combinat/partitions_constraints-15525
 * [new branch]      public/combinat/rigged_configurations/speedups -> origin/public/combinat/rigged_configurations/speedups
 * [new branch]      public/combinat/sf/fixes-15575 -> origin/public/combinat/sf/fixes-15575
   e8c36ef..ba798c0  public/geometry/14789-hyperplane_arrangements -> origin/public/geometry/14789-hyperplane_arrangements
   5c56415..d70bb87  public/groups/fp_groups-15145 -> origin/public/groups/fp_groups-15145
   4548a5b..1daad96  public/modules/fock_space -> origin/public/modules/fock_space
   0e7c964..fcf6ad2  public/padics/templates-12555 -> origin/public/padics/templates-12555
 * [new branch]      public/rings/cleanup_integer_mod_ring -> origin/public/rings/cleanup_integer_mod_ring
   0c907cf..5ccf253  public/ticket/10963 -> origin/public/ticket/10963
 * [new branch]      public/ticket/15582 -> origin/public/ticket/15582
 * [new branch]      u/SimonKing/ticket/10963 -> origin/u/SimonKing/ticket/10963
 * [new branch]      u/SimonKing/ticket/15506 -> origin/u/SimonKing/ticket/15506
   df4d3f3..828c5ad  u/agd/cis/compinv -> origin/u/agd/cis/compinv
   5ce3389..5547d74  u/agd/cis/deriv -> origin/u/agd/cis/deriv
   e9ec2e1..117f099  u/agd/gcis -> origin/u/agd/gcis
   f570a62..c70498b  u/charpent/ticket/15561 -> origin/u/charpent/ticket/15561
   6a35c8a..2b283c7  u/cremona/ticket/15556 -> origin/u/cremona/ticket/15556
 * [new branch]      u/jhpalmieri/sagenb -> origin/u/jhpalmieri/sagenb
 * [new branch]      u/jhpalmieri/sagenb_new -> origin/u/jhpalmieri/sagenb_new
 * [new branch]      u/jpflori/ppl -> origin/u/jpflori/ppl
 * [new branch]      u/jpflori/ticket/12399 -> origin/u/jpflori/ticket/12399
   4b633ab..fcf6ad2  u/jpflori/ticket/12555 -> origin/u/jpflori/ticket/12555
 * [new branch]      u/jpflori/ticket/14333 -> origin/u/jpflori/ticket/14333
 * [new branch]      u/jpflori/ticket/14854 -> origin/u/jpflori/ticket/14854
   fc7a569..63bf717  u/jpflori/ticket/15148 -> origin/u/jpflori/ticket/15148
 * [new branch]      u/jpflori/ticket/15365 -> origin/u/jpflori/ticket/15365
 * [new branch]      u/jpflori/ticket/15366 -> origin/u/jpflori/ticket/15366
 * [new branch]      u/jpflori/ticket/15574 -> origin/u/jpflori/ticket/15574
 * [new branch]      u/jpflori/ticket/15586 -> origin/u/jpflori/ticket/15586
 * [new branch]      u/jpflori/ticket/15589 -> origin/u/jpflori/ticket/15589
   4d08ddf..15dabc3  u/lftabera/ticket/10255 -> origin/u/lftabera/ticket/10255
 * [new branch]      u/ncohen/14541 -> origin/u/ncohen/14541
 * [new branch]      u/ncohen/14631 -> origin/u/ncohen/14631
 + 16d141c...6c7e2f4 u/ncohen/15369 -> origin/u/ncohen/15369  (forced update)
 + 69f2852...52a7626 u/ncohen/15435 -> origin/u/ncohen/15435  (forced update)
   51571f7..47339dd  u/ncohen/15551 -> origin/u/ncohen/15551
 + 39282d3...7e6264c u/ohanar/csage_autotools -> origin/u/ohanar/csage_autotools  (forced update)
 * [new branch]      u/ohanar/optionalize -> origin/u/ohanar/optionalize
   adc90ce..f005905  u/ohanar/pillow -> origin/u/ohanar/pillow
   5e0e0f9..69c56e2  u/ohanar/sagenb_upgrade -> origin/u/ohanar/sagenb_upgrade
   10ab84b..db383df  u/stumpc5/ticket/15495 -> origin/u/stumpc5/ticket/15495
 * [new branch]      u/tscrim/affine_crystals-Malka -> origin/u/tscrim/affine_crystals-Malka
 * [new branch]      u/vbraun/git_trac -> origin/u/vbraun/git_trac
 * [new branch]      u/vbraun/jmol_fix -> origin/u/vbraun/jmol_fix
 * [new branch]      u/vbraun/maxima_emacs -> origin/u/vbraun/maxima_emacs
 * [new branch]      u/vbraun/pimp_my_shell -> origin/u/vbraun/pimp_my_shell
 * [new branch]      u/vbraun/update_to_gap_4_7_2 -> origin/u/vbraun/update_to_gap_4_7_2
 * [new branch]      u/wuthrich/ticket/11211 -> origin/u/wuthrich/ticket/11211
Updating 4fffc86..7185c7d
Fast-forward
 src/doc/en/thematic_tutorials/lie/branching_rules.rst | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)
~/sagemath/sage/src/sage/combinat/root_system:$ pushd ~/branch/
~/branch ~/sagemath/sage/src/sage/combinat/root_system
~/branch:$ cp e6.sage e7.sage
~/branch:$ exit

Process shell finished
